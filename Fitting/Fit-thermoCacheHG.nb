(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    152371,       3689]
NotebookOptionsPosition[    148193,       3597]
NotebookOutlinePosition[    150510,       3651]
CellTagsIndexPosition[    150353,       3644]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Pane", "[", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Fitting of HD thermodynamics\>\"", ",", "\"\<Chapter\>\""}], 
         "]"}], "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"MouseAppearance", "[", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<Launch Application (click me)\>\"", ",", 
              "\"\<Section\>\""}], "]"}], ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"nb", "=", 
               RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
              RowBox[{"NotebookFind", "[", 
               RowBox[{
               "nb", ",", "\"\<launchcell\>\"", ",", "All", ",", "CellTags"}],
                "]"}], ",", 
              RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
          "\"\<LinkHand\>\""}], "]"}], "}"}]}], "\n", "\n", "}"}], ",", " ", 
     RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
     RowBox[{"ItemSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"BaselinePosition", "\[Rule]", "Baseline"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.731821909992667*^9, 3.7318220266332903`*^9}, {
   3.7318220650102763`*^9, 3.7318221618988886`*^9}, {3.731822297374745*^9, 
   3.7318223480196705`*^9}, {3.731822393559778*^9, 3.7318224108738403`*^9}, {
   3.731823391470278*^9, 3.7318234673463974`*^9}, {3.7318569879999685`*^9, 
   3.73185698993756*^9}, 3.734079643614863*^9, {3.734080557424387*^9, 
   3.7340805579550896`*^9}, {3.794679258775832*^9, 3.794679261752077*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"de2ec15c-7261-4abd-83b2-6ff61d2d7e8f"],

Cell[BoxData[
 PaneBox[
  TagBox[GridBox[{
     {
      StyleBox["\<\"Fitting of HD thermodynamics\"\>", "Chapter",
       StripOnInput->False]},
     {
      TagBox[
       ButtonBox[
        StyleBox["\<\"Launch Application (click me)\"\>", "Section",
         StripOnInput->False],
        Appearance->None,
        ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
          NotebookFind[$CellContext`nb, "launchcell", All, CellTags], 
          SelectionEvaluate[$CellContext`nb]},
        Evaluator->Automatic,
        Method->"Preemptive"],
       MouseAppearanceTag["LinkHand"]]}
    },
    AutoDelete->False,
    BaselinePosition->Baseline,
    GridBoxAlignment->{"Columns" -> {{Center}}},
    GridBoxItemSize->{"Columns" -> {{Large}}, "Rows" -> {{Large}}}],
   "Grid"],
  Alignment->Center,
  ImageSize->Full]], "Output",
 CellChangeTimes->{3.783755328687954*^9, 3.794679271603963*^9},
 CellLabel->"Out[77]=",ExpressionUUID->"c44f7e1b-b899-4621-901e-60278eb09dca"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Notebook", " ", "settings"}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
      RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], "]"}], ";"}], "\n", 
   RowBox[{"SetOptions", "[", 
    RowBox[{"$FrontEnd", ",", 
     RowBox[{"GlobalInitializationCellWarning", "\[Rule]", "False"}]}], "]"}],
    "\n", "\n", 
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"InitializationCellEvaluation", "\[Rule]", "True"}], ",", 
     RowBox[{"InitializationCellWarning", "\[Rule]", "False"}]}], "]"}], "\n", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", 
      RowBox[{"\"\<DynamicUpdating\>\"", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", 
      RowBox[{"\"\<DynamicEvaluationTimeout\>\"", "\[Rule]", "30"}]}], "]"}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"set", " ", "values"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"h0fixed", "=", "1"}], ";", " ", 
    RowBox[{"d0fixed", "=", "1"}], ";", 
    RowBox[{"kequhdfixed", "=", "2"}], ";", 
    RowBox[{"kequhgafixed", "=", "2"}], ";", 
    RowBox[{"sighdfixed", "=", "1"}], ";", 
    RowBox[{"sigdfixed", "=", "1"}], ";", 
    RowBox[{"sig0fixed", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"h0error", "=", "0"}], ";", " ", 
    RowBox[{"d0error", "=", "0"}], ";", 
    RowBox[{"kequhderror", "=", "0"}], ";", 
    RowBox[{"kequhgaerror", "=", "0"}], ";", 
    RowBox[{"sighderror", "=", "0"}], ";", 
    RowBox[{"sigderror", "=", "0"}], ";", 
    RowBox[{"sig0error", "=", "0"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Load", " ", "Packges"}], "*)"}], "\t", "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<thermoHD\>\"", ",", 
          "\"\<thermoCacheHD.m\>\""}], "}"}], "]"}], "}"}], "]"}], "]"}], 
    ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<datagen.m\>\""}], "}"}], "]"}], "}"}],
       "]"}], "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ParentDirectory", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
        "\"\<Styles\>\"", ",", "\"\<styles.m\>\""}], "}"}], "]"}], "]"}], 
    ";"}], "\n", "\t", "\n", 
   RowBox[{"(*", " ", "Paths", "*)"}], "\n", 
   RowBox[{
    RowBox[{"tempPath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<temp-thermoHG.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cachePath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<cache-thermo.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"defaultPath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<default-thermoHG.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"pathHG", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Samples\>\"", ",", 
        "\"\<Sim-thermoHG.txt\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialparameters", "=", 
     RowBox[{"Import", "[", "defaultPath", "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"h0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"d0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"step", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"kequhdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sig0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sigdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sighdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "7", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"factor", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "8", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"cfac", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", "Buttons", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"initializebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{"\"\<Initialize\>\"", ",", "\"\<Initilize the values\>\""}],
           "]"}], ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"nb", "=", 
            RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
           RowBox[{"NotebookFind", "[", 
            RowBox[{
            "nb", ",", "\"\<initialroutineHD2IDA\>\"", ",", "All", ",", 
             "CellTags"}], "]"}], ",", 
           RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fitbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Click here to fit\>\"", ",", 
           "\"\<Fits the model to the data\>\""}], "]"}], ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"nb", "=", 
            RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
           RowBox[{"NotebookFind", "[", 
            RowBox[{
            "nb", ",", "\"\<fittingroutineHD2IDA\>\"", ",", "All", ",", 
             "CellTags"}], "]"}], ",", 
           RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"variablessavebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Save Parameters\>\"", ",", 
           "\"\<Saves the set values of the parameters\>\""}], "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"{", "\n", 
             RowBox[{
             "h0in", ",", "\n", "d0in", ",", "\n", "step", ",", "\n", 
              "kequhdin", ",", "\n", "sig0in", ",", "\n", "sigdin", ",", "\n",
               "sighdin", ",", "\n", "factor", ",", "\n", "cfac"}], "\n", 
             "}"}]}], ",", 
           RowBox[{"Export", "[", 
            RowBox[{"tempPath", ",", "initialparameters"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"variablesloadbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Load Saved Parameters\>\"", ",", 
           "\"\<Loads the previously saved values\>\""}], "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"Import", "[", "tempPath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"step", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"factor", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"cfac", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "9", "]"}], "]"}]}]}], "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"defaultloadbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Load Default Parameters\>\"", ",", 
           "\"\<Loads the default values of the parameters\>\""}], "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"Import", "[", "defaultPath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"step", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"factor", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"cfac", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "9", "]"}], "]"}]}]}], "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cachebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Cache Parameters\>\"", ",", 
           "\"\<Caches the parameter's values for transfer\>\""}], "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"cacheparameters", "=", 
            RowBox[{"{", "\n", 
             RowBox[{
             "h0in", ",", "\n", "d0in", ",", "\n", "kequhdin", ",", "\n", 
              "sig0in", ",", "\n", "sigdin", ",", "\n", "sighdin"}], "\n", 
             "}"}]}], ",", 
           RowBox[{"Export", "[", 
            RowBox[{"cachePath", ",", "cacheparameters"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"retrievebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Retrieve Cache\>\"", ",", 
           "\"\<Retrieves the caches parameters from any notebook\>\""}], 
          "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"cacheparameters", "=", 
            RowBox[{"Import", "[", "cachePath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}]}], "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"inputline", " ", "=", " ", 
     RowBox[{"{", "\n", "   ", 
      RowBox[{
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<species\>\"", ",", " ", "Bold", ",", "Underlined", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<concentration\>\"", ",", " ", "Bold", ",", "Underlined", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<binding\>\"", ",", " ", "Bold", ",", "Underlined", ",", " ", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}]}], "\n", 
        "   ", "}"}], ",", "\n", "\n", "   ", 
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Host:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "h0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", "\n", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<c-step \>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "step", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", "\n", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<end point \>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{"end", ",", "None"}], "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
           RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", 
         "\"\<M\>\""}], "\n", "}"}], ",", "\n", " ", 
       RowBox[{"{", "\n", " ", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"h0in", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<c-step\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"step", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<from data\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"end", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\""}], 
        "\n", " ", "}"}], ",", "\n", " ", "\n", " ", 
       RowBox[{"{", "\n", " ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Dye:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", "\n", 
         " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "d0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD)\>\"", " ", ",", " ", 
           "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", "\n", 
         " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "kequhdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\>\""}], "\n", 
        "}"}], ",", "\n", "   ", "\n", "   ", 
       RowBox[{"{", "\n", "   ", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"d0in", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"Log10", "[", "kequhdin", "]"}], "]"}], ",", "\"\<\>\""}], 
        "\n", "   ", "}"}], ",", "\n", " ", "\n", "   ", 
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-HD\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sighdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-D\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sigdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-0\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sig0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}]}], "\n", "   ",
         "}"}], ",", "\n", "      ", 
       RowBox[{"{", "\n", "      ", 
        RowBox[{
        "\"\<HD complex\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<dye alone\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<Startsignal\>\""}], "\n", "      ", "}"}]}], "  ", "\n", "    ",
       "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"end", "=", "h0in"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"normchoice", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"TableForm", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "initializebutton", ",", "variablesloadbutton", ",", 
         "variablessavebutton", ",", "defaultloadbutton", ",", "cachebutton", 
         ",", "retrievebutton"}], "}"}], "}"}], "]"}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", "\n", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"TableForm", "[", 
        RowBox[{"{", "\n", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<File format\>\"", ",", "\"\<Concentration dimension\>\"", 
            ",", "\"\<Normalization\>\"", ",", "\"\<Concentration factor\>\"",
             ",", "\"\<JASCO Import?\>\"", ",", "\"\<Trim the data?\>\""}], 
           "}"}], ",", "\n", 
          RowBox[{"{", 
           RowBox[{"\"\<tab delimited .txt file\>\"", ",", 
            RowBox[{"RadioButtonBar", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "factor", "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", " ", "->", " ", "\"\<M\>\""}], ",", " ", 
                RowBox[{"1000", " ", "->", " ", "\"\<mM\>\""}], ",", 
                RowBox[{"1000000", "\[Rule]", " ", "\"\<\[Mu]M\>\""}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"RadioButtonBar", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "normchoice", "]"}], ",", " ", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", " ", "->", " ", "\"\<None\>\""}], ",", " ", 
                RowBox[{"2", " ", "->", " ", "\"\<to N[0,1]\>\""}], ",", 
                RowBox[{"3", "\[Rule]", " ", "\"\<Devide by max\>\""}]}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"InputField", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "cfac", "]"}], ",", " ", 
              RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
            RowBox[{"Checkbox", "[", 
             RowBox[{"Dynamic", "[", "jascoImport", "]"}], "]"}], ",", 
            RowBox[{"Checkbox", "[", 
             RowBox[{"Dynamic", "[", "trimmer", "]"}], "]"}]}], "}"}]}], 
         "}"}], "]"}], ",", "\"\<Subsubsection\>\"", ",", "Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "16"}]}], "]"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", "\n", 
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"TableForm", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\"\<currently loaded data:\>\"", ",", 
             RowBox[{"Dynamic", "[", "pathHG", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"FileNameSetter", "[", 
             RowBox[{
              RowBox[{"Dynamic", "[", "pathHG", "]"}], ",", "\"\<Open\>\"", 
              ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<Readable files\>\"", "\[Rule]", 
                 RowBox[{"{", "\"\<*.TXT\>\"", "}"}]}], ",", 
                RowBox[{"\"\<All files\>\"", "\[Rule]", 
                 RowBox[{"{", "\"\<*\>\"", "}"}]}]}], "}"}]}], "]"}], "}"}], 
           ",", 
           RowBox[{"{", "}"}]}], "}"}], "]"}], ",", "\n", 
        "\"\<Subsubsection\>\"", ",", "Black", ",", 
        RowBox[{"FontSize", "\[Rule]", "14"}]}], "\n", "]"}], "]"}], ";"}], 
    "*)"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"TableForm", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<currently loaded data:\>\"", ",", 
            RowBox[{"Dynamic", "[", "pathHG", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MouseAppearance", "[", 
            RowBox[{
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"Framed", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"FileNameSetter", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "pathHG", "]"}], ",", 
                    "\"\<Open\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Readable files\>\"", "\[Rule]", 
                    RowBox[{"{", "\"\<*.TXT\>\"", "}"}]}], ",", 
                    RowBox[{"\"\<All files\>\"", "\[Rule]", 
                    RowBox[{"{", "\"\<*\>\"", "}"}]}]}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", 
                    RowBox[{"Browse", "..."}]}]}], "]"}], ",", 
                   "\"\<Section\>\"", ",", 
                   RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", 
                 RowBox[{"RoundingRadius", "\[Rule]", "15"}], ",", 
                 RowBox[{"Background", "\[Rule]", "LightGray"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"LightGray", ",", "12"}], "]"}]}]}], "]"}], ",", 
               "\"\<Browse the file\>\""}], "]"}], ",", "\"\<LinkHand\>\""}], 
            "]"}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}], "]"}], ",", "\n", 
       "\"\<Subsubsection\>\"", ",", "Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}]}], "\n", "]"}], "]"}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"TableForm", "[", 
       RowBox[{"inputline", ",", 
        RowBox[{"TableAlignments", "\[Rule]", "Left"}]}], "]"}], ",", 
      "\"\<Subsubsection\>\"", ",", "Black", ",", 
      RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], "*)"}], "\n", "\n", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{"inputline", ",", 
       RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], ",", 
     "\"\<Subsubsection\>\"", ",", "Black", ",", 
     RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], "\n", "\n", 
   "\n"}]}]], "Input",
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.730400773395277*^9, 3.7304008352393255`*^9}, {
   3.730401492629541*^9, 3.73040150347148*^9}, {3.730402649565604*^9, 
   3.7304028230281205`*^9}, {3.7304029904431067`*^9, 3.730403080271673*^9}, {
   3.7304031109589834`*^9, 3.7304033952843356`*^9}, {3.730403434815216*^9, 
   3.7304034707397184`*^9}, {3.730403572769393*^9, 3.7304036711451073`*^9}, {
   3.7304037173322906`*^9, 3.7304038263140087`*^9}, {3.7304038664846106`*^9, 
   3.730403892708701*^9}, 3.7304039373324056`*^9, {3.730635884169504*^9, 
   3.730635890234384*^9}, {3.730635977259904*^9, 3.730636125234563*^9}, 
   3.7306361562502937`*^9, {3.730636486363246*^9, 3.730636507704445*^9}, 
   3.730699333959115*^9, 3.730699414337867*^9, {3.7306994572750845`*^9, 
   3.730699471266698*^9}, {3.73070096568909*^9, 3.730700983626526*^9}, 
   3.730701842378021*^9, 3.7307103357721977`*^9, {3.730711599505864*^9, 
   3.7307116052989116`*^9}, {3.7307118430217047`*^9, 
   3.7307118531154985`*^9}, {3.7307118888187237`*^9, 
   3.7307120428818164`*^9}, {3.7307120899121513`*^9, 3.730712091974739*^9}, {
   3.730712158991912*^9, 3.730712301897294*^9}, {3.7307123369917274`*^9, 
   3.7307123615377364`*^9}, {3.730712434386697*^9, 3.73071243545944*^9}, {
   3.730712555569868*^9, 3.730712569491119*^9}, {3.7307126443741517`*^9, 
   3.730712700401746*^9}, {3.7307128842864532`*^9, 3.730712899880815*^9}, 
   3.730713117631132*^9, {3.730714832037506*^9, 3.7307150229472327`*^9}, 
   3.730715152250645*^9, {3.730720928334868*^9, 3.7307209894055443`*^9}, {
   3.7307210437260246`*^9, 3.7307211347099714`*^9}, {3.730721166538047*^9, 
   3.7307211682081127`*^9}, {3.730721268272152*^9, 3.7307212991326036`*^9}, {
   3.73113671379996*^9, 3.731136795673627*^9}, {3.7340796606207995`*^9, 
   3.7340797082038565`*^9}, 3.734079767025264*^9, 3.7340801047041655`*^9, {
   3.7340801901873493`*^9, 3.7340801916538916`*^9}, {3.734080325128217*^9, 
   3.7340803266897755`*^9}, {3.734081166258032*^9, 3.734081192197974*^9}, {
   3.734081311746915*^9, 3.7340813847541847`*^9}, {3.73408151756456*^9, 
   3.73408152411252*^9}, {3.7340820767872324`*^9, 3.7340820775205812`*^9}, 
   3.734082177634734*^9, {3.734082231951256*^9, 3.7340822434321938`*^9}, {
   3.734082281546068*^9, 3.734082454750534*^9}, {3.7340826596192636`*^9, 
   3.7340826634297247`*^9}, 3.7340829264392724`*^9, 3.7341044556968613`*^9, 
   3.7383960133000975`*^9, {3.7398133280147038`*^9, 3.739813350659108*^9}, {
   3.739813383431282*^9, 3.7398133836343946`*^9}, {3.7398134420895004`*^9, 
   3.739813584501944*^9}, {3.739813620861326*^9, 3.73981372917161*^9}, {
   3.7406811529661202`*^9, 3.740681176442217*^9}, {3.740681737874067*^9, 
   3.740681747644923*^9}, {3.74068188451647*^9, 3.7406819124996433`*^9}, {
   3.740681954033555*^9, 3.740682285567932*^9}, {3.7406823484899426`*^9, 
   3.7406824560569997`*^9}, {3.7406825005404754`*^9, 
   3.7406825125811462`*^9}, {3.740682567577265*^9, 3.7406825738467875`*^9}, {
   3.7406826187511215`*^9, 3.7406827171730585`*^9}, {3.7406828040603666`*^9, 
   3.740682862817417*^9}, {3.740682897727971*^9, 3.740682919415039*^9}, {
   3.740682969662922*^9, 3.7406830075825224`*^9}, {3.7406830513924074`*^9, 
   3.7406830874572625`*^9}, {3.740683166481167*^9, 3.7406832591735973`*^9}, {
   3.7406848406224103`*^9, 3.7406849270768523`*^9}, 3.7406849784352016`*^9, {
   3.7407308493843107`*^9, 3.740730861090467*^9}, 3.7407311433336415`*^9, {
   3.740731670650874*^9, 3.74073169391632*^9}, {3.7422116704709234`*^9, 
   3.7422116895402317`*^9}, {3.742212117490425*^9, 3.7422121305363154`*^9}, {
   3.783753816181327*^9, 3.783753833460335*^9}},
 CellTags->"launchcell",
 CellLabel->"In[1]:=",ExpressionUUID->"bd2d16b9-63a8-4d34-a591-c44736eb277d"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Initialize\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Initilize the values\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Initilize the values", "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
         NotebookFind[$CellContext`nb, "initialroutineHD2IDA", All, CellTags], 
         SelectionEvaluate[$CellContext`nb]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Load Saved Parameters\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Loads the previously saved values\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Loads the previously saved values", "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`initialparameters = 
         Import[$CellContext`tempPath], $CellContext`h0in = 
         Part[$CellContext`initialparameters, 1], $CellContext`d0in = 
         Part[$CellContext`initialparameters, 2], $CellContext`step = 
         Part[$CellContext`initialparameters, 3], $CellContext`kequhdin = 
         Part[$CellContext`initialparameters, 4], $CellContext`sig0in = 
         Part[$CellContext`initialparameters, 5], $CellContext`sigdin = 
         Part[$CellContext`initialparameters, 6], $CellContext`sighdin = 
         Part[$CellContext`initialparameters, 7], $CellContext`factor = 
         Part[$CellContext`initialparameters, 8], $CellContext`cfac = 
         Part[$CellContext`initialparameters, 9]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Save Parameters\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Saves the set values of the parameters\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Saves the set values of the parameters", "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`initialparameters = {$CellContext`h0in, \
$CellContext`d0in, $CellContext`step, $CellContext`kequhdin, \
$CellContext`sig0in, $CellContext`sigdin, $CellContext`sighdin, \
$CellContext`factor, $CellContext`cfac}, 
         Export[$CellContext`tempPath, $CellContext`initialparameters]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Load Default Parameters\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Loads the default values of the parameters\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Loads the default values of the parameters", 
         "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`initialparameters = 
         Import[$CellContext`defaultPath], $CellContext`h0in = 
         Part[$CellContext`initialparameters, 1], $CellContext`d0in = 
         Part[$CellContext`initialparameters, 2], $CellContext`step = 
         Part[$CellContext`initialparameters, 3], $CellContext`kequhdin = 
         Part[$CellContext`initialparameters, 4], $CellContext`sig0in = 
         Part[$CellContext`initialparameters, 5], $CellContext`sigdin = 
         Part[$CellContext`initialparameters, 6], $CellContext`sighdin = 
         Part[$CellContext`initialparameters, 7], $CellContext`factor = 
         Part[$CellContext`initialparameters, 8], $CellContext`cfac = 
         Part[$CellContext`initialparameters, 9]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Cache Parameters\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Caches the parameter's values for transfer\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Caches the parameter's values for transfer", 
         "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`cacheparameters = {$CellContext`h0in, \
$CellContext`d0in, $CellContext`kequhdin, $CellContext`sig0in, \
$CellContext`sigdin, $CellContext`sighdin}, 
         Export[$CellContext`cachePath, $CellContext`cacheparameters]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Retrieve Cache\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Retrieves the caches parameters from any notebook\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Retrieves the caches parameters from any notebook", 
         "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`cacheparameters = 
         Import[$CellContext`cachePath], $CellContext`h0in = 
         Part[$CellContext`cacheparameters, 1], $CellContext`d0in = 
         Part[$CellContext`cacheparameters, 2], $CellContext`kequhdin = 
         Part[$CellContext`cacheparameters, 3], $CellContext`sig0in = 
         Part[$CellContext`cacheparameters, 4], $CellContext`sigdin = 
         Part[$CellContext`cacheparameters, 5], $CellContext`sighdin = 
         Part[$CellContext`cacheparameters, 6]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.7837553424462404`*^9, {3.7842678270317245`*^9, 3.7842678289978895`*^9}, {
   3.794679186028161*^9, 3.794679188364001*^9}, 3.794679281648664*^9, 
   3.794679853310587*^9},
 CellTags->"launchcell",
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"49e1638d-f282-4e32-aa38-f583ff57887c"],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {"\<\"File format\"\>", "\<\"Concentration dimension\"\>", \
"\<\"Normalization\"\>", "\<\"Concentration factor\"\>", "\<\"JASCO Import?\"\
\>", "\<\"Trim the data?\"\>"},
     {"\<\"tab delimited .txt file\"\>", 
      InterpretationBox[
       StyleBox[
        RowBox[{GridBox[{
           {
            RadioButtonBox[Dynamic[$CellContext`factor], {1},
             DefaultBaseStyle->"RadioButtonBar"], 
            StyleBox["\<\"M\"\>", "RadioButtonBarLabel",
             StripOnInput->False]}
          },
          AutoDelete->False,
          BaselinePosition->{1, 2},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.21]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "  ", GridBox[{
           {
            RadioButtonBox[Dynamic[$CellContext`factor], {1000},
             DefaultBaseStyle->"RadioButtonBar"], 
            StyleBox["\<\"mM\"\>", "RadioButtonBarLabel",
             StripOnInput->False]}
          },
          AutoDelete->False,
          BaselinePosition->{1, 2},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.21]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "  ", GridBox[{
           {
            RadioButtonBox[Dynamic[$CellContext`factor], {1000000},
             DefaultBaseStyle->"RadioButtonBar"], 
            StyleBox["\<\"\[Mu]M\"\>", "RadioButtonBarLabel",
             StripOnInput->False]}
          },
          AutoDelete->False,
          BaselinePosition->{1, 2},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.21]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}]}], "Deploy"],
       RadioButtonBar[
        Dynamic[$CellContext`factor], {
        1 -> "M", 1000 -> "mM", 1000000 -> "\[Mu]M"}]], 
      InterpretationBox[
       StyleBox[
        RowBox[{GridBox[{
           {
            RadioButtonBox[Dynamic[$CellContext`normchoice], {1},
             DefaultBaseStyle->"RadioButtonBar"], 
            StyleBox["\<\"None\"\>", "RadioButtonBarLabel",
             StripOnInput->False]}
          },
          AutoDelete->False,
          BaselinePosition->{1, 2},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.21]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "  ", GridBox[{
           {
            RadioButtonBox[Dynamic[$CellContext`normchoice], {2},
             DefaultBaseStyle->"RadioButtonBar"], 
            StyleBox["\<\"to N[0,1]\"\>", "RadioButtonBarLabel",
             StripOnInput->False]}
          },
          AutoDelete->False,
          BaselinePosition->{1, 2},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.21]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}], "  ", GridBox[{
           {
            RadioButtonBox[Dynamic[$CellContext`normchoice], {3},
             DefaultBaseStyle->"RadioButtonBar"], 
            StyleBox["\<\"Devide by max\"\>", "RadioButtonBarLabel",
             StripOnInput->False]}
          },
          AutoDelete->False,
          BaselinePosition->{1, 2},
          GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
          
          GridBoxItemSize->{
           "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.21]}, 
              Offset[0.27999999999999997`]}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}}]}], "Deploy"],
       RadioButtonBar[
        Dynamic[$CellContext`normchoice], {
        1 -> "None", 2 -> "to N[0,1]", 3 -> "Devide by max"}]], 
      InputFieldBox[Dynamic[$CellContext`cfac],
       FieldSize->8], 
      CheckboxBox[Dynamic[$CellContext`jascoImport]], 
      CheckboxBox[Dynamic[$CellContext`trimmer]]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], "Subsubsection",
  StripOnInput->False,
  LineColor->GrayLevel[0],
  FrontFaceColor->GrayLevel[0],
  BackFaceColor->GrayLevel[0],
  GraphicsColor->GrayLevel[0],
  FontSize->16,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{
  3.7837553424462404`*^9, {3.7842678270317245`*^9, 3.7842678289978895`*^9}, {
   3.794679186028161*^9, 3.794679188364001*^9}, 3.794679281648664*^9, 
   3.7946798533905134`*^9},
 CellTags->"launchcell",
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"2e92ca92-28e9-4436-b4cb-5f70af0e8b3f"],

Cell[BoxData[
 StyleBox[
  InterpretationBox[GridBox[{
     {"\<\"currently loaded data:\"\>", 
      DynamicBox[ToBoxes[$CellContext`pathHG, StandardForm],
       ImageSizeCache->{867., {3., 10.}}]},
     {
      TagBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox[
           
           TemplateBox[{
            Dynamic[$CellContext`pathHG],"Open",{
             "Readable files" -> {"*.TXT"}, "All files" -> {"*"}},Automatic,
             RowBox[{"Browse", "..."}],None,{"FileNameSetter"},Automatic,0,
             Automatic},
            "FileNameSetterBoxes4"], "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Browse the file\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Browse the file", "Tooltip"]& ],
       MouseAppearanceTag["LinkHand"]], "\<\"\"\>"},
     {"\<\"\"\>", "\<\"\"\>"}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   TableForm[{{"currently loaded data:", 
      Dynamic[$CellContext`pathHG]}, {
      MouseAppearance[
       Tooltip[
        Framed[
         Style[
          FileNameSetter[
           Dynamic[$CellContext`pathHG], "Open", {
           "Readable files" -> {"*.TXT"}, "All files" -> {"*"}}, Appearance -> 
           RepeatedNull[$CellContext`Browse]], "Section", FontSize -> 18], 
         RoundingRadius -> 15, Background -> GrayLevel[0.85], FrameStyle -> 
         Directive[
           GrayLevel[0.85], 12]], "Browse the file"], "LinkHand"]}, {}}]], 
  "Subsubsection",
  StripOnInput->False,
  LineColor->GrayLevel[0],
  FrontFaceColor->GrayLevel[0],
  BackFaceColor->GrayLevel[0],
  GraphicsColor->GrayLevel[0],
  FontSize->14,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{
  3.7837553424462404`*^9, {3.7842678270317245`*^9, 3.7842678289978895`*^9}, {
   3.794679186028161*^9, 3.794679188364001*^9}, 3.794679281648664*^9, 
   3.7946798534035006`*^9},
 CellTags->"launchcell",
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"66858384-0a37-4400-9390-a70de4046383"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {
      StyleBox["\<\"species\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontWeight->Bold,
       FontVariations->{"Underline"->True}], 
      StyleBox["\<\"concentration\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontWeight->Bold,
       FontVariations->{"Underline"->True}], "\<\"\"\>", 
      StyleBox["\<\"binding\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontWeight->Bold,
       FontVariations->{"Underline"->True}], "", "", "", "", ""},
     {
      StyleBox["\<\"Host:\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`h0in],
       FieldSize->8], "\<\"M\"\>", 
      StyleBox["\<\"c-step \"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`step],
       FieldSize->8], "\<\"M\"\>", 
      StyleBox["\<\"end point \"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`end, None],
       Background->GrayLevel[0.85],
       FieldSize->8], "\<\"M\"\>"},
     {"\<\"\"\>", 
      DynamicBox[ToBoxes[$CellContext`h0in 1000000, StandardForm],
       ImageSizeCache->{58., {0., 11.}}], "\<\"\[Mu]M\"\>", "\<\"c-step\"\>", 
      DynamicBox[ToBoxes[$CellContext`step 1000000, StandardForm],
       ImageSizeCache->{
        76., {0., 11.}}], "\<\"\[Mu]M\"\>", "\<\"from data\"\>", 
      DynamicBox[ToBoxes[$CellContext`end 1000000, StandardForm],
       ImageSizeCache->{58., {0., 11.}}], "\<\"\[Mu]M\"\>"},
     {
      StyleBox["\<\"Dye:\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`d0in],
       FieldSize->8], "\<\"M\"\>", 
      StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(equ\\)]\\)(HD)\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`kequhdin],
       FieldSize->8], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>",
       "", "", ""},
     {"\<\"\"\>", 
      DynamicBox[ToBoxes[$CellContext`d0in 1000000, StandardForm],
       ImageSizeCache->{
        31., {0., 
         11.}}], "\<\"\[Mu]M\"\>", "\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\))\"\>", 
      DynamicBox[ToBoxes[
        Log10[$CellContext`kequhdin], StandardForm],
       ImageSizeCache->{49., {0., 11.}}], "\<\"\"\>", "", "", ""},
     {
      StyleBox["\<\"Signal-HD\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`sighdin],
       FieldSize->8], "\<\"\"\>", 
      StyleBox["\<\"Signal-D\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`sigdin],
       FieldSize->8], "\<\"\"\>", 
      StyleBox["\<\"Signal-0\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`sig0in],
       FieldSize->8], ""},
     {"\<\"HD complex\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"dye alone\"\>", \
"\<\"\"\>", "\<\"\"\>", "\<\"Startsignal\"\>", "", ""}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "Subsubsection",
  StripOnInput->False,
  LineColor->GrayLevel[0],
  FrontFaceColor->GrayLevel[0],
  BackFaceColor->GrayLevel[0],
  GraphicsColor->GrayLevel[0],
  FontSize->18,
  FontColor->GrayLevel[0]]], "Output",
 CellChangeTimes->{
  3.7837553424921155`*^9, {3.784267827247517*^9, 3.784267829045844*^9}, {
   3.794679186065129*^9, 3.794679188408959*^9}, 3.7946792816896276`*^9, 
   3.794679853413492*^9},
 CellTags->"launchcell",
 CellLabel->"Out[38]=",ExpressionUUID->"c5d0cc5e-ecab-432c-b1c7-d41ec2a4eaa5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Export", "::", "chtype"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"First", "::", "nofirst"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mode", "=", "\"\<H0 varied\>\""}], ";"}], "\n"}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"dataimport", "=", 
    RowBox[{"Import", "[", 
     RowBox[{"pathHG", ",", "\"\<Table\>\""}], "]"}]}], ";"}], " "}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{"jascoImport", ",", " ", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ";", "\n", "\t\t", 
      RowBox[{"dataHeader", "=", 
       RowBox[{"{", "}"}]}], ";", "\n", "\t\t", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"NumericQ", "[", 
          RowBox[{"dataimport", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"dataHeader", "=", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"dataHeader", ",", 
            RowBox[{"dataimport", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "All"}], "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"i", "++"}], ";", 
         RowBox[{"Off", "[", 
          RowBox[{"Part", "::", "partw"}], "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"dataXY", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", 
         RowBox[{"dataimport", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"dataXY", "=", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"dataXY", ",", 
            RowBox[{"dataimport", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "All"}], "]"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"i", "++"}], ";", 
         RowBox[{"Off", "[", 
          RowBox[{"Part", "::", "partw"}], "]"}]}]}], "]"}], ";", "\n", 
      "\t\t", 
      RowBox[{"dataFooter", "=", 
       RowBox[{"{", "}"}]}], ";", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", " ", 
         RowBox[{"First", "[", 
          RowBox[{"Dimensions", "[", "dataimport", "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"dataFooter", "=", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"dataFooter", ",", 
            RowBox[{"dataimport", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "All"}], "]"}], "]"}]}], "]"}]}], ";", 
         RowBox[{"i", "++"}]}]}], "]"}], ";"}], "\n", "\t\t", ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"dataXY", "=", "dataimport"}], ";"}]}], "\n", "\t", "]"}], 
   ";"}], "\n", "\t"}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"ymax", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"dataXY", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"ymin", "=", 
    RowBox[{"Min", "[", 
     RowBox[{"dataXY", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"adjusteddata", "=", 
    RowBox[{"dataXY", "/.", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}], "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"cfac", "*", 
         RowBox[{"x", "/", "factor"}]}], ",", 
        RowBox[{"normalize", "[", 
         RowBox[{"y", ",", "ymax", ",", "ymin", ",", "normchoice"}], "]"}]}], 
       "}"}]}]}]}], ";"}], "\n", "\t"}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"end", "=", 
    RowBox[{"Max", "[", 
     RowBox[{"adjusteddata", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"trimmer", "&&", 
     RowBox[{"h0in", "<", "end"}]}], ",", " ", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"closestvalue", "=", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{"adjusteddata", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"#", "\[GreaterEqual]", "  ", "h0in"}], "&"}], ",", "1"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"adjusteddata", "=", 
      RowBox[{"Take", "[", 
       RowBox[{"adjusteddata", ",", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"adjusteddata", "[", 
             RowBox[{"[", 
              RowBox[{"All", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"closestvalue", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], "\n", "\n", "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataplot", "=", 
    RowBox[{"Manipulate", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Show", "[", "\t", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"ListPlot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a2", "*", "adjusteddata"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", " ", "Blue"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"Plot", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a1", "*", 
            RowBox[{"sthdCacheSignal", "[", 
             RowBox[{
             "kequhdin", ",", "d0in", ",", "x", ",", "sig0in", ",", "sighdin",
               ",", "sigdin"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", "0", ",", "h0in"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", " ", "Red"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Signal\>\"", ",", 
           "\"\<[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]\>\"", ",", 
           "\"\<[D]\>\"", ",", 
           "\"\<[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]\>\"", ",", 
           "\"\<[\!\(\*SubscriptBox[\(G\), \(A\)]\)]\>\"", ",", 
           "\"\<[H]\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", " ", "Large"}], ",", 
        RowBox[{"GridLines", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "d0in", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], ",", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", " ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Simulated Data\>\"", ",", "\"\<Subsection\>\""}], 
          "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a1", ",", "1", ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Signal\>\"", ",", "Red"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a2", ",", "1", ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Data\>\"", ",", "Blue"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "\n", "\t\t\t", 
     "]"}]}], ";"}], "\n", "\n", "\t"}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"inputline2", " ", "=", " ", 
    RowBox[{"{", "\n", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"#", ",", "Underlined"}], "]"}], "&"}], ")"}], "/@", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Exact input parameters \>\"", ",", " ", "\"\<Value\>\"", ",", 
         " ", "\"\<Error\>\"", ",", "\"\<Unit\>\"", ",", " ", 
         "\"\<Fixation\>\""}], "}"}]}], ",", "\n", "      ", 
      RowBox[{"(*", "Concentrations", "*)"}], "\n", "        ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<[Host] = \>\"", " ", ",", " ", "Bold", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
          RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "h0in", "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{"h0error", ",", "None"}], "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
          RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", "  ", 
        "\"\<\!\(\*SuperscriptBox[\(M\), \(-1\)]\)\>\"", ",", "\n", "    ", 
        RowBox[{"RadioButtonBar", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "h0fixed", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", " ", "->", " ", "\"\<Fixed\>\""}], ",", " ", 
            RowBox[{"2", " ", "->", " ", "\"\<not fixed\>\""}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "\n", "   ", 
      RowBox[{"{", 
       RowBox[{"\"\<concentration of host\>\"", ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"h0in", "*", "1000000"}], "]"}], ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"h0error", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\""}], 
       "}"}], ",", "\n", "            ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<[Dye] = \>\"", " ", ",", " ", "Bold", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
          RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "d0in", "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{"d0error", ",", "None"}], "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
          RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", "  ", 
        "\"\<\!\(\*SuperscriptBox[\(M\), \(-1\)]\)\>\"", ",", "\n", "    ", 
        RowBox[{"RadioButtonBar", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "d0fixed", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", " ", "->", " ", "\"\<Fixed\>\""}], ",", " ", 
            RowBox[{"2", " ", "->", " ", "\"\<not fixed\>\""}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "\n", "   ", 
      RowBox[{"{", 
       RowBox[{"\"\<concentration of dye\>\"", ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"d0in", "*", "1000000"}], "]"}], ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"d0error", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\""}], 
       "}"}], ",", "\n", "\n", "   ", "\n", "   ", 
      RowBox[{"(*", 
       RowBox[{"Dye", " ", "binding"}], "*)"}], "\n", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD) = \>\"", " ", ",", " ",
           "Bold", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
          RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "kequhdin", "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{"kequhderror", ",", "None"}], "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
          RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", "  ", 
        "\"\<\!\(\*SuperscriptBox[\(M\), \(-1\)]\)\>\"", ",", "\n", "    ", 
        RowBox[{"RadioButtonBar", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "kequhdfixed", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", " ", "->", " ", "\"\<Fixed\>\""}], ",", " ", 
            RowBox[{"2", " ", "->", " ", "\"\<not fixed\>\""}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "\n", "   ", 
      RowBox[{"{", 
       RowBox[{"\"\<affinity of dye for host\>\"", ",", 
        RowBox[{"\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))=\>\"", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"Log10", "[", "kequhdin", "]"}], "]"}]}]}], "}"}], ",", 
      "\n", "      ", "\n", "   ", "\n", "   ", 
      RowBox[{"(*", "Signals", "*)"}], "\n", "   ", "\n", "   ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Signal-0 = \>\"", ",", " ", "Bold", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
          RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "sig0in", "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{"sig0error", ",", "None"}], "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
          RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", " ", 
        "\"\<a.u.\>\"", ",", "\n", "    ", 
        RowBox[{"RadioButtonBar", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "sig0fixed", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", " ", "->", " ", "\"\<Fixed\>\""}], ",", " ", 
            RowBox[{"2", " ", "->", " ", "\"\<not fixed\>\""}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\"\<Startsignal\>\"", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Signal-HD = \>\"", ",", " ", "Bold", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
          RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "sighdin", "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", "    ", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{"sighderror", ",", "None"}], "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
          RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", "  ", 
        "\"\<a.u.\>\"", ",", "\n", "    ", 
        RowBox[{"RadioButtonBar", "[", " ", 
         RowBox[{
          RowBox[{"Dynamic", "[", "sighdfixed", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", " ", "->", " ", "\"\<Fixed\>\""}], ",", " ", 
            RowBox[{"2", " ", "->", " ", "\"\<not fixed\>\""}]}], "}"}]}], 
         "]"}], ",", "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", "\"\<Signal from HD complex\>\"", "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Signal-D = \>\"", ",", " ", "Bold", ",", " ", 
          RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
          RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "sigdin", "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", " ", 
        RowBox[{"InputField", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", 
           RowBox[{"sigderror", ",", "None"}], "]"}], ",", " ", 
          RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
          RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", " ", 
        "\"\<a.u.\>\"", ",", "\n", "    ", 
        RowBox[{"RadioButtonBar", "[", 
         RowBox[{
          RowBox[{"Dynamic", "[", "sigdfixed", "]"}], ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", " ", "->", " ", "\"\<Fixed\>\""}], ",", " ", 
            RowBox[{"2", " ", "->", " ", "\"\<not fixed\>\""}]}], "}"}]}], 
         "]"}]}], "}"}], ",", "   ", "\[IndentingNewLine]", 
      RowBox[{"{", "\"\<Signal from dye alone\>\"", "}"}], " ", ",", 
      RowBox[{"{", 
       RowBox[{
       "initializebutton", ",", "variablessavebutton", ",", "fitbutton"}], 
       "}"}]}], "\n", "\n", "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\n", "\n", 
   RowBox[{"dataplot", ",", "\"\<  \>\"", ",", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"TableForm", "[", 
       RowBox[{"inputline2", ",", " ", 
        RowBox[{"TableAlignments", " ", "->", " ", "Left"}]}], "]"}], ",", 
      "\"\<Subsubsection\>\"", ",", "Black", ",", 
      RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}]}], "]"}], "\n", "\n", 
  "\t", "\n", "\t\t\t", "\n"}], "\n"}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.7304018583395243`*^9, 3.730401859486709*^9}, {
   3.730403948733839*^9, 3.7304039492836747`*^9}, {3.7304040123581524`*^9, 
   3.730404041503718*^9}, {3.7304040765669107`*^9, 3.730404138677521*^9}, {
   3.730404171442689*^9, 3.7304043560974817`*^9}, {3.730404409651743*^9, 
   3.7304044720838237`*^9}, 3.730404511906062*^9, 3.73040491695927*^9, {
   3.7307008121399865`*^9, 3.7307009122001534`*^9}, {3.7307102183718214`*^9, 
   3.730710426152059*^9}, {3.730713239459134*^9, 3.7307133154109344`*^9}, {
   3.730713385630821*^9, 3.730713421491224*^9}, 3.7307134786002483`*^9, {
   3.730713514490865*^9, 3.7307135702518454`*^9}, 3.7307136039433756`*^9, {
   3.730713644849682*^9, 3.7307137128187957`*^9}, {3.730713745084343*^9, 
   3.730713831757533*^9}, {3.73071417346025*^9, 3.730714186068598*^9}, {
   3.7307143318652124`*^9, 3.7307143367263746`*^9}, 3.730714370881699*^9, {
   3.7307144326013565`*^9, 3.730714433926385*^9}, {3.7307145884907675`*^9, 
   3.730714744119078*^9}, {3.730714778976367*^9, 3.730714782678993*^9}, {
   3.730715052146652*^9, 3.7307151180191894`*^9}, {3.730720143070423*^9, 
   3.730720164416132*^9}, {3.7307202178654203`*^9, 3.730720299521387*^9}, {
   3.7307206088187847`*^9, 3.7307207932211065`*^9}, {3.730720828765464*^9, 
   3.730720837797329*^9}, 3.7307213331110654`*^9, {3.7307219319247293`*^9, 
   3.730721979678924*^9}, {3.7307220639210467`*^9, 3.7307220959241977`*^9}, {
   3.7311368629808145`*^9, 3.731136876763731*^9}, {3.731136938792105*^9, 
   3.731137047225228*^9}, {3.731137278011622*^9, 3.7311374958215675`*^9}, 
   3.731143563944759*^9, {3.731143598520023*^9, 3.731143600068371*^9}, {
   3.7340800034720087`*^9, 3.7340800060202026`*^9}, {3.7340800606877575`*^9, 
   3.7340800947312436`*^9}, {3.73408016983522*^9, 3.734080179025074*^9}, {
   3.7340815435275373`*^9, 3.73408155374137*^9}, {3.734081584932107*^9, 
   3.7340816111061277`*^9}, 3.734082638909396*^9, 3.7340827790190735`*^9, {
   3.734104495782821*^9, 3.7341044962149763`*^9}, 3.7341045400157366`*^9, {
   3.738396064172806*^9, 3.738396069138416*^9}, {3.7406833110521603`*^9, 
   3.7406833404415407`*^9}, {3.7406833904261627`*^9, 3.74068340380059*^9}, {
   3.740683444957164*^9, 3.74068362537678*^9}, {3.740683934543085*^9, 
   3.7406840074791083`*^9}, {3.740684047403782*^9, 3.7406840478100157`*^9}, {
   3.740684081089863*^9, 3.7406840991582127`*^9}, {3.74068413782845*^9, 
   3.7406841549995947`*^9}, {3.7406842678590736`*^9, 3.740684286405158*^9}, {
   3.7422121926604123`*^9, 3.7422122045213113`*^9}, {3.777624788635804*^9, 
   3.777624793078531*^9}, {3.7802249021998453`*^9, 3.78022496201639*^9}, 
   3.7837536832719393`*^9, {3.7837537506053143`*^9, 3.783753771089263*^9}, 
   3.7837539067301083`*^9, {3.7837546342130537`*^9, 3.783754646119975*^9}, 
   3.7837548603043585`*^9, {3.783755031740907*^9, 3.7837550482765274`*^9}, {
   3.78375513526562*^9, 3.78375513666232*^9}, {3.783755254631833*^9, 
   3.7837552856659684`*^9}},
 NumberMarks->False,
 CellTags->"initialroutineHD2IDA",
 CellLabel->
  "In[181]:=",ExpressionUUID->"5204d75b-2b20-4475-b3a0-9812d83d09bc"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    StyleBox[
     DynamicModuleBox[{$CellContext`a1$$ = 1, $CellContext`a2$$ = 1, 
      Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
      Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ =
       1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
         Hold[$CellContext`a1$$], 1, 
         Style["Signal", 
          RGBColor[1, 0, 0]]}, {1, 0}}, {{
         Hold[$CellContext`a2$$], 1, 
         Style["Data", 
          RGBColor[0, 0, 1]]}, {1, 0}}}, Typeset`size$$ = {
      576., {180., 185.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
      Typeset`skipInitDone$$ = True, $CellContext`a1$28963$$ = 
      False, $CellContext`a2$28964$$ = False}, 
      DynamicBox[Manipulate`ManipulateBoxes[
       1, StandardForm, 
        "Variables" :> {$CellContext`a1$$ = 1, $CellContext`a2$$ = 1}, 
        "ControllerVariables" :> {
          Hold[$CellContext`a1$$, $CellContext`a1$28963$$, False], 
          Hold[$CellContext`a2$$, $CellContext`a2$28964$$, False]}, 
        "OtherVariables" :> {
         Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
          Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
          Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
          Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Show[
          
          ListPlot[{$CellContext`a2$$ $CellContext`adjusteddata}, PlotStyle -> 
           Blue, PlotRange -> All], 
          
          Plot[{$CellContext`a1$$ 
            thermoHD`sthdCacheSignal[$CellContext`kequhdin, \
$CellContext`d0in, $CellContext`x, $CellContext`sig0in, $CellContext`sighdin, \
$CellContext`sigdin]}, {$CellContext`x, 0, $CellContext`h0in}, PlotStyle -> 
           Red, PlotRange -> All], PlotRange -> All, 
          PlotLegends -> {
           "Signal", "[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]", "[D]", 
            "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
            "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]"}, ImageSize -> 
          Large, GridLines -> {{$CellContext`d0in}, {}}, AxesOrigin -> {0, 0},
           PlotLabel -> Style["Simulated Data", "Subsection"]], 
        "Specifications" :> {{{$CellContext`a1$$, 1, 
            Style["Signal", 
             RGBColor[1, 0, 0]]}, {1, 0}}, {{$CellContext`a2$$, 1, 
            Style["Data", 
             RGBColor[0, 0, 1]]}, {1, 0}}}, 
        "Options" :> {ControlPlacement -> Right}, "DefaultOptions" :> {}],
       ImageSizeCache->{681., {209., 215.}},
       SingleEvaluation->True],
      Deinitialization:>None,
      DynamicModuleValues:>{},
      SynchronousInitialization->True,
      UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
      UnsavedVariables:>{Typeset`initDone$$},
      UntrackedVariables:>{Typeset`size$$}], "Manipulate",
     Deployed->True,
     StripOnInput->False],
    Manipulate`InterpretManipulate[1]], "\[InvisibleSpace]", "\<\"  \"\>", 
   "\[InvisibleSpace]", 
   StyleBox[
    InterpretationBox[GridBox[{
       {
        StyleBox["\<\"Exact input parameters \"\>",
         StripOnInput->False,
         FontVariations->{"Underline"->True}], 
        StyleBox["\<\"Value\"\>",
         StripOnInput->False,
         FontVariations->{"Underline"->True}], 
        StyleBox["\<\"Error\"\>",
         StripOnInput->False,
         FontVariations->{"Underline"->True}], 
        StyleBox["\<\"Unit\"\>",
         StripOnInput->False,
         FontVariations->{"Underline"->True}], 
        StyleBox["\<\"Fixation\"\>",
         StripOnInput->False,
         FontVariations->{"Underline"->True}], "\<\"\"\>"},
       {
        StyleBox["\<\"[Host] = \"\>",
         StripOnInput->False,
         TextAlignment->Right,
         FontSize->16,
         FontWeight->Bold], 
        InputFieldBox[Dynamic[$CellContext`h0in],
         FieldSize->8], 
        InputFieldBox[Dynamic[$CellContext`h0error, None],
         Background->GrayLevel[0.85],
         FieldSize->
          8], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>", 
        InterpretationBox[
         StyleBox[
          RowBox[{GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`h0fixed], {1},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"Fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}], "  ", GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`h0fixed], {2},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"not fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}]}], "Deploy"],
         RadioButtonBar[
          Dynamic[$CellContext`h0fixed], {
          1 -> "Fixed", 2 -> "not fixed"}]], "\<\"\"\>"},
       {"\<\"concentration of host\"\>", 
        DynamicBox[ToBoxes[$CellContext`h0in 1000000, StandardForm],
         ImageSizeCache->{58., {0., 11.}}], 
        DynamicBox[ToBoxes[$CellContext`h0error 1000000, StandardForm],
         ImageSizeCache->{
          9., {0., 11.}}], "\<\"\[Mu]M\"\>", "\<\"\"\>", "\<\"\"\>"},
       {
        StyleBox["\<\"[Dye] = \"\>",
         StripOnInput->False,
         TextAlignment->Right,
         FontSize->16,
         FontWeight->Bold], 
        InputFieldBox[Dynamic[$CellContext`d0in],
         FieldSize->8], 
        InputFieldBox[Dynamic[$CellContext`d0error, None],
         Background->GrayLevel[0.85],
         FieldSize->
          8], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>", 
        InterpretationBox[
         StyleBox[
          RowBox[{GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`d0fixed], {1},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"Fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}], "  ", GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`d0fixed], {2},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"not fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}]}], "Deploy"],
         RadioButtonBar[
          Dynamic[$CellContext`d0fixed], {
          1 -> "Fixed", 2 -> "not fixed"}]], "\<\"\"\>"},
       {"\<\"concentration of dye\"\>", 
        DynamicBox[ToBoxes[$CellContext`d0in 1000000, StandardForm],
         ImageSizeCache->{31., {0., 11.}}], 
        DynamicBox[ToBoxes[$CellContext`d0error 1000000, StandardForm],
         ImageSizeCache->{
          9., {0., 11.}}], "\<\"\[Mu]M\"\>", "\<\"\"\>", "\<\"\"\>"},
       {
        StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(equ\\)]\\)(HD) = \"\>",
         StripOnInput->False,
         TextAlignment->Right,
         FontSize->16,
         FontWeight->Bold], 
        InputFieldBox[Dynamic[$CellContext`kequhdin],
         FieldSize->8], 
        InputFieldBox[Dynamic[$CellContext`kequhderror, None],
         Background->GrayLevel[0.85],
         FieldSize->
          8], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>", 
        InterpretationBox[
         StyleBox[
          RowBox[{GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`kequhdfixed], {1},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"Fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}], "  ", GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`kequhdfixed], {2},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"not fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}]}], "Deploy"],
         RadioButtonBar[
          Dynamic[$CellContext`kequhdfixed], {
          1 -> "Fixed", 2 -> "not fixed"}]], "\<\"\"\>"},
       {"\<\"affinity of dye for host\"\>", 
        RowBox[{"\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \\(equ\\)]\\))=\"\>", 
         " ", 
         DynamicBox[ToBoxes[
           Log10[$CellContext`kequhdin], StandardForm],
          
          ImageSizeCache->{
           49., {0., 11.}}]}], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
       {
        StyleBox["\<\"Signal-0 = \"\>",
         StripOnInput->False,
         TextAlignment->Right,
         FontSize->16,
         FontWeight->Bold], 
        InputFieldBox[Dynamic[$CellContext`sig0in],
         FieldSize->8], 
        InputFieldBox[Dynamic[$CellContext`sig0error, None],
         Background->GrayLevel[0.85],
         FieldSize->8], "\<\"a.u.\"\>", 
        InterpretationBox[
         StyleBox[
          RowBox[{GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`sig0fixed], {1},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"Fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}], "  ", GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`sig0fixed], {2},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"not fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}]}], "Deploy"],
         RadioButtonBar[
          Dynamic[$CellContext`sig0fixed], {
          1 -> "Fixed", 2 -> "not fixed"}]], "\<\"\"\>"},
       {"\<\"Startsignal\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", \
"\<\"\"\>", "\<\"\"\>"},
       {
        StyleBox["\<\"Signal-HD = \"\>",
         StripOnInput->False,
         TextAlignment->Right,
         FontSize->16,
         FontWeight->Bold], 
        InputFieldBox[Dynamic[$CellContext`sighdin],
         FieldSize->8], 
        InputFieldBox[Dynamic[$CellContext`sighderror, None],
         Background->GrayLevel[0.85],
         FieldSize->8], "\<\"a.u.\"\>", 
        InterpretationBox[
         StyleBox[
          RowBox[{GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`sighdfixed], {1},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"Fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}], "  ", GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`sighdfixed], {2},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"not fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}]}], "Deploy"],
         RadioButtonBar[
          Dynamic[$CellContext`sighdfixed], {
          1 -> "Fixed", 2 -> "not fixed"}]], "\<\"\"\>"},
       {"\<\"Signal from HD complex\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", \
"\<\"\"\>", "\<\"\"\>"},
       {
        StyleBox["\<\"Signal-D = \"\>",
         StripOnInput->False,
         TextAlignment->Right,
         FontSize->16,
         FontWeight->Bold], 
        InputFieldBox[Dynamic[$CellContext`sigdin],
         FieldSize->8], 
        InputFieldBox[Dynamic[$CellContext`sigderror, None],
         Background->GrayLevel[0.85],
         FieldSize->8], "\<\"a.u.\"\>", 
        InterpretationBox[
         StyleBox[
          RowBox[{GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`sigdfixed], {1},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"Fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}], "  ", GridBox[{
             {
              RadioButtonBox[Dynamic[$CellContext`sigdfixed], {2},
               DefaultBaseStyle->"RadioButtonBar"], 
              StyleBox["\<\"not fixed\"\>", "RadioButtonBarLabel",
               StripOnInput->False]}
            },
            AutoDelete->False,
            BaselinePosition->{1, 2},
            GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
            
            GridBoxItemSize->{
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.21]}, 
                Offset[0.27999999999999997`]}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}}]}], "Deploy"],
         RadioButtonBar[
          Dynamic[$CellContext`sigdfixed], {
          1 -> "Fixed", 2 -> "not fixed"}]], "\<\"\"\>"},
       {"\<\"Signal from dye alone\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", \
"\<\"\"\>", "\<\"\"\>"},
       {
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Initialize\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Initilize the values\"",
            TooltipStyle->"TextStyling"],
           Annotation[#, "Initilize the values", "Tooltip"]& ],
          Appearance->None,
          ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
            
            NotebookFind[$CellContext`nb, "initialroutineHD2IDA", All, 
             CellTags], 
            SelectionEvaluate[$CellContext`nb]},
          Evaluator->Automatic,
          Method->"Preemptive"],
         MouseAppearanceTag["LinkHand"]], 
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Save Parameters\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Saves the set values of the parameters\"",
            TooltipStyle->"TextStyling"],
           
           Annotation[#, "Saves the set values of the parameters", 
            "Tooltip"]& ],
          Appearance->None,
          
          ButtonFunction:>{$CellContext`initialparameters = \
{$CellContext`h0in, $CellContext`d0in, $CellContext`step, \
$CellContext`kequhdin, $CellContext`sig0in, $CellContext`sigdin, \
$CellContext`sighdin, $CellContext`factor, $CellContext`cfac}, 
            Export[$CellContext`tempPath, $CellContext`initialparameters]},
          Evaluator->Automatic,
          Method->"Preemptive"],
         MouseAppearanceTag["LinkHand"]], 
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Click here to fit\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Fits the model to the data\"",
            TooltipStyle->"TextStyling"],
           Annotation[#, "Fits the model to the data", "Tooltip"]& ],
          Appearance->None,
          ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
            
            NotebookFind[$CellContext`nb, "fittingroutineHD2IDA", All, 
             CellTags], 
            SelectionEvaluate[$CellContext`nb]},
          Evaluator->Automatic,
          Method->"Preemptive"],
         MouseAppearanceTag["LinkHand"]], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[2.0999999999999996`]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     TableForm[{{
        Style["Exact input parameters ", Underlined], 
        Style["Value", Underlined], 
        Style["Error", Underlined], 
        Style["Unit", Underlined], 
        Style["Fixation", Underlined]}, {
        Style["[Host] = ", Bold, FontSize -> 16, TextAlignment -> Right], 
        InputField[
         Dynamic[$CellContext`h0in], FieldSize -> 8], 
        InputField[
         Dynamic[$CellContext`h0error, None], FieldSize -> 8, Background -> 
         GrayLevel[0.85]], "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)", 
        RadioButtonBar[
         Dynamic[$CellContext`h0fixed], {1 -> "Fixed", 2 -> "not fixed"}]}, {
       "concentration of host", 
        Dynamic[$CellContext`h0in 1000000], 
        Dynamic[$CellContext`h0error 1000000], "\[Mu]M"}, {
        Style["[Dye] = ", Bold, FontSize -> 16, TextAlignment -> Right], 
        InputField[
         Dynamic[$CellContext`d0in], FieldSize -> 8], 
        InputField[
         Dynamic[$CellContext`d0error, None], FieldSize -> 8, Background -> 
         GrayLevel[0.85]], "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)", 
        RadioButtonBar[
         Dynamic[$CellContext`d0fixed], {1 -> "Fixed", 2 -> "not fixed"}]}, {
       "concentration of dye", 
        Dynamic[$CellContext`d0in 1000000], 
        Dynamic[$CellContext`d0error 1000000], "\[Mu]M"}, {
        Style[
        "\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD) = ", Bold, FontSize -> 16, 
         TextAlignment -> Right], 
        InputField[
         Dynamic[$CellContext`kequhdin], FieldSize -> 8], 
        InputField[
         Dynamic[$CellContext`kequhderror, None], FieldSize -> 8, Background -> 
         GrayLevel[0.85]], "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)", 
        RadioButtonBar[
         Dynamic[$CellContext`kequhdfixed], {
         1 -> "Fixed", 2 -> "not fixed"}]}, {
       "affinity of dye for host", 
        "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))=" Dynamic[
          Log10[$CellContext`kequhdin]]}, {
        Style["Signal-0 = ", Bold, FontSize -> 16, TextAlignment -> Right], 
        InputField[
         Dynamic[$CellContext`sig0in], FieldSize -> 8], 
        InputField[
         Dynamic[$CellContext`sig0error, None], FieldSize -> 8, Background -> 
         GrayLevel[0.85]], "a.u.", 
        RadioButtonBar[
         Dynamic[$CellContext`sig0fixed], {
         1 -> "Fixed", 2 -> "not fixed"}]}, {"Startsignal"}, {
        Style["Signal-HD = ", Bold, FontSize -> 16, TextAlignment -> Right], 
        InputField[
         Dynamic[$CellContext`sighdin], FieldSize -> 8], 
        InputField[
         Dynamic[$CellContext`sighderror, None], FieldSize -> 8, Background -> 
         GrayLevel[0.85]], "a.u.", 
        RadioButtonBar[
         Dynamic[$CellContext`sighdfixed], {1 -> "Fixed", 2 -> "not fixed"}], 
        ""}, {"Signal from HD complex"}, {
        Style["Signal-D = ", Bold, FontSize -> 16, TextAlignment -> Right], 
        InputField[
         Dynamic[$CellContext`sigdin], FieldSize -> 8], 
        InputField[
         Dynamic[$CellContext`sigderror, None], FieldSize -> 8, Background -> 
         GrayLevel[0.85]], "a.u.", 
        RadioButtonBar[
         Dynamic[$CellContext`sigdfixed], {
         1 -> "Fixed", 2 -> "not fixed"}]}, {"Signal from dye alone"}, {
        MouseAppearance[
         Button[
          Tooltip[
           Framed[
            Style["Initialize", "Section", FontSize -> 18], RoundingRadius -> 
            15, Background -> GrayLevel[0.85], FrameStyle -> Directive[
              GrayLevel[0.85], 12]], 
           "Initilize the values"], {$CellContext`nb = EvaluationNotebook[], 
           
           NotebookFind[$CellContext`nb, "initialroutineHD2IDA", All, 
            CellTags], 
           SelectionEvaluate[$CellContext`nb]}, Appearance -> None], 
         "LinkHand"], 
        MouseAppearance[
         Button[
          Tooltip[
           Framed[
            Style["Save Parameters", "Section", FontSize -> 18], 
            RoundingRadius -> 15, Background -> GrayLevel[0.85], FrameStyle -> 
            Directive[
              GrayLevel[0.85], 12]], 
           "Saves the set values of the parameters"], \
{$CellContext`initialparameters = {$CellContext`h0in, $CellContext`d0in, \
$CellContext`step, $CellContext`kequhdin, $CellContext`sig0in, \
$CellContext`sigdin, $CellContext`sighdin, $CellContext`factor, \
$CellContext`cfac}, 
           Export[$CellContext`tempPath, $CellContext`initialparameters]}, 
          Appearance -> None], "LinkHand"], 
        MouseAppearance[
         Button[
          Tooltip[
           Framed[
            Style["Click here to fit", "Section", FontSize -> 18], 
            RoundingRadius -> 15, Background -> GrayLevel[0.85], FrameStyle -> 
            Directive[
              GrayLevel[0.85], 12]], 
           "Fits the model to the data"], {$CellContext`nb = 
           EvaluationNotebook[], 
           
           NotebookFind[$CellContext`nb, "fittingroutineHD2IDA", All, 
            CellTags], 
           SelectionEvaluate[$CellContext`nb]}, Appearance -> None], 
         "LinkHand"]}}, TableAlignments -> Left]], "Subsubsection",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontSize->18,
    FontColor->GrayLevel[0]]}],
  SequenceForm[
   Manipulate[
    Show[
     ListPlot[{$CellContext`a2 $CellContext`adjusteddata}, PlotStyle -> Blue, 
      PlotRange -> All], 
     Plot[{$CellContext`a1 
       thermoHD`sthdCacheSignal[$CellContext`kequhdin, $CellContext`d0in, \
$CellContext`x, $CellContext`sig0in, $CellContext`sighdin, \
$CellContext`sigdin]}, {$CellContext`x, 0, $CellContext`h0in}, PlotStyle -> 
      Red, PlotRange -> All], PlotRange -> All, 
     PlotLegends -> {
      "Signal", "[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]", "[D]", 
       "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
       "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]"}, ImageSize -> Large, 
     GridLines -> {{$CellContext`d0in}, {}}, AxesOrigin -> {0, 0}, PlotLabel -> 
     Style["Simulated Data", "Subsection"]], {{$CellContext`a1, 1, 
      Style["Signal", 
       RGBColor[1, 0, 0]]}, {1, 0}}, {{$CellContext`a2, 1, 
      Style["Data", 
       RGBColor[0, 0, 1]]}, {1, 0}}, ControlPlacement -> Right], "  ", 
   Style[
    TableForm[{{
       Style["Exact input parameters ", Underlined], 
       Style["Value", Underlined], 
       Style["Error", Underlined], 
       Style["Unit", Underlined], 
       Style["Fixation", Underlined]}, {
       Style["[Host] = ", Bold, FontSize -> 16, TextAlignment -> Right], 
       InputField[
        Dynamic[$CellContext`h0in], FieldSize -> 8], 
       InputField[
        Dynamic[$CellContext`h0error, None], FieldSize -> 8, Background -> 
        GrayLevel[0.85]], "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)", 
       RadioButtonBar[
        Dynamic[$CellContext`h0fixed], {1 -> "Fixed", 2 -> "not fixed"}]}, {
      "concentration of host", 
       Dynamic[$CellContext`h0in 1000000], 
       Dynamic[$CellContext`h0error 1000000], "\[Mu]M"}, {
       Style["[Dye] = ", Bold, FontSize -> 16, TextAlignment -> Right], 
       InputField[
        Dynamic[$CellContext`d0in], FieldSize -> 8], 
       InputField[
        Dynamic[$CellContext`d0error, None], FieldSize -> 8, Background -> 
        GrayLevel[0.85]], "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)", 
       RadioButtonBar[
        Dynamic[$CellContext`d0fixed], {1 -> "Fixed", 2 -> "not fixed"}]}, {
      "concentration of dye", 
       Dynamic[$CellContext`d0in 1000000], 
       Dynamic[$CellContext`d0error 1000000], "\[Mu]M"}, {
       Style[
       "\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD) = ", Bold, FontSize -> 16, 
        TextAlignment -> Right], 
       InputField[
        Dynamic[$CellContext`kequhdin], FieldSize -> 8], 
       InputField[
        Dynamic[$CellContext`kequhderror, None], FieldSize -> 8, Background -> 
        GrayLevel[0.85]], "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)", 
       RadioButtonBar[
        Dynamic[$CellContext`kequhdfixed], {
        1 -> "Fixed", 2 -> "not fixed"}]}, {
      "affinity of dye for host", "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))=" 
       Dynamic[
         Log10[$CellContext`kequhdin]]}, {
       Style["Signal-0 = ", Bold, FontSize -> 16, TextAlignment -> Right], 
       InputField[
        Dynamic[$CellContext`sig0in], FieldSize -> 8], 
       InputField[
        Dynamic[$CellContext`sig0error, None], FieldSize -> 8, Background -> 
        GrayLevel[0.85]], "a.u.", 
       RadioButtonBar[
        Dynamic[$CellContext`sig0fixed], {1 -> "Fixed", 2 -> "not fixed"}]}, {
      "Startsignal"}, {
       Style["Signal-HD = ", Bold, FontSize -> 16, TextAlignment -> Right], 
       InputField[
        Dynamic[$CellContext`sighdin], FieldSize -> 8], 
       InputField[
        Dynamic[$CellContext`sighderror, None], FieldSize -> 8, Background -> 
        GrayLevel[0.85]], "a.u.", 
       RadioButtonBar[
        Dynamic[$CellContext`sighdfixed], {1 -> "Fixed", 2 -> "not fixed"}], 
       ""}, {"Signal from HD complex"}, {
       Style["Signal-D = ", Bold, FontSize -> 16, TextAlignment -> Right], 
       InputField[
        Dynamic[$CellContext`sigdin], FieldSize -> 8], 
       InputField[
        Dynamic[$CellContext`sigderror, None], FieldSize -> 8, Background -> 
        GrayLevel[0.85]], "a.u.", 
       RadioButtonBar[
        Dynamic[$CellContext`sigdfixed], {1 -> "Fixed", 2 -> "not fixed"}]}, {
      "Signal from dye alone"}, {
       MouseAppearance[
        Button[
         Tooltip[
          Framed[
           Style["Initialize", "Section", FontSize -> 18], RoundingRadius -> 
           15, Background -> GrayLevel[0.85], FrameStyle -> Directive[
             GrayLevel[0.85], 12]], "Initilize the values"], {$CellContext`nb = 
          EvaluationNotebook[], 
          
          NotebookFind[$CellContext`nb, "initialroutineHD2IDA", All, 
           CellTags], 
          SelectionEvaluate[$CellContext`nb]}, Appearance -> None], 
        "LinkHand"], 
       MouseAppearance[
        Button[
         Tooltip[
          Framed[
           Style["Save Parameters", "Section", FontSize -> 18], 
           RoundingRadius -> 15, Background -> GrayLevel[0.85], FrameStyle -> 
           Directive[
             GrayLevel[0.85], 12]], 
          "Saves the set values of the parameters"], \
{$CellContext`initialparameters = {$CellContext`h0in, $CellContext`d0in, \
$CellContext`step, $CellContext`kequhdin, $CellContext`sig0in, \
$CellContext`sigdin, $CellContext`sighdin, $CellContext`factor, \
$CellContext`cfac}, 
          Export[$CellContext`tempPath, $CellContext`initialparameters]}, 
         Appearance -> None], "LinkHand"], 
       MouseAppearance[
        Button[
         Tooltip[
          Framed[
           Style["Click here to fit", "Section", FontSize -> 18], 
           RoundingRadius -> 15, Background -> GrayLevel[0.85], FrameStyle -> 
           Directive[
             GrayLevel[0.85], 12]], 
          "Fits the model to the data"], {$CellContext`nb = 
          EvaluationNotebook[], 
          
          NotebookFind[$CellContext`nb, "fittingroutineHD2IDA", All, 
           CellTags], 
          SelectionEvaluate[$CellContext`nb]}, Appearance -> None], 
        "LinkHand"]}}, TableAlignments -> Left], "Subsubsection", 
    GrayLevel[0], FontSize -> 18]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7837553447150493`*^9, 3.7837553736141715`*^9}, 
   3.7842678369904547`*^9, {3.7946792838666105`*^9, 3.794679306533636*^9}},
 CellTags->"initialroutineHD2IDA",
 CellLabel->
  "During evaluation of \
In[181]:=",ExpressionUUID->"43a3ca7d-8e1e-4ab1-862d-0ec082d76ec6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"inputparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"subparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"concparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"output", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Dye", " ", "affinity", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "h0", "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"h0fixed", "==", " ", "2"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"operator", "=", "1"}], ";", "\n", "\t", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"inputparameter", ",", 
          RowBox[{"{", 
           RowBox[{"h0", ",", "h0in"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"(*", "else", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"h0", "=", "h0in"}], ";", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"subparameter", ",", 
          RowBox[{"{", 
           RowBox[{"h0", " ", "->", " ", "h0in"}], "}"}]}], "]"}], ";"}]}], 
      "\n", "]"}], ";"}], "\n", "*)"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "d0", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"d0fixed", "==", " ", "2"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"d0", ",", "d0in"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"d0", "=", "d0in"}], ";", "\n", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"d0", " ", "->", " ", "d0in"}], "}"}]}], "]"}], ";"}]}], 
     "\n", "]"}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Dye", " ", "affinity", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhd", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"kequhdfixed", "==", " ", "2"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"kequhd", ",", "kequhdin"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"kequhd", "=", "kequhdin"}], ";", "\n", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"kequhd", " ", "->", " ", "kequhdin"}], "}"}]}], "]"}], 
       ";"}]}], "\n", "]"}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Guest", " ", "affinity", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhga", "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"kequhgafixed", "==", " ", "2"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"operator", "=", "1"}], ";", "\n", "\t", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"inputparameter", ",", 
          RowBox[{"{", 
           RowBox[{"kequhga", ",", "kequhgain"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"(*", "else", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"kequhga", "=", "kequhgain"}], ";", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"subparameter", ",", 
          RowBox[{"{", 
           RowBox[{"kequhga", " ", "->", " ", "kequhgain"}], "}"}]}], "]"}], 
        ";"}]}], "\n", "]"}], ";"}], "*)"}], "\n", "\[IndentingNewLine]", 
   "\n", "\t", 
   RowBox[{"(*", "Signals", "*)"}], "\n", "\t\t", "\n", "\t", 
   RowBox[{
    RowBox[{"Clear", "[", "sighd", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"sighdfixed", "==", "2"}], ",", "\n", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sighd", ",", "sighdin"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", 
      RowBox[{
       RowBox[{"sighd", "=", "sighdin"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sighd", " ", "->", " ", "sighdin"}], "}"}]}], "]"}], 
       ";"}]}], "\n", "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Clear", "[", "sigd", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"sigdfixed", "==", " ", "2"}], ",", "\n", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sigd", ",", "sigdin"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", 
      RowBox[{
       RowBox[{"sigd", "=", "sigdin"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sigd", " ", "->", " ", "sigdin"}], "}"}]}], "]"}], ";"}]}],
      "\n", "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Clear", "[", "sig0", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"sig0fixed", "==", " ", "2"}], ",", "\n", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sig0", ",", "sig0in"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", 
      RowBox[{
       RowBox[{"sig0", "=", "sig0in"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sig0", " ", "->", " ", "sig0in"}], "}"}]}], "]"}], ";"}]}],
      "\n", "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"fitsignal", "=", 
     RowBox[{"NonlinearModelFit", "[", 
      RowBox[{"adjusteddata", ",", 
       RowBox[{"sthdCacheSignal", "[", 
        RowBox[{
        "kequhd", ",", "d0", ",", "h0", ",", "sig0", ",", "sighd", ",", 
         "sigd"}], "]"}], ",", "inputparameter", ",", "h0"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"bestfit", "=", 
     RowBox[{"TableForm", "[", 
      RowBox[{"fitsignal", "[", "\"\<ParameterTableEntries\>\"", "]"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "kequhd", ",", "kequhga", ",", "h0", ",", "d0", ",", "ga0", ",", "sighd",
       ",", "sigd", ",", "sig0"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", "outputs", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "sig0out", "]"}], ";", 
    RowBox[{"sig0out", "=", 
     RowBox[{"sig0", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "sig0out", "]"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"sig0pos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "sig0out"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"sig0error", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "sig0pos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"sig0in", "=", "sig0out"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "sighdout", "]"}], ";", 
    RowBox[{"sighdout", "=", 
     RowBox[{"sighd", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "sighdout", "]"}], ",", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{
       RowBox[{"sighdpos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "sighdout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"sighderror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "sighdpos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"sighdin", "=", "sighdout"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "sigdout", "]"}], ";", 
    RowBox[{"sigdout", "=", 
     RowBox[{"sigd", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\n", "\t\t", "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "sigdout", "]"}], ",", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{
       RowBox[{"sigdpos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "sigdout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"sigderror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "sigdpos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"sigdin", "=", "sigdout"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"affinity", " ", "results"}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhdout", "]"}], ";", 
    RowBox[{"kequhdout", "=", 
     RowBox[{"kequhd", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "kequhdout", "]"}], ",", "\[IndentingNewLine]",
       "\t", 
      RowBox[{
       RowBox[{"kequhdpos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "kequhdout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"kequhderror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "kequhdpos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"kequhdin", "=", "kequhdout"}], ";"}]}], "\[IndentingNewLine]",
      "\t", "]"}], ";"}], "\t", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhgaout", "]"}], ";", 
    RowBox[{"kequhgaout", "=", 
     RowBox[{"kequhga", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "kequhgaout", "]"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"kequhgapos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "kequhgaout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"kequhgaerror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "kequhgapos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"kequhgain", "=", "kequhgaout"}], ";"}]}], 
     "\[IndentingNewLine]", "\t", "]"}], ";"}], "\t", "\n", "\t", "\n", "\t", 
   "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"fitteddata", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"sthdCacheSignal", "[", 
          RowBox[{
          "kequhdin", ",", "d0in", ",", "i", ",", "sig0in", ",", "sighdin", 
           ",", "sigdin"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "h0in", ",", 
         RowBox[{"h0in", "/", "50."}]}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fitplot", "=", 
     RowBox[{"Manipulate", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Show", "[", "\t", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a2", "*", "adjusteddata"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", " ", "Blue"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a1", "*", "fitteddata"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", " ", "Red"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Fitted Signal\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]\>\"", ",", 
            "\"\<[D]\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(G\), \(A\)]\)]\>\"", ",", 
            "\"\<[H]\>\""}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "Large"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "d0in", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", " ", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Fitted Data\>\"", ",", "\"\<Subsection\>\""}], 
           "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a1", ",", "1", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Fitted Signal\>\"", ",", "Red"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a2", ",", "1", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Data\>\"", ",", "Blue"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "\n", "\t\t\t", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"inputs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Quantity\>\"", ",", "\"\<Value\>\"", ",", "\"\<Error\>\""}], 
        "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Mode\>\"", ",", "mode", ",", "\"\<\>\""}], "}"}], ",", 
       "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<adjusted R-squared\>\"", ",", 
         RowBox[{"fitsignal", "[", "\"\<AdjustedRSquared\>\"", "]"}], ",", 
         "\"\<\>\""}], "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<conc(H)\>\"", ",", "h0in", ",", "h0error"}], "}"}], ",", 
       "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<conc(D)\>\"", ",", "d0in", ",", "d0error"}], "}"}], ",", 
       "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Kequ(HD)\>\"", ",", "kequhdin", ",", "kequhderror"}], 
        "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Signal-0\>\"", ",", "sig0in", ",", "sig0error"}], "}"}], 
       ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Signal-HD\>\"", ",", "sighdin", ",", "sighderror"}], 
        "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Signal-Dye\>\"", ",", "sigdin", ",", "sigderror"}], 
        "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<c-step\>\"", ",", "step", ",", "\"\<\>\""}], "}"}], ",", 
       "\n", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Concentration factor\>\"", ",", "cfac", ",", "\"\<\>\""}], 
        "}"}]}], "\n", "}"}]}], ";"}], "\n", "\n", "\t", 
   RowBox[{
    RowBox[{"column1", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"inputs", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"column2", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"inputs", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"column3", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"inputs", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"header1", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<[Ga0]\>\"", ",", "\"\<fitted signal\>\""}], "}"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{"header2", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<[Ga0]\>\"", ",", "\"\<measured signal\>\""}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"units", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<M\>\"", ",", "\"\<INT\>\""}], "}"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"put1", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"fitteddata", ",", "units"}], "]"}], ",", "header1"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"put2", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"adjusteddata", ",", "units"}], "]"}], ",", "header2"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"output", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"put1", ",", 
       RowBox[{"List", "/@", 
        RowBox[{"put2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", 
        RowBox[{"put2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", "column1"}], ",", 
       RowBox[{"List", "/@", "column2"}], ",", 
       RowBox[{"List", "/@", "column3"}], ",", "2"}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"stoich1", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"linpart", ",", "linfit", ",", "stoichdata"}], "}"}], ",", 
       "\n", 
       RowBox[{
        RowBox[{"stoichdata", "=", 
         RowBox[{"adjusteddata", "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_"}], "}"}], "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "/", "d0in"}], ",", 
             RowBox[{"normalize", "[", 
              RowBox[{"y", ",", "ymax", ",", "ymin", ",", "2"}], "]"}]}], 
            "}"}]}]}]}], ";", "\n", 
        RowBox[{"linpart", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "stoichdata", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", "0.2"}], "]"}]}], ";", "\n", 
        RowBox[{"linfit", "=", 
         RowBox[{"LinearModelFit", "[", 
          RowBox[{
           RowBox[{"stoichdata", "[", 
            RowBox[{"[", 
             RowBox[{"Range", "[", "linpart", "]"}], "]"}], "]"}], ",", "x", 
           ",", "x"}], "]"}]}], ";", "\n", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"linfit", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "1.05"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", "Thin"}], "}"}]}]}], "]"}], ",", 
          RowBox[{"ListPlot", "[", "stoichdata", "]"}], ",", " ", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", " ", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Molar Fraction\>\"", ",", "\"\<Subsection\>\""}], 
            "]"}]}]}], "]"}]}]}], "\n", "\n", "]"}]}], ";"}], "\n", "\n", 
   "\n", 
   RowBox[{
    RowBox[{"residuals2", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"labels", ",", "plots", ",", "glmresids"}], "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"glmresids", "=", 
         RowBox[{"fitsignal", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<FitResiduals\>\"", ",", "\"\<StandardizedResiduals\>\"", ",", 
            "\"\<StudentizedResiduals\>\"", ",", 
            "\"\<SinglePredictionErrors\>\""}], "}"}], "]"}]}], ";", "\n", 
        RowBox[{"labels", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<fit\>\"", ",", "\"\<Standardized\>\"", ",", "\"\<Student\>\"", 
           ",", "\"\<SinglePredictionError\>\""}], "}"}]}], ";", "\n", 
        RowBox[{"plots", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotLabel", "\[Rule]", "#2"}], ",", 
              RowBox[{"Filling", "\[Rule]", "0"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"glmresids", ",", "labels"}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"GraphicsGrid", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"plots", ",", "2"}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Types of Residuals\>\""}]}], 
         "]"}]}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"exportbutton1", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Save\>\"", ",", "\"\<Save the fitted and acquired data\>\""}], 
          "]"}], ",", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"SystemDialogInput", "[", 
            RowBox[{"\"\<FileSave\>\"", ",", "\"\<.csv\>\""}], "]"}], ",", 
           "output"}], "]"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"res", "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"stoich", "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"residualbotton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Residuals\>\"", ",", "\"\<Several Residual Plots\>\""}], "]"}],
          ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"res", "==", "1"}], ",", 
            RowBox[{"res", "=", "0"}], ",", 
            RowBox[{"res", "=", "1"}]}], "]"}], "]"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"stoichiometrybutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Stoichiometry\>\"", ",", 
           "\"\<Display the Molar Fraction of the data\>\""}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"stoich", "==", "1"}], ",", 
            RowBox[{"stoich", "=", "0"}], ",", 
            RowBox[{"stoich", "=", "1"}]}], "]"}], "]"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"fitplot", ",", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"TableForm", "[", "inputs", "]"}], ",", "\"\<Section\>\"", 
        ",", "Black", ",", 
        RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", "\"\<  \>\"", 
      ",", 
      RowBox[{"TableForm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<You can save the fitted data:\>\"", ",", "\"\<Section\>\"", 
            ",", "Black", ",", 
            RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", 
          "exportbutton1", ",", "residualbotton", ",", 
          "stoichiometrybutton"}], "}"}], ",", 
        RowBox[{"TableAlignments", "\[Rule]", " ", "Center"}]}], "]"}]}], 
     "]"}], ";"}], "\n", 
   RowBox[{"Dynamic", "[", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"res", "\[Equal]", "1"}], ",", "residuals2", ",", "\"\<\>\""}], 
     "]"}], "]"}], "\n", 
   RowBox[{"Dynamic", "[", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"stoich", "\[Equal]", "1"}], ",", "stoich1", ",", "\"\<\>\""}], 
     "]"}], "]"}], "\n", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"Export", "::", "chtype"}], "]"}], ";"}], "\n", 
   "\n"}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.7307152581789722`*^9, 3.73071525991304*^9}, {
   3.7307152899252205`*^9, 3.73071529388127*^9}, {3.7307163184009533`*^9, 
   3.7307163187621555`*^9}, 3.7307163709612694`*^9, {3.7307164108193502`*^9, 
   3.730716468269109*^9}, {3.7307166218508253`*^9, 3.7307167017260113`*^9}, {
   3.730716988584488*^9, 3.7307170399904256`*^9}, {3.7307171140229616`*^9, 
   3.7307171646008673`*^9}, {3.7307172010383143`*^9, 3.730717454584689*^9}, {
   3.7307175840386686`*^9, 3.730717646397438*^9}, {3.730719486183364*^9, 
   3.7307194930685787`*^9}, {3.730719600131325*^9, 3.7307196462103367`*^9}, {
   3.730719695395836*^9, 3.7307196960061064`*^9}, {3.730721429772709*^9, 
   3.7307214953923783`*^9}, {3.730721560437253*^9, 3.7307215875464797`*^9}, {
   3.7307221246101885`*^9, 3.730722138156067*^9}, {3.734080233517248*^9, 
   3.734080304704069*^9}, {3.734080439935092*^9, 3.734080464337762*^9}, {
   3.734082798424388*^9, 3.7340828298700747`*^9}, {3.73410488127538*^9, 
   3.734104971847969*^9}, {3.738396175336505*^9, 3.7383961942068076`*^9}, {
   3.738396226004714*^9, 3.7383962344942713`*^9}, {3.73981467248722*^9, 
   3.7398147741350803`*^9}, {3.7398150317801056`*^9, 
   3.7398152152565093`*^9}, {3.7398156811052217`*^9, 3.739815704604211*^9}, {
   3.7398164792264075`*^9, 3.7398164811638145`*^9}, {3.7398185907081103`*^9, 
   3.739818715077705*^9}, {3.739851192187656*^9, 3.739851232839178*^9}, 
   3.74068044060423*^9, {3.7406843347624903`*^9, 3.740684518468415*^9}, {
   3.740684564096843*^9, 3.7406847208256702`*^9}, {3.7685653508163843`*^9, 
   3.768565354181383*^9}, {3.780385653431858*^9, 3.780385672920825*^9}},
 CellTags->"fittingroutineHD2IDA",
 CellLabel->
  "In[129]:=",ExpressionUUID->"fc90b1b1-049e-4512-a539-da50848a4e0d"],

Cell[BoxData[
 TemplateBox[{
  "General","munfl",
   "\"\\!\\(\\*RowBox[{\\\"Exp\\\", \\\"[\\\", RowBox[{\\\"-\\\", \
\\\"1647.7199014144762`\\\"}], \\\"]\\\"}]\\) is too small to represent as a \
normalized machine number; precision may be lost.\"",2,146,4,
   17123108196088297352,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.794679302722161*^9},
 CellTags->"fittingroutineHD2IDA",
 CellLabel->
  "During evaluation of \
In[129]:=",ExpressionUUID->"b700d483-6d33-4b5e-a930-414902d98747"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    StyleBox[
     DynamicModuleBox[{$CellContext`a1$$ = 1, $CellContext`a2$$ = 1, 
      Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
      Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ =
       1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
         Hold[$CellContext`a1$$], 1, 
         Style["Fitted Signal", 
          RGBColor[1, 0, 0]]}, {1, 0}}, {{
         Hold[$CellContext`a2$$], 1, 
         Style["Data", 
          RGBColor[0, 0, 1]]}, {1, 0}}}, Typeset`size$$ = {
      576., {182., 186.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
      Typeset`skipInitDone$$ = True, $CellContext`a1$28401$$ = 
      False, $CellContext`a2$28402$$ = False}, 
      DynamicBox[Manipulate`ManipulateBoxes[
       1, StandardForm, 
        "Variables" :> {$CellContext`a1$$ = 1, $CellContext`a2$$ = 1}, 
        "ControllerVariables" :> {
          Hold[$CellContext`a1$$, $CellContext`a1$28401$$, False], 
          Hold[$CellContext`a2$$, $CellContext`a2$28402$$, False]}, 
        "OtherVariables" :> {
         Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
          Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
          Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
          Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Show[
          
          ListPlot[{$CellContext`a2$$ $CellContext`adjusteddata}, PlotStyle -> 
           Blue, PlotRange -> All], 
          
          ListLinePlot[{$CellContext`a1$$ $CellContext`fitteddata}, PlotStyle -> 
           Red, PlotRange -> All], PlotRange -> All, 
          PlotLegends -> {
           "Fitted Signal", "[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]", "[D]", 
            "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
            "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]"}, ImageSize -> 
          Large, AxesOrigin -> {0, 0}, GridLines -> {{$CellContext`d0in}, {}},
           PlotLabel -> Style["Fitted Data", "Subsection"]], 
        "Specifications" :> {{{$CellContext`a1$$, 1, 
            Style["Fitted Signal", 
             RGBColor[1, 0, 0]]}, {1, 0}}, {{$CellContext`a2$$, 1, 
            Style["Data", 
             RGBColor[0, 0, 1]]}, {1, 0}}}, 
        "Options" :> {ControlPlacement -> Right}, "DefaultOptions" :> {}],
       ImageSizeCache->{714., {211., 217.}},
       SingleEvaluation->True],
      Deinitialization:>None,
      DynamicModuleValues:>{},
      SynchronousInitialization->True,
      UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
      UnsavedVariables:>{Typeset`initDone$$},
      UntrackedVariables:>{Typeset`size$$}], "Manipulate",
     Deployed->True,
     StripOnInput->False],
    Manipulate`InterpretManipulate[1]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {"\<\"Quantity\"\>", "\<\"Value\"\>", "\<\"Error\"\>"},
       {"\<\"Mode\"\>", "\<\"H0 varied\"\>", "\<\"\"\>"},
       {"\<\"adjusted R-squared\"\>", "0.9999999999993883`", "\<\"\"\>"},
       {"\<\"conc(H)\"\>", "4.03305`*^-6", "0"},
       {"\<\"conc(D)\"\>", "4.08`*^-6", "0"},
       {"\<\"Kequ(HD)\"\>", "4.900000229019881`*^7", "168.55457170877926`"},
       {"\<\"Signal-0\"\>", "0", "0"},
       {"\<\"Signal-HD\"\>", "1", "0"},
       {"\<\"Signal-Dye\"\>", "0", "0"},
       {"\<\"c-step\"\>", "4.0330500000000005`*^-8", "\<\"\"\>"},
       {"\<\"Concentration factor\"\>", "1", "\<\"\"\>"}
      },
      GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[2.0999999999999996`]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     Function[BoxForm`e$, 
      TableForm[BoxForm`e$]]], "Section",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontSize->18,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", "\<\"  \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    TagBox[GridBox[{
       {
        StyleBox["\<\"You can save the fitted data:\"\>", "Section",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->18,
         FontColor->GrayLevel[0]]},
       {
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Save\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Save the fitted and acquired data\"",
            TooltipStyle->"TextStyling"],
           Annotation[#, "Save the fitted and acquired data", "Tooltip"]& ],
          Appearance->None,
          ButtonFunction:>Export[
            SystemDialogInput["FileSave", ".csv"], $CellContext`output],
          Evaluator->Automatic,
          Method->"Queued"],
         MouseAppearanceTag["LinkHand"]]},
       {
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Residuals\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Several Residual Plots\"",
            TooltipStyle->"TextStyling"],
           Annotation[#, "Several Residual Plots", "Tooltip"]& ],
          Appearance->None,
          ButtonFunction:>Dynamic[
            
            If[$CellContext`res == 1, $CellContext`res = 0, $CellContext`res = 
             1]],
          Evaluator->Automatic,
          Method->"Preemptive"],
         MouseAppearanceTag["LinkHand"]]},
       {
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Stoichiometry\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Display the Molar Fraction of the data\"",
            TooltipStyle->"TextStyling"],
           
           Annotation[#, "Display the Molar Fraction of the data", 
            "Tooltip"]& ],
          Appearance->None,
          ButtonFunction:>Dynamic[
            
            If[$CellContext`stoich == 1, $CellContext`stoich = 
             0, $CellContext`stoich = 1]],
          Evaluator->Automatic,
          Method->"Preemptive"],
         MouseAppearanceTag["LinkHand"]]}
      },
      GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.5599999999999999]}, 
          Offset[0.27999999999999997`]}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}}],
     Column],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$, TableAlignments -> Center]]]}],
  SequenceForm[
   Manipulate[
    Show[
     ListPlot[{$CellContext`a2 $CellContext`adjusteddata}, PlotStyle -> Blue, 
      PlotRange -> All], 
     ListLinePlot[{$CellContext`a1 $CellContext`fitteddata}, PlotStyle -> Red,
       PlotRange -> All], PlotRange -> All, 
     PlotLegends -> {
      "Fitted Signal", "[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]", "[D]", 
       "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
       "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]"}, ImageSize -> Large, 
     AxesOrigin -> {0, 0}, GridLines -> {{$CellContext`d0in}, {}}, PlotLabel -> 
     Style["Fitted Data", "Subsection"]], {{$CellContext`a1, 1, 
      Style["Fitted Signal", 
       RGBColor[1, 0, 0]]}, {1, 0}}, {{$CellContext`a2, 1, 
      Style["Data", 
       RGBColor[0, 0, 1]]}, {1, 0}}, ControlPlacement -> Right], 
   Style[
    TableForm[{{"Quantity", "Value", "Error"}, {"Mode", "H0 varied", ""}, {
      "adjusted R-squared", 0.9999999999993883, ""}, {
      "conc(H)", 4.03305*^-6, 0}, {"conc(D)", 4.08*^-6, 0}, {
      "Kequ(HD)", 4.900000229019881*^7, 168.55457170877926`}, {
      "Signal-0", 0, 0}, {"Signal-HD", 1, 0}, {"Signal-Dye", 0, 0}, {
      "c-step", 4.0330500000000005`*^-8, ""}, {
      "Concentration factor", 1, ""}}], "Section", 
    GrayLevel[0], FontSize -> 18], "  ", 
   TableForm[{
     Style["You can save the fitted data:", "Section", 
      GrayLevel[0], FontSize -> 18], 
     MouseAppearance[
      Button[
       Tooltip[
        Framed[
         Style["Save", "Section", FontSize -> 18], RoundingRadius -> 15, 
         Background -> GrayLevel[0.85], FrameStyle -> Directive[
           GrayLevel[0.85], 12]], "Save the fitted and acquired data"], 
       Export[
        SystemDialogInput["FileSave", ".csv"], $CellContext`output], Method -> 
       "Queued", Appearance -> None], "LinkHand"], 
     MouseAppearance[
      Button[
       Tooltip[
        Framed[
         Style["Residuals", "Section", FontSize -> 18], RoundingRadius -> 15, 
         Background -> GrayLevel[0.85], FrameStyle -> Directive[
           GrayLevel[0.85], 12]], "Several Residual Plots"], 
       Dynamic[
        If[$CellContext`res == 1, $CellContext`res = 0, $CellContext`res = 
         1]], Appearance -> None], "LinkHand"], 
     MouseAppearance[
      Button[
       Tooltip[
        Framed[
         Style["Stoichiometry", "Section", FontSize -> 18], RoundingRadius -> 
         15, Background -> GrayLevel[0.85], FrameStyle -> Directive[
           GrayLevel[0.85], 12]], "Display the Molar Fraction of the data"], 
       Dynamic[
        If[$CellContext`stoich == 1, $CellContext`stoich = 
         0, $CellContext`stoich = 1]], Appearance -> None], "LinkHand"]}, 
    TableAlignments -> Center]],
  Editable->False]], "Print",
 CellChangeTimes->{3.783755379108059*^9, 3.784267941074651*^9, 
  3.794679302895998*^9},
 CellTags->"fittingroutineHD2IDA",
 CellLabel->
  "During evaluation of \
In[129]:=",ExpressionUUID->"e8bae8c8-7d24-496e-9a22-4d66e53a918c"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   If[$CellContext`res == 1, $CellContext`residuals2, ""], StandardForm],
  ImageSizeCache->{0., {0., 6.}}]], "Output",
 CellChangeTimes->{3.794679303130782*^9},
 CellTags->"fittingroutineHD2IDA",
 CellLabel->
  "Out[178]=",ExpressionUUID->"402d311c-a9be-462f-8559-7d9cda8aca5c"],

Cell[BoxData[
 DynamicBox[ToBoxes[
   If[$CellContext`stoich == 1, $CellContext`stoich1, ""], StandardForm],
  ImageSizeCache->{0., {0., 6.}}]], "Output",
 CellChangeTimes->{3.7946793031337786`*^9},
 CellTags->"fittingroutineHD2IDA",
 CellLabel->
  "Out[179]=",ExpressionUUID->"51c4bce9-df83-478c-9794-4d49ab4757ad"]
}, Open  ]]
},
InitializationCellEvaluation->True,
InitializationCellWarning->False,
WindowSize->{1920, 997},
WindowMargins->{{1358, Automatic}, {-154, Automatic}},
CellContext->Notebook,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "launchcell"->{
  Cell[3599, 100, 30681, 684, 19, "Input",ExpressionUUID->"bd2d16b9-63a8-4d34-a591-c44736eb277d",
   CellOpen->False,
   InitializationCell->True,
   CellTags->"launchcell"],
  Cell[34305, 788, 7546, 186, 43, "Print",ExpressionUUID->"49e1638d-f282-4e32-aa38-f583ff57887c",
   CellTags->"launchcell"],
  Cell[41854, 976, 6342, 162, 55, "Print",ExpressionUUID->"2e92ca92-28e9-4436-b4cb-5f70af0e8b3f",
   CellTags->"launchcell"],
  Cell[48199, 1140, 2462, 68, 73, "Print",ExpressionUUID->"66858384-0a37-4400-9390-a70de4046383",
   CellTags->"launchcell"],
  Cell[50676, 1211, 4159, 116, 212, "Output",ExpressionUUID->"c5d0cc5e-ecab-432c-b1c7-d41ec2a4eaa5",
   CellTags->"launchcell"]},
 "initialroutineHD2IDA"->{
  Cell[54872, 1332, 20480, 466, 19, "Input",ExpressionUUID->"5204d75b-2b20-4475-b3a0-9812d83d09bc",
   CellOpen->False,
   CellTags->"initialroutineHD2IDA"],
  Cell[75355, 1800, 33237, 785, 434, "Print",ExpressionUUID->"43a3ca7d-8e1e-4ab1-862d-0ec082d76ec6",
   CellTags->"initialroutineHD2IDA"]},
 "fittingroutineHD2IDA"->{
  Cell[108629, 2590, 27958, 716, 19, "Input",ExpressionUUID->"fc90b1b1-049e-4512-a539-da50848a4e0d",
   CellOpen->False,
   CellTags->"fittingroutineHD2IDA"],
  Cell[136590, 3308, 516, 12, 23, "Message",ExpressionUUID->"b700d483-6d33-4b5e-a930-414902d98747",
   CellTags->"fittingroutineHD2IDA"],
  Cell[137109, 3322, 10432, 254, 438, "Print",ExpressionUUID->"e8bae8c8-7d24-496e-9a22-4d66e53a918c",
   CellTags->"fittingroutineHD2IDA"],
  Cell[147544, 3578, 314, 7, 32, "Output",ExpressionUUID->"402d311c-a9be-462f-8559-7d9cda8aca5c",
   CellTags->"fittingroutineHD2IDA"],
  Cell[147861, 3587, 316, 7, 32, "Output",ExpressionUUID->"51c4bce9-df83-478c-9794-4d49ab4757ad",
   CellTags->"fittingroutineHD2IDA"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"launchcell", 148585, 3610},
 {"initialroutineHD2IDA", 149295, 3623},
 {"fittingroutineHD2IDA", 149620, 3629}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1997, 44, 19, "Input",ExpressionUUID->"de2ec15c-7261-4abd-83b2-6ff61d2d7e8f",
 CellOpen->False],
Cell[2580, 68, 982, 27, 91, "Output",ExpressionUUID->"c44f7e1b-b899-4621-901e-60278eb09dca"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3599, 100, 30681, 684, 19, "Input",ExpressionUUID->"bd2d16b9-63a8-4d34-a591-c44736eb277d",
 CellOpen->False,
 InitializationCell->True,
 CellTags->"launchcell"],
Cell[CellGroupData[{
Cell[34305, 788, 7546, 186, 43, "Print",ExpressionUUID->"49e1638d-f282-4e32-aa38-f583ff57887c",
 CellTags->"launchcell"],
Cell[41854, 976, 6342, 162, 55, "Print",ExpressionUUID->"2e92ca92-28e9-4436-b4cb-5f70af0e8b3f",
 CellTags->"launchcell"],
Cell[48199, 1140, 2462, 68, 73, "Print",ExpressionUUID->"66858384-0a37-4400-9390-a70de4046383",
 CellTags->"launchcell"]
}, Open  ]],
Cell[50676, 1211, 4159, 116, 212, "Output",ExpressionUUID->"c5d0cc5e-ecab-432c-b1c7-d41ec2a4eaa5",
 CellTags->"launchcell"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54872, 1332, 20480, 466, 19, "Input",ExpressionUUID->"5204d75b-2b20-4475-b3a0-9812d83d09bc",
 CellOpen->False,
 CellTags->"initialroutineHD2IDA"],
Cell[75355, 1800, 33237, 785, 434, "Print",ExpressionUUID->"43a3ca7d-8e1e-4ab1-862d-0ec082d76ec6",
 CellTags->"initialroutineHD2IDA"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108629, 2590, 27958, 716, 19, "Input",ExpressionUUID->"fc90b1b1-049e-4512-a539-da50848a4e0d",
 CellOpen->False,
 CellTags->"fittingroutineHD2IDA"],
Cell[136590, 3308, 516, 12, 23, "Message",ExpressionUUID->"b700d483-6d33-4b5e-a930-414902d98747",
 CellTags->"fittingroutineHD2IDA"],
Cell[137109, 3322, 10432, 254, 438, "Print",ExpressionUUID->"e8bae8c8-7d24-496e-9a22-4d66e53a918c",
 CellTags->"fittingroutineHD2IDA"],
Cell[147544, 3578, 314, 7, 32, "Output",ExpressionUUID->"402d311c-a9be-462f-8559-7d9cda8aca5c",
 CellTags->"fittingroutineHD2IDA"],
Cell[147861, 3587, 316, 7, 32, "Output",ExpressionUUID->"51c4bce9-df83-478c-9794-4d49ab4757ad",
 CellTags->"fittingroutineHD2IDA"]
}, Open  ]]
}
]
*)

