(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    103630,       2444]
NotebookOptionsPosition[    101608,       2374]
NotebookOutlinePosition[    102892,       2417]
CellTagsIndexPosition[    102735,       2410]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Pane", "[", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Fitting of HD thermodynamics\>\"", ",", "\"\<Chapter\>\""}], 
         "]"}], "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"MouseAppearance", "[", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Launch Application\>\"", ",", "\"\<Section\>\""}], 
             "]"}], ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"nb", "=", 
               RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
              RowBox[{"NotebookFind", "[", 
               RowBox[{
               "nb", ",", "\"\<launchcell\>\"", ",", "All", ",", "CellTags"}],
                "]"}], ",", 
              RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
          "\"\<LinkHand\>\""}], "]"}], "}"}]}], "\n", "\n", "}"}], ",", " ", 
     RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
     RowBox[{"ItemSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"BaselinePosition", "\[Rule]", "Baseline"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.731821909992667*^9, 3.7318220266332903`*^9}, {
   3.7318220650102763`*^9, 3.7318221618988886`*^9}, {3.731822297374745*^9, 
   3.7318223480196705`*^9}, {3.731822393559778*^9, 3.7318224108738403`*^9}, {
   3.731823391470278*^9, 3.7318234673463974`*^9}, {3.7318569879999685`*^9, 
   3.73185698993756*^9}, 3.734079643614863*^9, {3.734080557424387*^9, 
   3.7340805579550896`*^9}}],

Cell[BoxData[
 PaneBox[
  TagBox[GridBox[{
     {
      StyleBox["\<\"Fitting of HD thermodynamics\"\>", "Chapter",
       StripOnInput->False]},
     {
      TagBox[
       ButtonBox[
        StyleBox["\<\"Launch Application\"\>", "Section",
         StripOnInput->False],
        Appearance->None,
        ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
          NotebookFind[$CellContext`nb, "launchcell", All, CellTags], 
          SelectionEvaluate[$CellContext`nb]},
        Evaluator->Automatic,
        Method->"Preemptive"],
       MouseAppearanceTag["LinkHand"]]}
    },
    AutoDelete->False,
    BaselinePosition->Baseline,
    GridBoxAlignment->{"Columns" -> {{Center}}},
    GridBoxItemSize->{"Columns" -> {{Large}}, "Rows" -> {{Large}}}],
   "Grid"],
  Alignment->Center,
  ImageSize->Full]], "Output",
 CellChangeTimes->{{3.7318219954368877`*^9, 3.7318220271538706`*^9}, {
   3.7318220680542727`*^9, 3.731822162920437*^9}, {3.731822307220541*^9, 
   3.7318223482870207`*^9}, {3.731822399987263*^9, 3.7318224115871*^9}, {
   3.7318233967524242`*^9, 3.731823474535568*^9}, {3.7318235311854105`*^9, 
   3.7318235418192897`*^9}, 3.7318235799529233`*^9, 3.7318570141416454`*^9, 
   3.734079645036843*^9, 3.7340811467047234`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Notebook", " ", "settings"}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
      RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], "]"}], ";"}], "\n", 
   RowBox[{"SetOptions", "[", 
    RowBox[{"$FrontEnd", ",", 
     RowBox[{"GlobalInitializationCellWarning", "\[Rule]", "False"}]}], "]"}],
    "\n", "\n", 
   RowBox[{"SetOptions", "[", 
    RowBox[{
     RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
     RowBox[{"InitializationCellEvaluation", "\[Rule]", "True"}], ",", 
     RowBox[{"InitializationCellWarning", "\[Rule]", "False"}]}], "]"}], "\n", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", 
      RowBox[{"\"\<DynamicUpdating\>\"", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", 
      RowBox[{"\"\<DynamicEvaluationTimeout\>\"", "\[Rule]", "30"}]}], "]"}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"set", " ", "values"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"h0fixed", "=", "1"}], ";", " ", 
    RowBox[{"d0fixed", "=", "1"}], ";", 
    RowBox[{"kequhdfixed", "=", "2"}], ";", 
    RowBox[{"kequhgafixed", "=", "2"}], ";", 
    RowBox[{"sighdfixed", "=", "1"}], ";", 
    RowBox[{"sigdfixed", "=", "1"}], ";", 
    RowBox[{"sig0fixed", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"h0error", "=", "0"}], ";", " ", 
    RowBox[{"d0error", "=", "0"}], ";", 
    RowBox[{"kequhderror", "=", "0"}], ";", 
    RowBox[{"kequhgaerror", "=", "0"}], ";", 
    RowBox[{"sighderror", "=", "0"}], ";", 
    RowBox[{"sigderror", "=", "0"}], ";", 
    RowBox[{"sig0error", "=", "0"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Load", " ", "Packges"}], "*)"}], "\t", "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<thermoHD\>\"", ",", 
          "\"\<thermoCacheHD.m\>\""}], "}"}], "]"}], "}"}], "]"}], "]"}], 
    ";"}], "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<thermoCacheComp\>\"", ",", 
          "\"\<thermoCacheComp.m\>\""}], "}"}], "]"}], "}"}], "]"}], "]"}], 
    ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<datagen.m\>\""}], "}"}], "]"}], "}"}],
       "]"}], "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ParentDirectory", "[", 
         RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
        "\"\<Styles\>\"", ",", "\"\<styles.m\>\""}], "}"}], "]"}], "]"}], 
    ";"}], "\n", "\t", "\n", 
   RowBox[{"(*", " ", "Paths", "*)"}], "\n", 
   RowBox[{
    RowBox[{"tempPath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<temp-thermoHG.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cachePath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<cache-thermo.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"defaultPath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<default-thermoHG.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"pathHG", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Samples\>\"", ",", 
        "\"\<Sim-thermoHG.txt\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"initialparameters", "=", 
     RowBox[{"Import", "[", "defaultPath", "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"h0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"d0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"step", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"kequhdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sig0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sigdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sighdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "7", "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{"(*", "Buttons", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"initializebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{"\"\<Initialize\>\"", ",", "\"\<Initilize the values\>\""}],
           "]"}], ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"nb", "=", 
            RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
           RowBox[{"NotebookFind", "[", 
            RowBox[{
            "nb", ",", "\"\<initialroutineHD2IDA\>\"", ",", "All", ",", 
             "CellTags"}], "]"}], ",", 
           RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fitbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Click here to fit\>\"", ",", 
           "\"\<Fits the model to the data\>\""}], "]"}], ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"nb", "=", 
            RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
           RowBox[{"NotebookFind", "[", 
            RowBox[{
            "nb", ",", "\"\<fittingroutineHD2IDA\>\"", ",", "All", ",", 
             "CellTags"}], "]"}], ",", 
           RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"variablessavebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Save Parameters\>\"", ",", 
           "\"\<Saves the set values of the parameters\>\""}], "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"{", "\n", 
             RowBox[{
             "h0in", ",", "\n", "d0in", ",", "\n", "step", ",", "\n", 
              "kequhdin", ",", "\n", "sig0in", ",", "\n", "sigdin", ",", "\n",
               "sighdin"}], "\n", "}"}]}], ",", 
           RowBox[{"Export", "[", 
            RowBox[{"tempPath", ",", "initialparameters"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"variablesloadbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Load Saved Parameters\>\"", ",", 
           "\"\<Loads the previously saved values\>\""}], "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"Import", "[", "tempPath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"step", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}]}], "\n", "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"defaultloadbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Load Default Parameters\>\"", ",", 
           "\"\<Loads the default values of the parameters\>\""}], "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"Import", "[", "defaultPath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"step", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}]}], "\n", "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cachebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Cache Parameters\>\"", ",", 
           "\"\<Caches the parameter's values for transfer\>\""}], "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"cacheparameters", "=", 
            RowBox[{"{", "\n", 
             RowBox[{
             "h0in", ",", "\n", "d0in", ",", "\n", "kequhdin", ",", "\n", 
              "sig0in", ",", "\n", "sigdin", ",", "\n", "sighdin"}], "\n", 
             "}"}]}], ",", 
           RowBox[{"Export", "[", 
            RowBox[{"cachePath", ",", "cacheparameters"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"retrievebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Retrieve Cache\>\"", ",", 
           "\"\<Retrieves the caches parameters from any notebook\>\""}], 
          "]"}], ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"cacheparameters", "=", 
            RowBox[{"Import", "[", "cachePath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"cacheparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}]}], "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"inputline", " ", "=", " ", 
     RowBox[{"{", "\n", "   ", 
      RowBox[{
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<species\>\"", ",", " ", "Bold", ",", "Underlined", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<concentration\>\"", ",", " ", "Bold", ",", "Underlined", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<binding\>\"", ",", " ", "Bold", ",", "Underlined", ",", " ", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}]}], "\n", 
        "   ", "}"}], ",", "\n", "\n", "   ", 
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Host:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "h0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", "\n", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<c-step \>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "step", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", "\n", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<end point \>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", 
            RowBox[{"end", ",", "None"}], "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
           RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", 
         "\"\<M\>\""}], "\n", "}"}], ",", "\n", " ", 
       RowBox[{"{", "\n", " ", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"h0in", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<c-step\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"step", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<from data\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"end", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\""}], 
        "\n", " ", "}"}], ",", "\n", " ", "\n", " ", 
       RowBox[{"{", "\n", " ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Dye:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", "\n", 
         " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "d0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD)\>\"", " ", ",", " ", 
           "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", "\n", 
         " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "kequhdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\>\""}], "\n", 
        "}"}], ",", "\n", "   ", "\n", "   ", 
       RowBox[{"{", "\n", "   ", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"d0in", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"Log10", "[", "kequhdin", "]"}], "]"}], ",", "\"\<\>\""}], 
        "\n", "   ", "}"}], ",", "\n", " ", "\n", "   ", 
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-HD\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sighdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-D\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sigdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-0\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sig0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}]}], "\n", "   ",
         "}"}], ",", "\n", "      ", 
       RowBox[{"{", "\n", "      ", 
        RowBox[{
        "\"\<HD complex\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<dye alone\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<Startsignal\>\""}], "\n", "      ", "}"}]}], "  ", "\n", "    ",
       "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"end", "=", "h0in"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"normchoice", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"TableForm", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "initializebutton", ",", "variablesloadbutton", ",", 
         "variablessavebutton", ",", "defaultloadbutton", ",", "cachebutton", 
         ",", "retrievebutton"}], "}"}], "}"}], "]"}], "]"}], ";"}], "\n", 
   "\n", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"Style", "[", 
      RowBox[{
       RowBox[{"TableForm", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\"\<currently loaded data:\>\"", ",", 
            RowBox[{"Dynamic", "[", "pathHG", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"MouseAppearance", "[", 
            RowBox[{
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"Framed", "[", 
                RowBox[{
                 RowBox[{"Style", "[", 
                  RowBox[{
                   RowBox[{"FileNameSetter", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", "pathHG", "]"}], ",", 
                    "\"\<Open\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"\"\<Readable files\>\"", "\[Rule]", 
                    RowBox[{"{", "\"\<*.TXT\>\"", "}"}]}], ",", 
                    RowBox[{"\"\<All files\>\"", "\[Rule]", 
                    RowBox[{"{", "\"\<*\>\"", "}"}]}]}], "}"}], ",", 
                    RowBox[{"Appearance", "\[Rule]", 
                    RowBox[{"Browse", "..."}]}]}], "]"}], ",", 
                   "\"\<Section\>\"", ",", 
                   RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", 
                 RowBox[{"RoundingRadius", "\[Rule]", "15"}], ",", 
                 RowBox[{"Background", "\[Rule]", "LightGray"}], ",", 
                 RowBox[{"FrameStyle", "\[Rule]", 
                  RowBox[{"Directive", "[", 
                   RowBox[{"LightGray", ",", "12"}], "]"}]}]}], "]"}], ",", 
               "\"\<Browse the file\>\""}], "]"}], ",", "\"\<LinkHand\>\""}], 
            "]"}], "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}], "]"}], ",", "\n", 
       "\"\<Subsubsection\>\"", ",", "Black", ",", 
       RowBox[{"FontSize", "\[Rule]", "14"}]}], "\n", "]"}], "]"}], ";"}], 
   "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Style", "[", 
     RowBox[{
      RowBox[{"TableForm", "[", 
       RowBox[{"inputline", ",", 
        RowBox[{"TableAlignments", "\[Rule]", "Left"}]}], "]"}], ",", 
      "\"\<Subsubsection\>\"", ",", "Black", ",", 
      RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], "*)"}], "\n", "\n", 
   RowBox[{"Style", "[", 
    RowBox[{
     RowBox[{"Grid", "[", 
      RowBox[{"inputline", ",", 
       RowBox[{"Alignment", "\[Rule]", "Left"}]}], "]"}], ",", 
     "\"\<Subsubsection\>\"", ",", "Black", ",", 
     RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], "\n", "\n", 
   "\n"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.730400773395277*^9, 3.7304008352393255`*^9}, {
   3.730401492629541*^9, 3.73040150347148*^9}, {3.730402649565604*^9, 
   3.7304028230281205`*^9}, {3.7304029904431067`*^9, 3.730403080271673*^9}, {
   3.7304031109589834`*^9, 3.7304033952843356`*^9}, {3.730403434815216*^9, 
   3.7304034707397184`*^9}, {3.730403572769393*^9, 3.7304036711451073`*^9}, {
   3.7304037173322906`*^9, 3.7304038263140087`*^9}, {3.7304038664846106`*^9, 
   3.730403892708701*^9}, 3.7304039373324056`*^9, {3.730635884169504*^9, 
   3.730635890234384*^9}, {3.730635977259904*^9, 3.730636125234563*^9}, 
   3.7306361562502937`*^9, {3.730636486363246*^9, 3.730636507704445*^9}, 
   3.730699333959115*^9, 3.730699414337867*^9, {3.7306994572750845`*^9, 
   3.730699471266698*^9}, {3.73070096568909*^9, 3.730700983626526*^9}, 
   3.730701842378021*^9, 3.7307103357721977`*^9, {3.730711599505864*^9, 
   3.7307116052989116`*^9}, {3.7307118430217047`*^9, 
   3.7307118531154985`*^9}, {3.7307118888187237`*^9, 
   3.7307120428818164`*^9}, {3.7307120899121513`*^9, 3.730712091974739*^9}, {
   3.730712158991912*^9, 3.730712301897294*^9}, {3.7307123369917274`*^9, 
   3.7307123615377364`*^9}, {3.730712434386697*^9, 3.73071243545944*^9}, {
   3.730712555569868*^9, 3.730712569491119*^9}, {3.7307126443741517`*^9, 
   3.730712700401746*^9}, {3.7307128842864532`*^9, 3.730712899880815*^9}, 
   3.730713117631132*^9, {3.730714832037506*^9, 3.7307150229472327`*^9}, 
   3.730715152250645*^9, {3.730720928334868*^9, 3.7307209894055443`*^9}, {
   3.7307210437260246`*^9, 3.7307211347099714`*^9}, {3.730721166538047*^9, 
   3.7307211682081127`*^9}, {3.730721268272152*^9, 3.7307212991326036`*^9}, {
   3.73113671379996*^9, 3.731136795673627*^9}, {3.7340796606207995`*^9, 
   3.7340797082038565`*^9}, 3.734079767025264*^9, 3.7340801047041655`*^9, {
   3.7340801901873493`*^9, 3.7340801916538916`*^9}, {3.734080325128217*^9, 
   3.7340803266897755`*^9}, {3.734081166258032*^9, 3.734081192197974*^9}, {
   3.734081311746915*^9, 3.7340813847541847`*^9}, {3.73408151756456*^9, 
   3.73408152411252*^9}, {3.7340820767872324`*^9, 3.7340820775205812`*^9}, 
   3.734082177634734*^9, {3.734082231951256*^9, 3.7340822434321938`*^9}, {
   3.734082281546068*^9, 3.734082454750534*^9}, {3.7340826596192636`*^9, 
   3.7340826634297247`*^9}, 3.7340829264392724`*^9, 3.7341044556968613`*^9, 
   3.7383960133000975`*^9, {3.7398133280147038`*^9, 3.739813350659108*^9}, {
   3.739813383431282*^9, 3.7398133836343946`*^9}, {3.7398134420895004`*^9, 
   3.739813584501944*^9}, {3.739813620861326*^9, 3.73981372917161*^9}, {
   3.7406811529661202`*^9, 3.740681176442217*^9}, {3.740681737874067*^9, 
   3.740681747644923*^9}, {3.74068188451647*^9, 3.7406819124996433`*^9}, {
   3.740681954033555*^9, 3.740682285567932*^9}, {3.7406823484899426`*^9, 
   3.7406824560569997`*^9}, {3.7406825005404754`*^9, 
   3.7406825125811462`*^9}, {3.740682567577265*^9, 3.7406825738467875`*^9}, {
   3.7406826187511215`*^9, 3.7406827171730585`*^9}, {3.7406828040603666`*^9, 
   3.740682862817417*^9}, {3.740682897727971*^9, 3.740682919415039*^9}, {
   3.740682969662922*^9, 3.7406830075825224`*^9}, {3.7406830513924074`*^9, 
   3.7406830874572625`*^9}, {3.740683166481167*^9, 3.7406832591735973`*^9}, {
   3.7406848406224103`*^9, 3.7406849270768523`*^9}, 3.7406849784352016`*^9, {
   3.7407308493843107`*^9, 3.740730861090467*^9}, 3.7407311433336415`*^9, {
   3.740731670650874*^9, 3.74073169391632*^9}, {3.7422116704709234`*^9, 
   3.7422116895402317`*^9}, {3.742212117490425*^9, 3.7422121305363154`*^9}, 
   3.7555882760273476`*^9, {3.755588584214735*^9, 3.755588587835576*^9}, {
   3.755588665103733*^9, 3.7555886689168615`*^9}, {3.755588700437698*^9, 
   3.755588722089323*^9}, {3.7555887669132557`*^9, 3.75558877640061*^9}, {
   3.7555888109949465`*^9, 3.7555888418418107`*^9}},
 CellTags->"launchcell"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Initialize\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Initilize the values\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Initilize the values", "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
         NotebookFind[$CellContext`nb, "initialroutineHD2IDA", All, CellTags], 
         SelectionEvaluate[$CellContext`nb]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Load Saved Parameters\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Loads the previously saved values\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Loads the previously saved values", "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`initialparameters = 
         Import[$CellContext`tempPath], $CellContext`h0in = 
         Part[$CellContext`initialparameters, 1], $CellContext`d0in = 
         Part[$CellContext`initialparameters, 2], $CellContext`step = 
         Part[$CellContext`initialparameters, 3], $CellContext`kequhdin = 
         Part[$CellContext`initialparameters, 4], $CellContext`sig0in = 
         Part[$CellContext`initialparameters, 5], $CellContext`sigdin = 
         Part[$CellContext`initialparameters, 6], $CellContext`sighdin = 
         Part[$CellContext`initialparameters, 7]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Save Parameters\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Saves the set values of the parameters\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Saves the set values of the parameters", "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`initialparameters = {$CellContext`h0in, \
$CellContext`d0in, $CellContext`step, $CellContext`kequhdin, \
$CellContext`sig0in, $CellContext`sigdin, $CellContext`sighdin}, 
         Export[$CellContext`tempPath, $CellContext`initialparameters]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Load Default Parameters\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Loads the default values of the parameters\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Loads the default values of the parameters", 
         "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`initialparameters = 
         Import[$CellContext`defaultPath], $CellContext`h0in = 
         Part[$CellContext`initialparameters, 1], $CellContext`d0in = 
         Part[$CellContext`initialparameters, 2], $CellContext`step = 
         Part[$CellContext`initialparameters, 3], $CellContext`kequhdin = 
         Part[$CellContext`initialparameters, 4], $CellContext`sig0in = 
         Part[$CellContext`initialparameters, 5], $CellContext`sigdin = 
         Part[$CellContext`initialparameters, 6], $CellContext`sighdin = 
         Part[$CellContext`initialparameters, 7]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Cache Parameters\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Caches the parameter's values for transfer\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Caches the parameter's values for transfer", 
         "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`cacheparameters = {$CellContext`h0in, \
$CellContext`d0in, $CellContext`kequhdin, $CellContext`sig0in, \
$CellContext`sigdin, $CellContext`sighdin}, 
         Export[$CellContext`cachePath, $CellContext`cacheparameters]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox["\<\"Retrieve Cache\"\>", "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Retrieves the caches parameters from any notebook\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Retrieves the caches parameters from any notebook", 
         "Tooltip"]& ],
       Appearance->None,
       ButtonFunction:>{$CellContext`cacheparameters = 
         Import[$CellContext`cachePath], $CellContext`h0in = 
         Part[$CellContext`cacheparameters, 1], $CellContext`d0in = 
         Part[$CellContext`cacheparameters, 2], $CellContext`kequhdin = 
         Part[$CellContext`cacheparameters, 3], $CellContext`sig0in = 
         Part[$CellContext`cacheparameters, 4], $CellContext`sigdin = 
         Part[$CellContext`cacheparameters, 5], $CellContext`sighdin = 
         Part[$CellContext`cacheparameters, 6]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.7340823065368586`*^9, 3.7340824571866665`*^9, 3.7340826938321714`*^9, 
   3.7340829331042747`*^9, 3.7341044677183294`*^9, 3.734104638161203*^9, {
   3.7341048625016203`*^9, 3.734104864064183*^9}, 3.7383960201015253`*^9, 
   3.7383960923168573`*^9, {3.738396424745077*^9, 3.7383964264271216`*^9}, 
   3.739004667986473*^9, 3.739678283960523*^9, {3.7398132098008256`*^9, 
   3.7398132173629975`*^9}, 3.7398132542137866`*^9, 3.739813730786275*^9, 
   3.7398633923737793`*^9, 3.7406803130785685`*^9, 3.740681177676546*^9, 
   3.7406817488792458`*^9, 3.7406819149682875`*^9, 3.7406820733914948`*^9, 
   3.7406822985424557`*^9, {3.74068235866333*^9, 3.7406824109392176`*^9}, 
   3.7406824588215384`*^9, 3.7406825067120895`*^9, 3.740682575627949*^9, 
   3.7406826269539027`*^9, 3.740682718657379*^9, {3.7406828142005625`*^9, 
   3.7406828643954725`*^9}, 3.740682922243042*^9, {3.7406829781625443`*^9, 
   3.7406830084574723`*^9}, 3.7406831686441646`*^9, 3.740683229755684*^9, 
   3.7406832606266527`*^9, 3.7406848413098836`*^9, 3.740684928623665*^9, 
   3.7406849800132604`*^9, {3.7407298205456643`*^9, 3.7407298322923155`*^9}, 
   3.740730862925369*^9, 3.740730932019162*^9, {3.7407311323558693`*^9, 
   3.74073114531784*^9}, 3.740731698709323*^9, 3.7407318314758053`*^9, 
   3.7422116157614813`*^9, {3.7422116757550917`*^9, 3.7422116983797464`*^9}, 
   3.742211747351548*^9, 3.742212139051244*^9, 3.742212215978107*^9, {
   3.7555886795887504`*^9, 3.755588703243998*^9}, 3.7555887344852233`*^9, 
   3.7555887787006254`*^9, {3.755588815485031*^9, 3.7555888430879908`*^9}},
 CellTags->"launchcell"],

Cell[BoxData[
 StyleBox[
  InterpretationBox[GridBox[{
     {"\<\"currently loaded data:\"\>", 
      DynamicBox[ToBoxes[$CellContext`pathHG, StandardForm],
       ImageSizeCache->{954., {3., 10.}}]},
     {
      TagBox[
       TagBox[
        TooltipBox[
         FrameBox[
          StyleBox[
           
           TemplateBox[{
            Dynamic[$CellContext`pathHG],"Open",{
             "Readable files" -> {"*.TXT"}, "All files" -> {"*"}},Automatic,
             RowBox[{"Browse", "..."}],None,{"FileNameSetter"},Automatic,0,
             Automatic},
            "FileNameSetterBoxes4"], "Section",
           StripOnInput->False,
           FontSize->18],
          Background->GrayLevel[0.85],
          FrameStyle->Directive[
            GrayLevel[0.85], 12],
          RoundingRadius->15,
          StripOnInput->False],
         "\"Browse the file\"",
         TooltipStyle->"TextStyling"],
        Annotation[#, "Browse the file", "Tooltip"]& ],
       MouseAppearanceTag["LinkHand"]], "\<\"\"\>"},
     {"\<\"\"\>", "\<\"\"\>"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[2.0999999999999996`]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}],
   TableForm[{{"currently loaded data:", 
      Dynamic[$CellContext`pathHG]}, {
      MouseAppearance[
       Tooltip[
        Framed[
         Style[
          FileNameSetter[
           Dynamic[$CellContext`pathHG], "Open", {
           "Readable files" -> {"*.TXT"}, "All files" -> {"*"}}, Appearance -> 
           RepeatedNull[$CellContext`Browse]], "Section", FontSize -> 18], 
         RoundingRadius -> 15, Background -> GrayLevel[0.85], FrameStyle -> 
         Directive[
           GrayLevel[0.85], 12]], "Browse the file"], "LinkHand"]}, {}}]], 
  "Subsubsection",
  StripOnInput->False,
  LineColor->GrayLevel[0],
  FrontFaceColor->GrayLevel[0],
  BackFaceColor->GrayLevel[0],
  GraphicsColor->GrayLevel[0],
  FontSize->14,
  FontColor->GrayLevel[0]]], "Print",
 CellChangeTimes->{
  3.7340823065368586`*^9, 3.7340824571866665`*^9, 3.7340826938321714`*^9, 
   3.7340829331042747`*^9, 3.7341044677183294`*^9, 3.734104638161203*^9, {
   3.7341048625016203`*^9, 3.734104864064183*^9}, 3.7383960201015253`*^9, 
   3.7383960923168573`*^9, {3.738396424745077*^9, 3.7383964264271216`*^9}, 
   3.739004667986473*^9, 3.739678283960523*^9, {3.7398132098008256`*^9, 
   3.7398132173629975`*^9}, 3.7398132542137866`*^9, 3.739813730786275*^9, 
   3.7398633923737793`*^9, 3.7406803130785685`*^9, 3.740681177676546*^9, 
   3.7406817488792458`*^9, 3.7406819149682875`*^9, 3.7406820733914948`*^9, 
   3.7406822985424557`*^9, {3.74068235866333*^9, 3.7406824109392176`*^9}, 
   3.7406824588215384`*^9, 3.7406825067120895`*^9, 3.740682575627949*^9, 
   3.7406826269539027`*^9, 3.740682718657379*^9, {3.7406828142005625`*^9, 
   3.7406828643954725`*^9}, 3.740682922243042*^9, {3.7406829781625443`*^9, 
   3.7406830084574723`*^9}, 3.7406831686441646`*^9, 3.740683229755684*^9, 
   3.7406832606266527`*^9, 3.7406848413098836`*^9, 3.740684928623665*^9, 
   3.7406849800132604`*^9, {3.7407298205456643`*^9, 3.7407298322923155`*^9}, 
   3.740730862925369*^9, 3.740730932019162*^9, {3.7407311323558693`*^9, 
   3.74073114531784*^9}, 3.740731698709323*^9, 3.7407318314758053`*^9, 
   3.7422116157614813`*^9, {3.7422116757550917`*^9, 3.7422116983797464`*^9}, 
   3.742211747351548*^9, 3.742212139051244*^9, 3.742212215978107*^9, {
   3.7555886795887504`*^9, 3.755588703243998*^9}, 3.7555887344852233`*^9, 
   3.7555887787006254`*^9, {3.755588815485031*^9, 3.7555888431262608`*^9}},
 CellTags->"launchcell"]
}, Open  ]],

Cell[BoxData[
 StyleBox[
  TagBox[GridBox[{
     {
      StyleBox["\<\"species\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontWeight->Bold,
       FontVariations->{"Underline"->True}], 
      StyleBox["\<\"concentration\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontWeight->Bold,
       FontVariations->{"Underline"->True}], "\<\"\"\>", 
      StyleBox["\<\"binding\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontWeight->Bold,
       FontVariations->{"Underline"->True}], "", "", "", "", ""},
     {
      StyleBox["\<\"Host:\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`h0in],
       FieldSize->8], "\<\"M\"\>", 
      StyleBox["\<\"c-step \"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`step],
       FieldSize->8], "\<\"M\"\>", 
      StyleBox["\<\"end point \"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`end, None],
       Background->GrayLevel[0.85],
       FieldSize->8], "\<\"M\"\>"},
     {"\<\"\"\>", 
      DynamicBox[ToBoxes[$CellContext`h0in 1000000, StandardForm],
       ImageSizeCache->{49., {0., 12.}}], "\<\"\[Mu]M\"\>", "\<\"c-step\"\>", 
      DynamicBox[ToBoxes[$CellContext`step 1000000, StandardForm],
       ImageSizeCache->{
        40., {0., 12.}}], "\<\"\[Mu]M\"\>", "\<\"from data\"\>", 
      DynamicBox[ToBoxes[$CellContext`end 1000000, StandardForm],
       ImageSizeCache->{49., {0., 12.}}], "\<\"\[Mu]M\"\>"},
     {
      StyleBox["\<\"Dye:\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`d0in],
       FieldSize->8], "\<\"M\"\>", 
      StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(equ\\)]\\)(HD)\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`kequhdin],
       FieldSize->8], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>",
       "", "", ""},
     {"\<\"\"\>", 
      DynamicBox[ToBoxes[$CellContext`d0in 1000000, StandardForm],
       ImageSizeCache->{
        31., {0., 
         12.}}], "\<\"\[Mu]M\"\>", "\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\))\"\>", 
      DynamicBox[ToBoxes[
        Log10[$CellContext`kequhdin], StandardForm],
       ImageSizeCache->{49., {0., 12.}}], "\<\"\"\>", "", "", ""},
     {
      StyleBox["\<\"Signal-HD\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`sighdin],
       FieldSize->8], "\<\"\"\>", 
      StyleBox["\<\"Signal-D\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`sigdin],
       FieldSize->8], "\<\"\"\>", 
      StyleBox["\<\"Signal-0\"\>",
       StripOnInput->False,
       TextAlignment->Right,
       FontSize->16,
       FontWeight->Bold], 
      InputFieldBox[Dynamic[$CellContext`sig0in],
       FieldSize->8], ""},
     {"\<\"HD complex\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"dye alone\"\>", \
"\<\"\"\>", "\<\"\"\>", "\<\"Startsignal\"\>", "", ""}
    },
    AutoDelete->False,
    GridBoxAlignment->{"Columns" -> {{Left}}},
    GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
   "Grid"], "Subsubsection",
  StripOnInput->False,
  LineColor->GrayLevel[0],
  FrontFaceColor->GrayLevel[0],
  BackFaceColor->GrayLevel[0],
  GraphicsColor->GrayLevel[0],
  FontSize->18,
  FontColor->GrayLevel[0]]], "Output",
 CellChangeTimes->{
  3.7406819149995365`*^9, 3.7406820735321145`*^9, 3.7406822985580807`*^9, {
   3.740682358704296*^9, 3.7406824109704647`*^9}, 3.7406824589465322`*^9, 
   3.7406825067433357`*^9, 3.740682575690448*^9, 3.7406826270007744`*^9, 
   3.7406827187511206`*^9, {3.7406828142630596`*^9, 3.740682864426724*^9}, 
   3.740682922274288*^9, {3.7406829782094193`*^9, 3.740683008488722*^9}, 
   3.7406831686910305`*^9, 3.74068322978693*^9, 3.740683260736021*^9, 
   3.7406848413411274`*^9, 3.740684928670537*^9, 3.7406849800445056`*^9, {
   3.7407298205906925`*^9, 3.7407298323189087`*^9}, 3.740730863085193*^9, 
   3.7407309322650537`*^9, {3.740731132390837*^9, 3.740731145351807*^9}, 
   3.7407316987372947`*^9, 3.7407318315067787`*^9, 3.7422116158424063`*^9, {
   3.74221167583202*^9, 3.7422116984047017`*^9}, 3.7422117473781586`*^9, 
   3.7422121390850487`*^9, 3.742212216016367*^9, {3.755588679650466*^9, 
   3.755588703275854*^9}, 3.7555887345109663`*^9, 3.755588778639835*^9, {
   3.7555888154172163`*^9, 3.7555888431363783`*^9}},
 CellTags->"launchcell"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Export", "::", "chtype"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Off", "[", 
    RowBox[{"First", "::", "nofirst"}], "]"}], ";"}], "\n", "\t", "\n", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"datasignal", "=", 
    RowBox[{"sthdCacheSignalData", "[", 
     RowBox[{
     "kequhdin", ",", "d0in", ",", "h0in", ",", "sig0in", ",", "sighdin", ",",
       "sigdin", ",", "step"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataplot", "=", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"datasignal", ",", 
        RowBox[{"PlotStyle", "\[Rule]", " ", "Red"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
      RowBox[{"ImageSize", "\[Rule]", " ", "Large"}], ",", 
      RowBox[{"AxesOrigin", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", " ", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Simulated Data\>\"", ",", "\"\<Subsection\>\""}], 
        "]"}]}]}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"dataplot", "=", 
     RowBox[{"Manipulate", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Show", "[", "\t", "\n", "\t\t\t\t", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a1", "*", "datasignal"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", " ", "Red"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Signal\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]\>\"", ",", 
            "\"\<[D]\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(G\), \(A\)]\)]\>\"", ",", 
            "\"\<[H]\>\""}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "Large"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", " ", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Simulated Data\>\"", ",", "\"\<Subsection\>\""}], 
           "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a1", ",", "1", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Signal\>\"", ",", "Red"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a2", ",", "1", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Data\>\"", ",", "Blue"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "\n", "\t\t\t", 
      "]"}]}], ";"}], "\n", "*)"}], "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "dataplot", "]"}], "\n", "\n", "\t", "\n", "\t\t\t", 
  "\n"}], "\n"}], "Input",
 CellChangeTimes->{{3.7304018583395243`*^9, 3.730401859486709*^9}, {
   3.730403948733839*^9, 3.7304039492836747`*^9}, {3.7304040123581524`*^9, 
   3.730404041503718*^9}, {3.7304040765669107`*^9, 3.730404138677521*^9}, {
   3.730404171442689*^9, 3.7304043560974817`*^9}, {3.730404409651743*^9, 
   3.7304044720838237`*^9}, 3.730404511906062*^9, 3.73040491695927*^9, {
   3.7307008121399865`*^9, 3.7307009122001534`*^9}, {3.7307102183718214`*^9, 
   3.730710426152059*^9}, {3.730713239459134*^9, 3.7307133154109344`*^9}, {
   3.730713385630821*^9, 3.730713421491224*^9}, 3.7307134786002483`*^9, {
   3.730713514490865*^9, 3.7307135702518454`*^9}, 3.7307136039433756`*^9, {
   3.730713644849682*^9, 3.7307137128187957`*^9}, {3.730713745084343*^9, 
   3.730713831757533*^9}, {3.73071417346025*^9, 3.730714186068598*^9}, {
   3.7307143318652124`*^9, 3.7307143367263746`*^9}, 3.730714370881699*^9, {
   3.7307144326013565`*^9, 3.730714433926385*^9}, {3.7307145884907675`*^9, 
   3.730714744119078*^9}, {3.730714778976367*^9, 3.730714782678993*^9}, {
   3.730715052146652*^9, 3.7307151180191894`*^9}, {3.730720143070423*^9, 
   3.730720164416132*^9}, {3.7307202178654203`*^9, 3.730720299521387*^9}, {
   3.7307206088187847`*^9, 3.7307207932211065`*^9}, {3.730720828765464*^9, 
   3.730720837797329*^9}, 3.7307213331110654`*^9, {3.7307219319247293`*^9, 
   3.730721979678924*^9}, {3.7307220639210467`*^9, 3.7307220959241977`*^9}, {
   3.7311368629808145`*^9, 3.731136876763731*^9}, {3.731136938792105*^9, 
   3.731137047225228*^9}, {3.731137278011622*^9, 3.7311374958215675`*^9}, 
   3.731143563944759*^9, {3.731143598520023*^9, 3.731143600068371*^9}, {
   3.7340800034720087`*^9, 3.7340800060202026`*^9}, {3.7340800606877575`*^9, 
   3.7340800947312436`*^9}, {3.73408016983522*^9, 3.734080179025074*^9}, {
   3.7340815435275373`*^9, 3.73408155374137*^9}, {3.734081584932107*^9, 
   3.7340816111061277`*^9}, 3.734082638909396*^9, 3.7340827790190735`*^9, {
   3.734104495782821*^9, 3.7341044962149763`*^9}, 3.7341045400157366`*^9, {
   3.738396064172806*^9, 3.738396069138416*^9}, {3.7406833110521603`*^9, 
   3.7406833404415407`*^9}, {3.7406833904261627`*^9, 3.74068340380059*^9}, {
   3.740683444957164*^9, 3.74068362537678*^9}, {3.740683934543085*^9, 
   3.7406840074791083`*^9}, {3.740684047403782*^9, 3.7406840478100157`*^9}, {
   3.740684081089863*^9, 3.7406840991582127`*^9}, {3.74068413782845*^9, 
   3.7406841549995947`*^9}, {3.7406842678590736`*^9, 3.740684286405158*^9}, {
   3.7422121926604123`*^9, 3.7422122045213113`*^9}, {3.755588879240556*^9, 
   3.755588904636001*^9}, {3.755588936306105*^9, 3.7555889908581877`*^9}, {
   3.7555890348279333`*^9, 3.755589062056639*^9}},
 NumberMarks->False,
 CellTags->"initialroutineHD2IDA"],

Cell[BoxData[
 GraphicsBox[{{}, {{}, {}, 
    {RGBColor[1, 0, 0], PointSize[0.01388888888888889], AbsoluteThickness[
     1.6], LineBox[CompressedData["
1:eJw1lAk0Vdsfxy/lL+lPpEGS2NcUSebxZ7tUhERIJTxJSSoh00uEkoiom0Rk
/qNC3ULmMZmH6+JyDRmeVz2iRKn33n+t3VnrrLPOOufs89vf4SPpcsH6FDeF
Qsn69/z/9dexUX6sqjLLCN/1D9K9dvAsfGt4V6Ds/+s+EGYdP/NlHjDCF5KS
C8bKwuCx2JOJLeK/nkdB/Csjs9hZGnZQ2HVKyCsORCozzHlraeT9BDiyHLAU
cpeGr/Gt+1y0+j5UVmGnFTca+T4J7FUt4gO0aTh7+s9r1okpYHFzOGOJ/9d6
aeDrJZcTwDHEU+MTkcsb0yGixLNwpdCQrJ8BObQ1zNAwQ7xkZdPZ7JQFVcGh
Cnx2huR/OfDhcnZLvJwh5q+p25z0v1zQz37Uvv07Jv/PA+/q1ZZP2jAWV1Z1
OruQD2EpXO6Qhsk8T+C3EHed7ksYK6emZ+voP4Pvi+zxM3sxma8QchKnwri3
YCzJy+cXYVQEgmO214BpQOYthmymYGhwoAHOq6xO8vyjGEQsbts0SBiQ+Z9D
uUqK9YYGwGqX/SttY15AN/fTvjNngeyHAXLOlrRGQcAVu5TH9VVeQuL9wh8K
DH2yv1eQ5Kvin3RMH++bnOaRYb2CK9y88sIUfbLfEgiaG4tNyNLDHcmp8gK/
l4J542t1CTM9sv8ymBTNe8KY08VHbY5YLO54DWVhHfeO0HWJHq/hkY1bIo+e
Lh7nF/TiNJTDctTMueoxHaJPBdTzOg9E3tDBHnWNdxvPVoJiavtzp106RK8q
2GTb925vjzYO1DdwYPFWQ+xMuKtegDbRrxoSuxz3GUtoYwNRsfNmg9UgOJxX
5NigRfSsAVEpvploDy286svi1aqCGgg44WzeKaRF9K0FGZaSw84STfyms/uO
6tVaMBc5WJHsqEn0roUXRrr68jyaOKbgaUaOVR14+C73deVrEP3rwM4juyTR
WgNbRUYxxKj14Ll3xDRkWZ34UQ/DKZtVb6Wp402ubk2xi/XQx73OrXy/OvGn
AZYOhchunlXDbAPawKrmBogODtuaSlcjfjXC+j1XLOxBDaeKbX/v97ARrM3s
TPdPqRL/mkCDuQ153VbFrl+XV957NoHx9XtxbA1V4mcTjMrSKDEjKliuhyng
jN9Aq/zvjOhIFeLvG5iWdpwZ36OCPz4t2tEr3AxLB2w/JbL3EL+bYTrz8LnS
iD24OCpGxWSyGepfvvY7pLyH+P8WDHO0PnqwlfFlN3fj8ldvwW1LQ57YDWWS
hxbIzhWd8lJVxrq0vXbKUS1QOyYoyluzm+SjBeaO3nXq2rYbU7ZLnsl0aIXD
8xU/AwKVSF5a4UdmSyIe3IXrl1cCtuxug7mZBJnzertIftrAMeTzarvHivgm
s/9WNFc7cDPRiB2fIslTOxQrzZiwfRSwRdGLFEpvO8xL+r85OrGT5KsDvCq8
vh+234mFY+Ke+WR3wLf5M942XfIkb51g3F839aelPPZQe+nso9cJB8rMvLJ7
5Uj+OiEYCmb+6yyHD0pluj/N6oSlCsFm+rwsyWMnqAuOFz+MlsXK6+Mv/SHQ
BRwBkLJRkiX57IJvAwEj7SwZLPzzapCUfxdQhF385iJlSF67ICP0nuBlQxn8
5b1nuMNYF4QvTMx9p8iQ/HZDxOCU03+apDFr4HgM/UA3TJauEudPkCZ57oZb
cX+jQFdpXNpkSu983g1qVTNv6nWkSb67QZjyYthlozROZmimrhXvAZ6UtEXm
ApXkvQfWUIIl8plUHJwhnWt8vQf8Fb1OB5VRSf57QFDhYsb7x1TsfGdDUfBs
D8x+XGbk36KSPvSC0gc1uq8fFdOucpWV2PdCbR3AulNU0o9eCJ6ZfaBjQ8XS
nrO18zW9UG/bHN5tTCV96YVLSwmcfA0q5j0+3KKowITs5uTSDHkq6Q8TROae
pD8Up+IZk5Zet7tMmHC15QoQppI+MaG4zug2dQ0Vt2qUDqf9YEJVs/HwzZ+I
9KsP/BOsl+hfEH5KzZkadOuDHXQPPr2PiPStDwa/rBPymEQ4TvjerEhnHwS0
XcrZzEGkfyzQpf3dqMFC2JsStnRQmwX6kq6PKjsR6SMLhFKc3LPfImz710Wu
m+ksCN/AbzlVj0g/WaBdOm7sV4Ww5pDj2jr+fmildnyxLkOkr/2wQKcXeDMQ
3vrWfMMPn34Y1VYz7C1EpL/94MGbu+ZiAcIrr3S2aXL6QUD5XSMtF5E+D8Bu
3bB0k0yEOVly0l77B+AC2ro1OA2Rfg/8y/OWbyPJCNckbFLKLxyArZeE7D0e
INL3AZjzCQoXpyOcEbpac1J0ECLCDvJ/jkek/4OQ1DOS9yEW4YgL8wYSYYNg
9ZNuyRODCA8GoeBQiKBeFMKnT4yaHP0wCONqJ2RibyDCBzY4/CU1vxKO8AGz
dqsEWzbwCgzOhl1DhBdsEON0l0iFIKyoXX6srZINWolUSv8VRPjBhm9x5+PS
gxAWkM07ySs3BFoFPaahAYjwZAguu8vv8PZD+JNI4jnDO0OQV2wj6ueLCF+G
QN+6wyzaG+Ee7uu+Qd+GIPK+1XCRFyK8GQYu/WSu6QsIM+a8gxknh6FFzGl5
53lE+DMMX9O1ha6cQziR89uN2dZhqHXpThs6iwiPOLBovmqtqTvCga2WcfIa
HGiL21JScxoRPnFgnfoOiX1uCDuU6T84mcqBI80mr5muiPCKA+EMi/UXTyJs
kKuQnrJmBGis2VwRF0T4NQJRtIBNdc4IS9JF81leIyAkajYX6IQIz0bga6RP
j64jwqvCeV8IsUcAb7N24TmBCN9GYW2imjHrOMILJYEcaalReF4pIF10DBHe
jUKtvTwj/ijCE88+jdfajcKppaHcIHtE+DcKm5YPlXgcQZiZfWba6dYo3DMx
SHWxQ4SHoyASX77N2RbhxpSR9ytVo7Dz/OqFkzaI8HEU1Gmm056HEf4HQKXA
/Q==
      "]]}}, {}, {}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
         Part[#, 1]], 
        (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
         Part[#, 2]]}& )}},
  PlotLabel->FormBox[
    StyleBox["\"Simulated Data\"", "Subsection", StripOnInput -> False], 
    TraditionalForm],
  PlotRange->{{0, 8.036*^-6}, {0, 39.29488371366657}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Print",
 CellChangeTimes->{
  3.7307135751316643`*^9, {3.7307136288817096`*^9, 3.730713654823436*^9}, 
   3.7307137213691044`*^9, 3.730713755927917*^9, 3.730713790975793*^9, 
   3.7307138229595737`*^9, 3.7307139079752913`*^9, 3.730713981584339*^9, 
   3.73071418871052*^9, 3.730714443946149*^9, {3.7307146664764004`*^9, 
   3.7307146976313524`*^9}, 3.7307151270687037`*^9, {3.730715159974648*^9, 
   3.7307151926003246`*^9}, 3.730716555334223*^9, 3.7307178875073643`*^9, 
   3.730719657006638*^9, {3.730720061631735*^9, 3.7307200739396067`*^9}, 
   3.7307201669824605`*^9, 3.7307202781475697`*^9, 3.730720680443462*^9, {
   3.7307207186621623`*^9, 3.730720730006868*^9}, 3.7307207959457703`*^9, {
   3.730720832788517*^9, 3.7307208404594765`*^9}, {3.730721315772237*^9, 
   3.73072134283412*^9}, {3.730721675707052*^9, 3.7307216993192205`*^9}, {
   3.7307219534182034`*^9, 3.7307219897639523`*^9}, 3.7307220838984175`*^9, 
   3.7307221536289883`*^9, 3.7311275993294697`*^9, {3.731127631495951*^9, 
   3.731127641776045*^9}, 3.731137398587291*^9, {3.7311375002895494`*^9, 
   3.7311375953419704`*^9}, 3.7311436185810947`*^9, {3.731823662738494*^9, 
   3.731823670092236*^9}, {3.7318237573515797`*^9, 3.7318237752852707`*^9}, {
   3.731823863235134*^9, 3.7318238998709593`*^9}, {3.731824253534243*^9, 
   3.731824264180047*^9}, 3.7318242959773183`*^9, {3.731824356021445*^9, 
   3.73182436237876*^9}, {3.734079400380349*^9, 3.7340794177982287`*^9}, 
   3.7340797809856358`*^9, {3.734079899533327*^9, 3.734079909386999*^9}, 
   3.7340799590833063`*^9, 3.7340800119369698`*^9, 3.734080071162752*^9, 
   3.7340802020701003`*^9, 3.734080336918908*^9, 3.734081500203825*^9, 
   3.7340816153704815`*^9, 3.7340820113870277`*^9, {3.734082491334997*^9, 
   3.7340825089180083`*^9}, 3.7340825726294994`*^9, 3.7340826499539213`*^9, {
   3.7340827087030025`*^9, 3.7340827458841887`*^9}, 3.734082854844647*^9, {
   3.7340829370024333`*^9, 3.7340829425178185`*^9}, {3.7341044712541676`*^9, 
   3.734104507117902*^9}, {3.7341046436461763`*^9, 3.734104652352309*^9}, {
   3.7341048660659075`*^9, 3.734104871037693*^9}, {3.738396095103466*^9, 
   3.7383961101986885`*^9}, 3.738396257304105*^9, {3.738396428778676*^9, 
   3.738396435961512*^9}, 3.739004672147033*^9, 3.739005261774173*^9, {
   3.739813256244941*^9, 3.7398132678225603`*^9}, 3.739813311218555*^9, {
   3.7406803166252975`*^9, 3.7406803300682135`*^9}, 3.7406804742397356`*^9, 
   3.740682083391074*^9, {3.7406834308931828`*^9, 3.7406834795488544`*^9}, {
   3.740683553189429*^9, 3.7406835782850285`*^9}, 3.740683626407989*^9, {
   3.7406839893312254`*^9, 3.740684009291514*^9}, 3.7406840489662175`*^9, {
   3.740684086464632*^9, 3.740684101236246*^9}, {3.7406841418126545`*^9, 
   3.7406841568276434`*^9}, 3.7406842909518404`*^9, {3.740684787740373*^9, 
   3.740684810258133*^9}, {3.740685014731975*^9, 3.740685042777664*^9}, {
   3.740724569693965*^9, 3.740724574287524*^9}, {3.7407298353589196`*^9, 
   3.740729847746008*^9}, 3.742212220535878*^9, {3.755588893042984*^9, 
   3.755588905751651*^9}, {3.755588955058215*^9, 3.755588972448943*^9}, 
   3.7555890507050323`*^9},
 CellTags->"initialroutineHD2IDA"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"inputparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"subparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"concparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"output", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Dye", " ", "affinity", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "h0", "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"h0fixed", "==", " ", "2"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"operator", "=", "1"}], ";", "\n", "\t", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"inputparameter", ",", 
          RowBox[{"{", 
           RowBox[{"h0", ",", "h0in"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"(*", "else", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"h0", "=", "h0in"}], ";", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"subparameter", ",", 
          RowBox[{"{", 
           RowBox[{"h0", " ", "->", " ", "h0in"}], "}"}]}], "]"}], ";"}]}], 
      "\n", "]"}], ";"}], "\n", "*)"}], "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "d0", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"d0fixed", "==", " ", "2"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"d0", ",", "d0in"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"d0", "=", "d0in"}], ";", "\n", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"d0", " ", "->", " ", "d0in"}], "}"}]}], "]"}], ";"}]}], 
     "\n", "]"}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Dye", " ", "affinity", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhd", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"kequhdfixed", "==", " ", "2"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", "\t", "\n", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"kequhd", ",", "kequhdin"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", "\t", 
      RowBox[{
       RowBox[{"kequhd", "=", "kequhdin"}], ";", "\n", "\t", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"kequhd", " ", "->", " ", "kequhdin"}], "}"}]}], "]"}], 
       ";"}]}], "\n", "]"}], ";"}], "\n", "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Guest", " ", "affinity", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhga", "]"}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"kequhgafixed", "==", " ", "2"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"operator", "=", "1"}], ";", "\n", "\t", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"inputparameter", ",", 
          RowBox[{"{", 
           RowBox[{"kequhga", ",", "kequhgain"}], "}"}]}], "]"}]}], ",", " ", 
       RowBox[{"(*", "else", "*)"}], "\n", "\t", 
       RowBox[{
        RowBox[{"kequhga", "=", "kequhgain"}], ";", "\n", "\t", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"subparameter", ",", 
          RowBox[{"{", 
           RowBox[{"kequhga", " ", "->", " ", "kequhgain"}], "}"}]}], "]"}], 
        ";"}]}], "\n", "]"}], ";"}], "*)"}], "\n", "\n", "\n", "\t", 
   RowBox[{"(*", "Signals", "*)"}], "\n", "\t\t", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"Clear", "[", "sighd", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"sighdfixed", "==", "2"}], ",", "\n", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sighd", ",", "sighdin"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", 
      RowBox[{
       RowBox[{"sighd", "=", "sighdin"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sighd", " ", "->", " ", "sighdin"}], "}"}]}], "]"}], 
       ";"}]}], "\n", "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Clear", "[", "sigd", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"sigdfixed", "==", " ", "2"}], ",", "\n", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sigd", ",", "sigdin"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", 
      RowBox[{
       RowBox[{"sigd", "=", "sigdin"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sigd", " ", "->", " ", "sigdin"}], "}"}]}], "]"}], ";"}]}],
      "\n", "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Clear", "[", "sig0", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"sig0fixed", "==", " ", "2"}], ",", "\n", 
      RowBox[{
       RowBox[{"operator", "=", "1"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"inputparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sig0", ",", "sig0in"}], "}"}]}], "]"}]}], ",", " ", 
      RowBox[{"(*", "else", "*)"}], "\n", 
      RowBox[{
       RowBox[{"sig0", "=", "sig0in"}], ";", "\n", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"subparameter", ",", 
         RowBox[{"{", 
          RowBox[{"sig0", " ", "->", " ", "sig0in"}], "}"}]}], "]"}], ";"}]}],
      "\n", "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"fitsignal", "=", 
     RowBox[{"NonlinearModelFit", "[", 
      RowBox[{"adjusteddata", ",", 
       RowBox[{"sthdCacheSignal", "[", 
        RowBox[{
        "kequhd", ",", "d0", ",", "h0", ",", "sig0", ",", "sighd", ",", 
         "sigd"}], "]"}], ",", "inputparameter", ",", "h0"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"bestfit", "=", 
     RowBox[{"TableForm", "[", 
      RowBox[{"fitsignal", "[", "\"\<ParameterTableEntries\>\"", "]"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "kequhd", ",", "kequhga", ",", "h0", ",", "d0", ",", "ga0", ",", "sighd",
       ",", "sigd", ",", "sig0"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", "outputs", "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "sig0out", "]"}], ";", 
    RowBox[{"sig0out", "=", 
     RowBox[{"sig0", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "sig0out", "]"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"sig0pos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "sig0out"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"sig0error", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "sig0pos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"sig0in", "=", "sig0out"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "sighdout", "]"}], ";", 
    RowBox[{"sighdout", "=", 
     RowBox[{"sighd", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "sighdout", "]"}], ",", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{
       RowBox[{"sighdpos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "sighdout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"sighderror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "sighdpos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"sighdin", "=", "sighdout"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "sigdout", "]"}], ";", 
    RowBox[{"sigdout", "=", 
     RowBox[{"sigd", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\n", "\t\t", "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "sigdout", "]"}], ",", "\[IndentingNewLine]", 
      "\t", 
      RowBox[{
       RowBox[{"sigdpos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "sigdout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"sigderror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "sigdpos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"sigdin", "=", "sigdout"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"affinity", " ", "results"}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhdout", "]"}], ";", 
    RowBox[{"kequhdout", "=", 
     RowBox[{"kequhd", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\n", "\t", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "kequhdout", "]"}], ",", "\[IndentingNewLine]",
       "\t", 
      RowBox[{
       RowBox[{"kequhdpos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "kequhdout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"kequhderror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "kequhdpos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"kequhdin", "=", "kequhdout"}], ";"}]}], "\[IndentingNewLine]",
      "\t", "]"}], ";"}], "\t", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhgaout", "]"}], ";", 
    RowBox[{"kequhgaout", "=", 
     RowBox[{"kequhga", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "kequhgaout", "]"}], ",", 
      "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"kequhgapos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "kequhgaout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"kequhgaerror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "kequhgapos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"kequhgain", "=", "kequhgaout"}], ";"}]}], 
     "\[IndentingNewLine]", "\t", "]"}], ";"}], "\t", "\n", "\t", "\n", "\t", 
   "\n", "\n", 
   RowBox[{
    RowBox[{"fitteddata", "=", 
     RowBox[{"sthdCacheSignalData", "[", 
      RowBox[{
      "kequhdin", ",", "d0in", ",", "h0in", ",", "sig0in", ",", "sighdin", 
       ",", "sigdin", ",", "step"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"fitplot", "=", 
     RowBox[{"Manipulate", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Show", "[", "\t", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"ListPlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a2", "*", "adjusteddata"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", " ", "Blue"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"ListLinePlot", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a1", "*", "fitteddata"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", " ", "Red"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", "\n", 
         "\t\t\t\t", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Fitted Signal\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]\>\"", ",", 
            "\"\<[D]\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(G\), \(A\)]\)]\>\"", ",", 
            "\"\<[H]\>\""}], "}"}]}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "Large"}], ",", 
         RowBox[{"AxesOrigin", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0"}], "}"}]}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "h0in", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotLabel", "\[Rule]", " ", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Fitted Data\>\"", ",", "\"\<Subsection\>\""}], 
           "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a1", ",", "1", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Fitted Signal\>\"", ",", "Red"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a2", ",", "1", ",", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Data\>\"", ",", "Blue"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
       RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "\n", "\t\t\t", 
      "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"inputs", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Quantity\>\"", ",", "\"\<Value\>\"", ",", "\"\<Error\>\""}], 
        "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Mode\>\"", ",", "mode", ",", "\"\<\>\""}], "}"}], ",", 
       "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<adjusted R-squared\>\"", ",", 
         RowBox[{"fitsignal", "[", "\"\<AdjustedRSquared\>\"", "]"}], ",", 
         "\"\<\>\""}], "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<conc(H)\>\"", ",", "h0in", ",", "h0error"}], "}"}], ",", 
       "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<conc(D)\>\"", ",", "d0in", ",", "d0error"}], "}"}], ",", 
       "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Kequ(HD)\>\"", ",", "kequhdin", ",", "kequhderror"}], 
        "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Signal-0\>\"", ",", "sig0in", ",", "sig0error"}], "}"}], 
       ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Signal-HD\>\"", ",", "sighdin", ",", "sighderror"}], 
        "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<Signal-Dye\>\"", ",", "sigdin", ",", "sigderror"}], 
        "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"\"\<c-step\>\"", ",", "step", ",", "\"\<\>\""}], "}"}], ",", 
       "\n", 
       RowBox[{"{", 
        RowBox[{
        "\"\<Concentration factor\>\"", ",", "cfac", ",", "\"\<\>\""}], 
        "}"}]}], "\n", "}"}]}], ";"}], "\n", "\n", "\t", 
   RowBox[{
    RowBox[{"column1", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"inputs", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"column2", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"inputs", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"column3", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"inputs", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"header1", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<[Ga0]\>\"", ",", "\"\<fitted signal\>\""}], "}"}]}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{"header2", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<[Ga0]\>\"", ",", "\"\<measured signal\>\""}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"units", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<M\>\"", ",", "\"\<INT\>\""}], "}"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"put1", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"fitteddata", ",", "units"}], "]"}], ",", "header1"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"put2", "=", 
     RowBox[{"Prepend", "[", 
      RowBox[{
       RowBox[{"Prepend", "[", 
        RowBox[{"adjusteddata", ",", "units"}], "]"}], ",", "header2"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"output", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"put1", ",", 
       RowBox[{"List", "/@", 
        RowBox[{"put2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", 
        RowBox[{"put2", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", "column1"}], ",", 
       RowBox[{"List", "/@", "column2"}], ",", 
       RowBox[{"List", "/@", "column3"}], ",", "2"}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"stoich1", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"linpart", ",", "linfit", ",", "stoichdata"}], "}"}], ",", 
       "\n", 
       RowBox[{
        RowBox[{"stoichdata", "=", 
         RowBox[{"adjusteddata", "/.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x_", ",", "y_"}], "}"}], "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "/", "d0in"}], ",", 
             RowBox[{"normalize", "[", 
              RowBox[{"y", ",", "ymax", ",", "ymin", ",", "2"}], "]"}]}], 
            "}"}]}]}]}], ";", "\n", 
        RowBox[{"linpart", "=", 
         RowBox[{"IntegerPart", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Dimensions", "[", "stoichdata", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "*", "0.2"}], "]"}]}], ";", "\n", 
        RowBox[{"linfit", "=", 
         RowBox[{"LinearModelFit", "[", 
          RowBox[{
           RowBox[{"stoichdata", "[", 
            RowBox[{"[", 
             RowBox[{"Range", "[", "linpart", "]"}], "]"}], "]"}], ",", "x", 
           ",", "x"}], "]"}]}], ";", "\n", 
        RowBox[{"Show", "[", 
         RowBox[{
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"linfit", "[", "x", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "1.05"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Gray", ",", "Thin"}], "}"}]}]}], "]"}], ",", 
          RowBox[{"ListPlot", "[", "stoichdata", "]"}], ",", " ", 
          RowBox[{"GridLines", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", " ", "All"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", " ", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<Molar Fraction\>\"", ",", "\"\<Subsection\>\""}], 
            "]"}]}]}], "]"}]}]}], "\n", "\n", "]"}]}], ";"}], "\n", "\n", 
   "\n", 
   RowBox[{
    RowBox[{"residuals2", ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"labels", ",", "plots", ",", "glmresids"}], "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"glmresids", "=", 
         RowBox[{"fitsignal", "[", 
          RowBox[{"{", 
           RowBox[{
           "\"\<FitResiduals\>\"", ",", "\"\<StandardizedResiduals\>\"", ",", 
            "\"\<StudentizedResiduals\>\"", ",", 
            "\"\<SinglePredictionErrors\>\""}], "}"}], "]"}]}], ";", "\n", 
        RowBox[{"labels", "=", 
         RowBox[{"{", 
          RowBox[{
          "\"\<fit\>\"", ",", "\"\<Standardized\>\"", ",", "\"\<Student\>\"", 
           ",", "\"\<SinglePredictionError\>\""}], "}"}]}], ";", "\n", 
        RowBox[{"plots", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ListPlot", "[", 
             RowBox[{"#1", ",", 
              RowBox[{"Frame", "\[Rule]", "True"}], ",", 
              RowBox[{"PlotLabel", "\[Rule]", "#2"}], ",", 
              RowBox[{"Filling", "\[Rule]", "0"}]}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"glmresids", ",", "labels"}], "}"}]}], "]"}]}], ";", "\n", 
        RowBox[{"GraphicsGrid", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{"plots", ",", "2"}], "]"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"PlotLabel", "\[Rule]", "\"\<Types of Residuals\>\""}]}], 
         "]"}]}]}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"exportbutton1", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Save\>\"", ",", "\"\<Save the fitted and acquired data\>\""}], 
          "]"}], ",", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"SystemDialogInput", "[", 
            RowBox[{"\"\<FileSave\>\"", ",", "\"\<.csv\>\""}], "]"}], ",", 
           "output"}], "]"}], ",", 
         RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"res", "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"stoich", "=", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"residualbotton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Residuals\>\"", ",", "\"\<Several Residual Plots\>\""}], "]"}],
          ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"res", "==", "1"}], ",", 
            RowBox[{"res", "=", "0"}], ",", 
            RowBox[{"res", "=", "1"}]}], "]"}], "]"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"stoichiometrybutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{
         RowBox[{"stylesButtonGenericStyle", "[", 
          RowBox[{
          "\"\<Stoichiometry\>\"", ",", 
           "\"\<Display the Molar Fraction of the data\>\""}], "]"}], ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"stoich", "==", "1"}], ",", 
            RowBox[{"stoich", "=", "0"}], ",", 
            RowBox[{"stoich", "=", "1"}]}], "]"}], "]"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"fitplot", ",", 
      RowBox[{"Style", "[", 
       RowBox[{
        RowBox[{"TableForm", "[", "inputs", "]"}], ",", "\"\<Section\>\"", 
        ",", "Black", ",", 
        RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", "\"\<  \>\"", 
      ",", 
      RowBox[{"TableForm", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<You can save the fitted data:\>\"", ",", "\"\<Section\>\"", 
            ",", "Black", ",", 
            RowBox[{"FontSize", "\[Rule]", "18"}]}], "]"}], ",", 
          "exportbutton1", ",", "residualbotton", ",", 
          "stoichiometrybutton"}], "}"}], ",", 
        RowBox[{"TableAlignments", "\[Rule]", " ", "Center"}]}], "]"}]}], 
     "]"}], ";"}], "\n", 
   RowBox[{"Dynamic", "[", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"res", "\[Equal]", "1"}], ",", "residuals2", ",", "\"\<\>\""}], 
     "]"}], "]"}], "\n", 
   RowBox[{"Dynamic", "[", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"stoich", "\[Equal]", "1"}], ",", "stoich1", ",", "\"\<\>\""}], 
     "]"}], "]"}], "\n", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"Export", "::", "chtype"}], "]"}], ";"}], "\n", 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.7307152581789722`*^9, 3.73071525991304*^9}, {
   3.7307152899252205`*^9, 3.73071529388127*^9}, {3.7307163184009533`*^9, 
   3.7307163187621555`*^9}, 3.7307163709612694`*^9, {3.7307164108193502`*^9, 
   3.730716468269109*^9}, {3.7307166218508253`*^9, 3.7307167017260113`*^9}, {
   3.730716988584488*^9, 3.7307170399904256`*^9}, {3.7307171140229616`*^9, 
   3.7307171646008673`*^9}, {3.7307172010383143`*^9, 3.730717454584689*^9}, {
   3.7307175840386686`*^9, 3.730717646397438*^9}, {3.730719486183364*^9, 
   3.7307194930685787`*^9}, {3.730719600131325*^9, 3.7307196462103367`*^9}, {
   3.730719695395836*^9, 3.7307196960061064`*^9}, {3.730721429772709*^9, 
   3.7307214953923783`*^9}, {3.730721560437253*^9, 3.7307215875464797`*^9}, {
   3.7307221246101885`*^9, 3.730722138156067*^9}, {3.734080233517248*^9, 
   3.734080304704069*^9}, {3.734080439935092*^9, 3.734080464337762*^9}, {
   3.734082798424388*^9, 3.7340828298700747`*^9}, {3.73410488127538*^9, 
   3.734104971847969*^9}, {3.738396175336505*^9, 3.7383961942068076`*^9}, {
   3.738396226004714*^9, 3.7383962344942713`*^9}, {3.73981467248722*^9, 
   3.7398147741350803`*^9}, {3.7398150317801056`*^9, 
   3.7398152152565093`*^9}, {3.7398156811052217`*^9, 3.739815704604211*^9}, {
   3.7398164792264075`*^9, 3.7398164811638145`*^9}, {3.7398185907081103`*^9, 
   3.739818715077705*^9}, {3.739851192187656*^9, 3.739851232839178*^9}, 
   3.74068044060423*^9, {3.7406843347624903`*^9, 3.740684518468415*^9}, {
   3.740684564096843*^9, 3.7406847208256702`*^9}},
 CellTags->"fittingroutineHD2IDA"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    StyleBox[
     DynamicModuleBox[{$CellContext`a1$$ = 1, $CellContext`a2$$ = 1, 
      Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
      Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ =
       1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
         Hold[$CellContext`a1$$], 1, 
         Style["Fitted Signal", 
          RGBColor[1, 0, 0]]}, {1, 0}}, {{
         Hold[$CellContext`a2$$], 1, 
         Style["Data", 
          RGBColor[0, 0, 1]]}, {1, 0}}}, Typeset`size$$ = {
      576., {190., 196.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
      Typeset`skipInitDone$$ = True, $CellContext`a1$35610$$ = 
      False, $CellContext`a2$35611$$ = False}, 
      DynamicBox[Manipulate`ManipulateBoxes[
       1, StandardForm, 
        "Variables" :> {$CellContext`a1$$ = 1, $CellContext`a2$$ = 1}, 
        "ControllerVariables" :> {
          Hold[$CellContext`a1$$, $CellContext`a1$35610$$, False], 
          Hold[$CellContext`a2$$, $CellContext`a2$35611$$, False]}, 
        "OtherVariables" :> {
         Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
          Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
          Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
          Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Show[
          
          ListPlot[{$CellContext`a2$$ $CellContext`adjusteddata}, PlotStyle -> 
           Blue, PlotRange -> All], 
          
          ListLinePlot[{$CellContext`a1$$ $CellContext`fitteddata}, PlotStyle -> 
           Red, PlotRange -> All], PlotRange -> All, 
          PlotLegends -> {
           "Fitted Signal", "[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]", "[D]", 
            "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
            "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]"}, ImageSize -> 
          Large, AxesOrigin -> {0, 0}, GridLines -> {{$CellContext`h0in}, {}},
           PlotLabel -> Style["Fitted Data", "Subsection"]], 
        "Specifications" :> {{{$CellContext`a1$$, 1, 
            Style["Fitted Signal", 
             RGBColor[1, 0, 0]]}, {1, 0}}, {{$CellContext`a2$$, 1, 
            Style["Data", 
             RGBColor[0, 0, 1]]}, {1, 0}}}, 
        "Options" :> {ControlPlacement -> Right}, "DefaultOptions" :> {}],
       ImageSizeCache->{714., {220., 226.}},
       SingleEvaluation->True],
      Deinitialization:>None,
      DynamicModuleValues:>{},
      SynchronousInitialization->True,
      UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
      UnsavedVariables:>{Typeset`initDone$$},
      UntrackedVariables:>{Typeset`size$$}], "Manipulate",
     Deployed->True,
     StripOnInput->False],
    Manipulate`InterpretManipulate[1]], "\[InvisibleSpace]", 
   StyleBox[
    TagBox[GridBox[{
       {"\<\"Quantity\"\>", "\<\"Value\"\>", "\<\"Error\"\>"},
       {"\<\"Mode\"\>", "\<\"H0 varied\"\>", "\<\"\"\>"},
       {"\<\"adjusted R-squared\"\>", "0.9999999999993883`", "\<\"\"\>"},
       {"\<\"conc(H)\"\>", "8.036`*^-6", "0"},
       {"\<\"conc(D)\"\>", "4.08`*^-6", "0"},
       {"\<\"Kequ(HD)\"\>", "4.900000229019881`*^7", "168.5545717087793`"},
       {"\<\"Signal-0\"\>", "0", "0"},
       {"\<\"Signal-HD\"\>", "1", "0"},
       {"\<\"Signal-Dye\"\>", "0", "0"},
       {"\<\"c-step\"\>", "4.0330500000000005`*^-8", "\<\"\"\>"},
       {"\<\"Concentration factor\"\>", "1", "\<\"\"\>"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[2.0999999999999996`]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     Function[BoxForm`e$, 
      TableForm[BoxForm`e$]]], "Section",
    StripOnInput->False,
    LineColor->GrayLevel[0],
    FrontFaceColor->GrayLevel[0],
    BackFaceColor->GrayLevel[0],
    GraphicsColor->GrayLevel[0],
    FontSize->18,
    FontColor->GrayLevel[0]], "\[InvisibleSpace]", "\<\"  \"\>", 
   "\[InvisibleSpace]", 
   TagBox[
    TagBox[GridBox[{
       {
        StyleBox["\<\"You can save the fitted data:\"\>", "Section",
         StripOnInput->False,
         LineColor->GrayLevel[0],
         FrontFaceColor->GrayLevel[0],
         BackFaceColor->GrayLevel[0],
         GraphicsColor->GrayLevel[0],
         FontSize->18,
         FontColor->GrayLevel[0]]},
       {
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Save\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Save the fitted and acquired data\"",
            TooltipStyle->"TextStyling"],
           Annotation[#, "Save the fitted and acquired data", "Tooltip"]& ],
          Appearance->None,
          ButtonFunction:>Export[
            SystemDialogInput["FileSave", ".csv"], $CellContext`output],
          Evaluator->Automatic,
          Method->"Queued"],
         MouseAppearanceTag["LinkHand"]]},
       {
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Residuals\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Several Residual Plots\"",
            TooltipStyle->"TextStyling"],
           Annotation[#, "Several Residual Plots", "Tooltip"]& ],
          Appearance->None,
          ButtonFunction:>Dynamic[
            
            If[$CellContext`res == 1, $CellContext`res = 0, $CellContext`res = 
             1]],
          Evaluator->Automatic,
          Method->"Preemptive"],
         MouseAppearanceTag["LinkHand"]]},
       {
        TagBox[
         ButtonBox[
          TagBox[
           TooltipBox[
            FrameBox[
             StyleBox["\<\"Stoichiometry\"\>", "Section",
              StripOnInput->False,
              FontSize->18],
             Background->GrayLevel[0.85],
             FrameStyle->Directive[
               GrayLevel[0.85], 12],
             RoundingRadius->15,
             StripOnInput->False],
            "\"Display the Molar Fraction of the data\"",
            TooltipStyle->"TextStyling"],
           
           Annotation[#, "Display the Molar Fraction of the data", 
            "Tooltip"]& ],
          Appearance->None,
          ButtonFunction:>Dynamic[
            
            If[$CellContext`stoich == 1, $CellContext`stoich = 
             0, $CellContext`stoich = 1]],
          Evaluator->Automatic,
          Method->"Preemptive"],
         MouseAppearanceTag["LinkHand"]]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.5599999999999999]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}],
     Column],
    Function[BoxForm`e$, 
     TableForm[BoxForm`e$, TableAlignments -> Center]]]}],
  SequenceForm[
   Manipulate[
    Show[
     ListPlot[{$CellContext`a2 $CellContext`adjusteddata}, PlotStyle -> Blue, 
      PlotRange -> All], 
     ListLinePlot[{$CellContext`a1 $CellContext`fitteddata}, PlotStyle -> Red,
       PlotRange -> All], PlotRange -> All, 
     PlotLegends -> {
      "Fitted Signal", "[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]", "[D]", 
       "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
       "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]"}, ImageSize -> Large, 
     AxesOrigin -> {0, 0}, GridLines -> {{$CellContext`h0in}, {}}, PlotLabel -> 
     Style["Fitted Data", "Subsection"]], {{$CellContext`a1, 1, 
      Style["Fitted Signal", 
       RGBColor[1, 0, 0]]}, {1, 0}}, {{$CellContext`a2, 1, 
      Style["Data", 
       RGBColor[0, 0, 1]]}, {1, 0}}, ControlPlacement -> Right], 
   Style[
    TableForm[{{"Quantity", "Value", "Error"}, {"Mode", "H0 varied", ""}, {
      "adjusted R-squared", 0.9999999999993883, ""}, {
      "conc(H)", 8.036*^-6, 0}, {"conc(D)", 4.08*^-6, 0}, {
      "Kequ(HD)", 4.900000229019881*^7, 168.5545717087793}, {
      "Signal-0", 0, 0}, {"Signal-HD", 1, 0}, {"Signal-Dye", 0, 0}, {
      "c-step", 4.0330500000000005`*^-8, ""}, {
      "Concentration factor", 1, ""}}], "Section", 
    GrayLevel[0], FontSize -> 18], "  ", 
   TableForm[{
     Style["You can save the fitted data:", "Section", 
      GrayLevel[0], FontSize -> 18], 
     MouseAppearance[
      Button[
       Tooltip[
        Framed[
         Style["Save", "Section", FontSize -> 18], RoundingRadius -> 15, 
         Background -> GrayLevel[0.85], FrameStyle -> Directive[
           GrayLevel[0.85], 12]], "Save the fitted and acquired data"], 
       Export[
        SystemDialogInput["FileSave", ".csv"], $CellContext`output], Method -> 
       "Queued", Appearance -> None], "LinkHand"], 
     MouseAppearance[
      Button[
       Tooltip[
        Framed[
         Style["Residuals", "Section", FontSize -> 18], RoundingRadius -> 15, 
         Background -> GrayLevel[0.85], FrameStyle -> Directive[
           GrayLevel[0.85], 12]], "Several Residual Plots"], 
       Dynamic[
        If[$CellContext`res == 1, $CellContext`res = 0, $CellContext`res = 
         1]], Appearance -> None], "LinkHand"], 
     MouseAppearance[
      Button[
       Tooltip[
        Framed[
         Style["Stoichiometry", "Section", FontSize -> 18], RoundingRadius -> 
         15, Background -> GrayLevel[0.85], FrameStyle -> Directive[
           GrayLevel[0.85], 12]], "Display the Molar Fraction of the data"], 
       Dynamic[
        If[$CellContext`stoich == 1, $CellContext`stoich = 
         0, $CellContext`stoich = 1]], Appearance -> None], "LinkHand"]}, 
    TableAlignments -> Center]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.730716469896784*^9, 3.730716494568347*^9}, {
   3.7307165602174377`*^9, 3.7307165698504515`*^9}, {3.7307170059123325`*^9, 
   3.730717042419239*^9}, 3.7307171879122725`*^9, 3.7307174809133787`*^9, 
   3.730717573585148*^9, 3.730717673632306*^9, 3.730717920803425*^9, 
   3.7307193424282637`*^9, 3.7307195192364674`*^9, 3.7307196349750123`*^9, 
   3.7307196854233084`*^9, 3.7307197308562374`*^9, 3.7307215230936193`*^9, 
   3.730721613873463*^9, {3.7307217061765957`*^9, 3.7307217335647163`*^9}, 
   3.730721896373968*^9, 3.7307221748596168`*^9, 3.7318237998469*^9, {
   3.731824165097845*^9, 3.731824180242171*^9}, {3.7318242827723627`*^9, 
   3.7318243108871875`*^9}, 3.7318243750643797`*^9, 3.7340803591937423`*^9, 
   3.734080487984198*^9, 3.7340828411874323`*^9, 3.7340828712541046`*^9, 
   3.7340829516037035`*^9, 3.7341049617073183`*^9, 3.7341051077818832`*^9, 
   3.738396247981799*^9, 3.738396452140438*^9, 3.739004675517969*^9, 
   3.739813272462982*^9, {3.7398147629324417`*^9, 3.739814775556895*^9}, 
   3.7398150662786026`*^9, 3.739815188382659*^9, 3.739815219318812*^9, 
   3.7398157096196003`*^9, 3.739816513568654*^9, 3.7398186858914576`*^9, {
   3.7398512097403307`*^9, 3.739851235631226*^9}, 3.740680333053055*^9, 
   3.740680446291478*^9, 3.740684480391901*^9, 3.7406845195152454`*^9, {
   3.7406845768150444`*^9, 3.7406846588937626`*^9}, 3.740684722419344*^9, 
   3.7406850339186616`*^9, 3.740729851569422*^9},
 CellTags->"fittingroutineHD2IDA"]
}, Open  ]]
},
InitializationCellEvaluation->True,
InitializationCellWarning->False,
WindowSize->{1680, 967},
WindowMargins->{{Automatic, 1358}, {Automatic, -8}},
CellContext->Notebook,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "launchcell"->{
  Cell[3716, 102, 27299, 607, 3722, "Input",
   InitializationCell->True,
   CellTags->"launchcell"],
  Cell[31040, 713, 8609, 198, 49, "Print",
   CellTags->"launchcell"],
  Cell[39652, 913, 3855, 85, 75, "Print",
   CellTags->"launchcell"],
  Cell[43522, 1001, 4928, 126, 218, "Output",
   CellTags->"launchcell"]},
 "initialroutineHD2IDA"->{
  Cell[48487, 1132, 6072, 123, 578, "Input",
   CellTags->"initialroutineHD2IDA"],
  Cell[54562, 1257, 7596, 131, 398, "Print",
   CellTags->"initialroutineHD2IDA"]},
 "fittingroutineHD2IDA"->{
  Cell[62195, 1393, 27498, 703, 4880, "Input",
   CellTags->"fittingroutineHD2IDA"],
  Cell[89696, 2098, 11896, 273, 746, "Print",
   CellTags->"fittingroutineHD2IDA"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"launchcell", 102003, 2387},
 {"initialroutineHD2IDA", 102348, 2397},
 {"fittingroutineHD2IDA", 102542, 2402}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1846, 42, 19, "Input",
 CellOpen->False],
Cell[2429, 66, 1250, 31, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3716, 102, 27299, 607, 3722, "Input",
 InitializationCell->True,
 CellTags->"launchcell"],
Cell[CellGroupData[{
Cell[31040, 713, 8609, 198, 49, "Print",
 CellTags->"launchcell"],
Cell[39652, 913, 3855, 85, 75, "Print",
 CellTags->"launchcell"]
}, Open  ]],
Cell[43522, 1001, 4928, 126, 218, "Output",
 CellTags->"launchcell"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48487, 1132, 6072, 123, 578, "Input",
 CellTags->"initialroutineHD2IDA"],
Cell[54562, 1257, 7596, 131, 398, "Print",
 CellTags->"initialroutineHD2IDA"]
}, Open  ]],
Cell[CellGroupData[{
Cell[62195, 1393, 27498, 703, 4880, "Input",
 CellTags->"fittingroutineHD2IDA"],
Cell[89696, 2098, 11896, 273, 746, "Print",
 CellTags->"fittingroutineHD2IDA"]
}, Open  ]]
}
]
*)

