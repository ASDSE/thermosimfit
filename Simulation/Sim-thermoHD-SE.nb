(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     67333,       1633]
NotebookOptionsPosition[     65368,       1560]
NotebookOutlinePosition[     66375,       1598]
CellTagsIndexPosition[     66266,       1592]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Pane", "[", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Simulation of HG with salt effects thermodynamics\>\"", ",", 
          "\"\<Chapter\>\""}], "]"}], "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"MouseAppearance", "[", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Launch Application\>\"", ",", "\"\<Section\>\""}], 
             "]"}], ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"nb", "=", 
               RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
              RowBox[{"NotebookFind", "[", 
               RowBox[{
               "nb", ",", "\"\<launchcell\>\"", ",", "All", ",", "CellTags"}],
                "]"}], ",", 
              RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
          "\"\<LinkHand\>\""}], "]"}], "}"}]}], "\n", "\n", "}"}], ",", " ", 
     RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
     RowBox[{"ItemSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"BaselinePosition", "\[Rule]", "Baseline"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.731821909992667*^9, 3.7318220266332903`*^9}, {
   3.7318220650102763`*^9, 3.7318221618988886`*^9}, {3.731822297374745*^9, 
   3.7318223480196705`*^9}, {3.731822393559778*^9, 3.7318224108738403`*^9}, {
   3.731823391470278*^9, 3.7318234673463974`*^9}, {3.7318569879999685`*^9, 
   3.73185698993756*^9}, 3.734079643614863*^9, {3.734080557424387*^9, 
   3.7340805579550896`*^9}, 3.7341052776460085`*^9}],

Cell[BoxData[
 PaneBox[
  TagBox[GridBox[{
     {
      StyleBox["\<\"Simulation of HG with salt effects thermodynamics\"\>", 
       "Chapter",
       StripOnInput->False]},
     {
      TagBox[
       ButtonBox[
        StyleBox["\<\"Launch Application\"\>", "Section",
         StripOnInput->False],
        Appearance->None,
        ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
          NotebookFind[$CellContext`nb, "launchcell", All, CellTags], 
          SelectionEvaluate[$CellContext`nb]},
        Evaluator->Automatic,
        Method->"Preemptive"],
       MouseAppearanceTag["LinkHand"]]}
    },
    AutoDelete->False,
    BaselinePosition->Baseline,
    GridBoxAlignment->{"Columns" -> {{Center}}},
    GridBoxItemSize->{"Columns" -> {{Large}}, "Rows" -> {{Large}}}],
   "Grid"],
  Alignment->Center,
  ImageSize->Full]], "Output",
 CellChangeTimes->{{3.7318219954368877`*^9, 3.7318220271538706`*^9}, {
   3.7318220680542727`*^9, 3.731822162920437*^9}, {3.731822307220541*^9, 
   3.7318223482870207`*^9}, {3.731822399987263*^9, 3.7318224115871*^9}, {
   3.7318233967524242`*^9, 3.731823474535568*^9}, {3.7318235311854105`*^9, 
   3.7318235418192897`*^9}, 3.7318235799529233`*^9, 3.7318570141416454`*^9, 
   3.734079645036843*^9, 3.7340811467047234`*^9, 3.7341052851957264`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Notebook", " ", "settings"}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
      RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", 
      RowBox[{"\"\<DynamicUpdating\>\"", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", 
      RowBox[{"\"\<DynamicEvaluationTimeout\>\"", "\[Rule]", "30"}]}], "]"}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"set", " ", "values"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"h0fixed", "=", "1"}], ";", " ", 
    RowBox[{"d0fixed", "=", "1"}], ";", 
    RowBox[{"kequhdfixed", "=", "2"}], ";", 
    RowBox[{"kequhgafixed", "=", "2"}], ";", 
    RowBox[{"sighdfixed", "=", "1"}], ";", 
    RowBox[{"sigdfixed", "=", "1"}], ";", 
    RowBox[{"sig0fixed", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"h0error", "=", "0"}], ";", " ", 
    RowBox[{"d0error", "=", "0"}], ";", 
    RowBox[{"kequhderror", "=", "0"}], ";", 
    RowBox[{"kequhgaerror", "=", "0"}], ";", 
    RowBox[{"sighderror", "=", "0"}], ";", 
    RowBox[{"sigderror", "=", "0"}], ";", 
    RowBox[{"sig0error", "=", "0"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Load", " ", "Packges"}], "*)"}], "\t", "\n", "\t", "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<thermoHD-SE1.m\>\""}], "}"}], "]"}], 
       "}"}], "]"}], "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<thermoHD.m\>\""}], "}"}], "]"}], 
       "}"}], "]"}], "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<datagen.m\>\""}], "}"}], "]"}], "}"}],
       "]"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", " ", "Paths", "*)"}], "\n", 
   RowBox[{
    RowBox[{"tempPath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<temp-thermoHGSE1.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"defaultPath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<default-thermoHGSE1.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"initialparameters", "=", 
     RowBox[{"Import", "[", "defaultPath", "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"h0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"d0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"step", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"kequhdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sig0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sigdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sighdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "7", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sa0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "8", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"kequhsain", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", "Buttons", "\n", "*)"}], 
   RowBox[{
    RowBox[{"simulationbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Simulate\>\"", ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"nb", "=", 
            RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
           RowBox[{"NotebookFind", "[", 
            RowBox[{
            "nb", ",", "\"\<simroutineHDSE1\>\"", ",", "All", ",", 
             "CellTags"}], "]"}], ",", 
           RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"EdgeForm", "[", "Dotted", "]"}]}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"variablessavebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Save Parameters\>\"", ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"{", "\n", 
             RowBox[{
             "h0in", ",", "\n", "d0in", ",", "\n", "step", ",", "\n", 
              "kequhdin", ",", "\n", "sig0in", ",", "\n", "sigdin", ",", "\n",
               "sighdin", ",", "\n", "sa0in", ",", "\n", "kequhsain"}], "\n", 
             "}"}]}], ",", 
           RowBox[{"Export", "[", 
            RowBox[{"tempPath", ",", "initialparameters"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"Appearance", "->", "\"\<DialogBox\>\""}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"variablesloadbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Load Saved Parameters\>\"", ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"Import", "[", "tempPath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"step", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sa0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhsain", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "9", "]"}], "]"}]}]}], "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<DialogBox\>\""}]}], "]"}], 
       ",", "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"defaultloadbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Load Default Parameters\>\"", ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"Import", "[", "defaultPath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"step", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sa0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhsain", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "9", "]"}], "]"}]}]}], "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<DialogBox\>\""}]}], "]"}], 
       ",", "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"inputline", " ", "=", " ", 
     RowBox[{"{", "\n", "   ", 
      RowBox[{
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<species\>\"", ",", " ", "Bold", ",", "Underlined", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "12"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<concentration\>\"", ",", " ", "Bold", ",", "Underlined", ",", 
           " ", 
           RowBox[{"FontSize", "\[Rule]", "12"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<binding\>\"", ",", " ", "Bold", ",", "Underlined", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "12"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}]}], "}"}], 
       ",", "\n", "\n", "   ", 
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Host:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "h0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", "\n", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<c-step \>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "step", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\""}], "}"}], ",", "\n", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"h0in", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<c-step\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<\>\""}], "}"}], ",", "\n", " ", "\n", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Dye:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "   ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "d0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD)\>\"", " ", ",", " ", 
           "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "kequhdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\>\""}], "\n", 
        "}"}], ",", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"d0in", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"Log10", "[", "kequhdin", "]"}], "]"}], ",", "\"\<\>\""}], 
        "}"}], ",", "\n", " ", "\n", " ", "\n", " ", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Salt A:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "      ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sa0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(K\), \
\(equ\)]\)(\!\(\*SubscriptBox[\(HS\), \(A\)]\))\>\"", " ", ",", " ", "Bold", 
           ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", "\n", 
         "      ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "kequhsain", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\>\""}], "\n", 
        "}"}], ",", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"sa0in", "*", "1000"}], "]"}], ",", "\"\<mM\>\"", ",", 
         "\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"Log10", "[", "kequhsain", "]"}], "]"}], ",", "\"\<\>\""}], 
        "}"}], ",", "\n", "   ", "\n", "   ", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-HD\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sighdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-D\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sigdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-0\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sig0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}]}], "}"}], ",", 
       "\n", "      ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<HD complex\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<dye alone\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<Startsignal\>\""}], "}"}]}], "  ", "\n", "    ", "\n", "}"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"TableForm", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "simulationbutton", ",", "variablesloadbutton", ",", 
         "variablessavebutton", ",", "defaultloadbutton"}], "}"}], "}"}], 
      "]"}], "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"TableForm", "[", 
      RowBox[{"inputline", ",", " ", 
       RowBox[{"TableAlignments", " ", "->", " ", "Left"}]}], "]"}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<IDA - \>\"", ",", "Bold"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<Indicator Displacement Assay \>\"", ",", "Italic", ",", "Bold", 
        ",", 
        RowBox[{"FontColor", "\[Rule]", "Gray"}]}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<ADA - \>\"", ",", "Bold"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<Analyte Displacement Assay \>\"", ",", "Italic", ",", "Bold", ",", 
        RowBox[{"FontColor", "\[Rule]", "Gray"}]}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{"\"\<SAIBA - \>\"", ",", "Bold"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<Simultaneous Analyte and Indicator Binding Assay \>\"", ",", 
        "Italic", ",", "Bold", ",", 
        RowBox[{"FontColor", "\[Rule]", "Gray"}]}], "]"}]}], "]"}], ";"}], 
   "\n"}]}]], "Input",
 CellOpen->False,
 InitializationCell->True,
 CellChangeTimes->{{3.730400773395277*^9, 3.7304008352393255`*^9}, {
   3.730401492629541*^9, 3.73040150347148*^9}, {3.730402649565604*^9, 
   3.7304028230281205`*^9}, {3.7304029904431067`*^9, 3.730403080271673*^9}, {
   3.7304031109589834`*^9, 3.7304033952843356`*^9}, {3.730403434815216*^9, 
   3.7304034707397184`*^9}, {3.730403572769393*^9, 3.7304036711451073`*^9}, {
   3.7304037173322906`*^9, 3.7304038263140087`*^9}, {3.7304038664846106`*^9, 
   3.730403892708701*^9}, 3.7304039373324056`*^9, {3.730635884169504*^9, 
   3.730635890234384*^9}, {3.730635977259904*^9, 3.730636125234563*^9}, 
   3.7306361562502937`*^9, {3.730636486363246*^9, 3.730636507704445*^9}, 
   3.730699333959115*^9, 3.730699414337867*^9, {3.7306994572750845`*^9, 
   3.730699471266698*^9}, {3.73070096568909*^9, 3.730700983626526*^9}, 
   3.730701842378021*^9, 3.7307103357721977`*^9, {3.730711599505864*^9, 
   3.7307116052989116`*^9}, {3.7307118430217047`*^9, 
   3.7307118531154985`*^9}, {3.7307118888187237`*^9, 
   3.7307120428818164`*^9}, {3.7307120899121513`*^9, 3.730712091974739*^9}, {
   3.730712158991912*^9, 3.730712301897294*^9}, {3.7307123369917274`*^9, 
   3.7307123615377364`*^9}, {3.730712434386697*^9, 3.73071243545944*^9}, {
   3.730712555569868*^9, 3.730712569491119*^9}, {3.7307126443741517`*^9, 
   3.730712700401746*^9}, {3.7307128842864532`*^9, 3.730712899880815*^9}, 
   3.730713117631132*^9, {3.730714832037506*^9, 3.7307150229472327`*^9}, 
   3.730715152250645*^9, {3.730720928334868*^9, 3.7307209894055443`*^9}, {
   3.7307210437260246`*^9, 3.7307211347099714`*^9}, {3.730721166538047*^9, 
   3.7307211682081127`*^9}, {3.730721268272152*^9, 3.7307212991326036`*^9}, {
   3.73113671379996*^9, 3.731136795673627*^9}, {3.7340796606207995`*^9, 
   3.7340797082038565`*^9}, 3.734079767025264*^9, 3.7340801047041655`*^9, {
   3.7340801901873493`*^9, 3.7340801916538916`*^9}, {3.734080325128217*^9, 
   3.7340803266897755`*^9}, {3.734081166258032*^9, 3.734081192197974*^9}, {
   3.734081311746915*^9, 3.7340813847541847`*^9}, {3.73408151756456*^9, 
   3.73408152411252*^9}, {3.7340820767872324`*^9, 3.7340820775205812`*^9}, 
   3.734082177634734*^9, {3.734082231951256*^9, 3.7340822434321938`*^9}, {
   3.734082281546068*^9, 3.734082454750534*^9}, {3.7340826596192636`*^9, 
   3.7340826634297247`*^9}, 3.7340829264392724`*^9, 3.7341044556968613`*^9, {
   3.73410533706739*^9, 3.7341053684306765`*^9}, 3.734105416006796*^9, {
   3.734199465525429*^9, 3.7341994688542347`*^9}, {3.734199528261059*^9, 
   3.734199529583623*^9}},
 CellTags->"launchcell"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      ButtonBox["\<\"Simulate\"\>",
       Appearance->Automatic,
       BaseStyle->EdgeForm[
         Dashing[{0, Small}]],
       ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
         NotebookFind[$CellContext`nb, "simroutineHDSE1", All, CellTags], 
         SelectionEvaluate[$CellContext`nb]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox["\<\"Load Saved Parameters\"\>",
       Appearance->"DialogBox",
       ButtonFunction:>{$CellContext`initialparameters = 
         Import[$CellContext`tempPath], $CellContext`h0in = 
         Part[$CellContext`initialparameters, 1], $CellContext`d0in = 
         Part[$CellContext`initialparameters, 2], $CellContext`step = 
         Part[$CellContext`initialparameters, 3], $CellContext`kequhdin = 
         Part[$CellContext`initialparameters, 4], $CellContext`sig0in = 
         Part[$CellContext`initialparameters, 5], $CellContext`sigdin = 
         Part[$CellContext`initialparameters, 6], $CellContext`sighdin = 
         Part[$CellContext`initialparameters, 7], $CellContext`sa0in = 
         Part[$CellContext`initialparameters, 8], $CellContext`kequhsain = 
         Part[$CellContext`initialparameters, 9]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox["\<\"Save Parameters\"\>",
       Appearance->"DialogBox",
       ButtonFunction:>{$CellContext`initialparameters = {$CellContext`h0in, \
$CellContext`d0in, $CellContext`step, $CellContext`kequhdin, \
$CellContext`sig0in, $CellContext`sigdin, $CellContext`sighdin, \
$CellContext`sa0in, $CellContext`kequhsain}, 
         Export[$CellContext`tempPath, $CellContext`initialparameters]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox["\<\"Load Default Parameters\"\>",
       Appearance->"DialogBox",
       ButtonFunction:>{$CellContext`initialparameters = 
         Import[$CellContext`defaultPath], $CellContext`h0in = 
         Part[$CellContext`initialparameters, 1], $CellContext`d0in = 
         Part[$CellContext`initialparameters, 2], $CellContext`step = 
         Part[$CellContext`initialparameters, 3], $CellContext`kequhdin = 
         Part[$CellContext`initialparameters, 4], $CellContext`sig0in = 
         Part[$CellContext`initialparameters, 5], $CellContext`sigdin = 
         Part[$CellContext`initialparameters, 6], $CellContext`sighdin = 
         Part[$CellContext`initialparameters, 7], $CellContext`sa0in = 
         Part[$CellContext`initialparameters, 8], $CellContext`kequhsain = 
         Part[$CellContext`initialparameters, 9]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.7340823065368586`*^9, 3.7340824571866665`*^9, 3.7340826938321714`*^9, 
   3.7340829331042747`*^9, 3.7341044677183294`*^9, 3.734104638161203*^9, {
   3.7341048625016203`*^9, 3.734104864064183*^9}, 3.734105419344998*^9, {
   3.734199417480409*^9, 3.734199424590516*^9}, 3.734199540373798*^9, 
   3.7342007950980234`*^9},
 CellTags->"launchcell"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     StyleBox["\<\"species\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->12,
      FontWeight->Bold,
      FontVariations->{"Underline"->True}], 
     StyleBox["\<\"concentration\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->12,
      FontWeight->Bold,
      FontVariations->{"Underline"->True}], "\<\"\"\>", 
     StyleBox["\<\"binding\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->12,
      FontWeight->Bold,
      FontVariations->{
      "Underline"->True}], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Host:\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`h0in],
      FieldSize->6], "\<\"M\"\>", 
     StyleBox["\<\"c-step \"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`step],
      FieldSize->6], "\<\"M\"\>", "\<\"\"\>", "\<\"\"\>"},
    {"\<\"\"\>", 
     DynamicBox[ToBoxes[$CellContext`h0in 1000000, StandardForm],
      ImageSizeCache->{
       14., {0., 
        8.}}], "\<\"\[Mu]M\"\>", "\<\"c-step\"\>", "\<\"\"\>", "\<\"\"\>", \
"\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Dye:\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`d0in],
      FieldSize->6], "\<\"M\"\>", 
     StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(equ\\)]\\)(HD)\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`kequhdin],
      FieldSize->
       6], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>", \
"\<\"\"\>", "\<\"\"\>"},
    {"\<\"\"\>", 
     DynamicBox[ToBoxes[$CellContext`d0in 1000000, StandardForm],
      ImageSizeCache->{
       28., {0., 
        8.}}], "\<\"\[Mu]M\"\>", "\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\))\"\>", 
     DynamicBox[ToBoxes[
       Log10[$CellContext`kequhdin], StandardForm],
      ImageSizeCache->{42., {0., 8.}}], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Salt A:\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sa0in],
      FieldSize->6], "\<\"M\"\>", 
     StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\)(\\!\\(\\*SubscriptBox[\\(HS\\), \\(A\\)]\\))\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`kequhsain],
      FieldSize->
       6], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>", \
"\<\"\"\>", "\<\"\"\>"},
    {"\<\"\"\>", 
     DynamicBox[ToBoxes[$CellContext`sa0in 1000, StandardForm],
      ImageSizeCache->{
       49., {0., 
        8.}}], "\<\"mM\"\>", "\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\))\"\>", 
     DynamicBox[ToBoxes[
       Log10[$CellContext`kequhsain], StandardForm],
      ImageSizeCache->{49., {0., 8.}}], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Signal-HD\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sighdin],
      FieldSize->6], "\<\"\"\>", 
     StyleBox["\<\"Signal-D\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sigdin],
      FieldSize->6], "\<\"\"\>", 
     StyleBox["\<\"Signal-0\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sig0in],
      FieldSize->6]},
    {"\<\"HD complex\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"dye alone\"\>", "\<\"\
\"\>", "\<\"\"\>", "\<\"Startsignal\"\>", "\<\"\"\>"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  TableForm[{{
     Style[
     "species", Bold, Underlined, FontSize -> 12, TextAlignment -> Right], 
     Style[
     "concentration", Bold, Underlined, FontSize -> 12, TextAlignment -> 
      Right], "", 
     Style[
     "binding", Bold, Underlined, FontSize -> 12, TextAlignment -> Right]}, {
     Style["Host:", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`h0in], FieldSize -> 6], "M", 
     Style["c-step ", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`step], FieldSize -> 6], "M"}, {"", 
     Dynamic[$CellContext`h0in 1000000], "\[Mu]M", "c-step", "", "", ""}, {
     Style["Dye:", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`d0in], FieldSize -> 6], "M", 
     Style[
     "\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD)", Bold, FontSize -> 16, 
      TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`kequhdin], FieldSize -> 6], 
     "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)"}, {"", 
     Dynamic[$CellContext`d0in 1000000], "\[Mu]M", 
     "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))", 
     Dynamic[
      Log10[$CellContext`kequhdin]], ""}, {
     Style["Salt A:", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sa0in], FieldSize -> 6], "M", 
     Style[
     "\!\(\*SubscriptBox[\(K\), \(equ\)]\)(\!\(\*SubscriptBox[\(HS\), \
\(A\)]\))", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`kequhsain], FieldSize -> 6], 
     "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)"}, {"", 
     Dynamic[$CellContext`sa0in 1000], "mM", 
     "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))", 
     Dynamic[
      Log10[$CellContext`kequhsain]], ""}, {
     Style["Signal-HD", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sighdin], FieldSize -> 6], "", 
     Style["Signal-D", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sigdin], FieldSize -> 6], "", 
     Style["Signal-0", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sig0in], FieldSize -> 6]}, {
    "HD complex", "", "", "dye alone", "", "", "Startsignal"}}, 
   TableAlignments -> Left]]], "Print",
 CellChangeTimes->{
  3.7340823065368586`*^9, 3.7340824571866665`*^9, 3.7340826938321714`*^9, 
   3.7340829331042747`*^9, 3.7341044677183294`*^9, 3.734104638161203*^9, {
   3.7341048625016203`*^9, 3.734104864064183*^9}, 3.734105419344998*^9, {
   3.734199417480409*^9, 3.734199424590516*^9}, 3.734199540373798*^9, 
   3.7342007951190295`*^9},
 CellTags->"launchcell"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"IDA - \"\>",
    StripOnInput->False,
    FontWeight->Bold], "\[InvisibleSpace]", 
   StyleBox["\<\"Indicator Displacement Assay \"\>",
    StripOnInput->False,
    FontWeight->Bold,
    FontSlant->Italic,
    FontColor->GrayLevel[0.5]], "\[InvisibleSpace]", 
   StyleBox["\<\"ADA - \"\>",
    StripOnInput->False,
    FontWeight->Bold], "\[InvisibleSpace]", 
   StyleBox["\<\"Analyte Displacement Assay \"\>",
    StripOnInput->False,
    FontWeight->Bold,
    FontSlant->Italic,
    FontColor->GrayLevel[0.5]], "\[InvisibleSpace]", 
   StyleBox["\<\"SAIBA - \"\>",
    StripOnInput->False,
    FontWeight->Bold], "\[InvisibleSpace]", 
   StyleBox["\<\"Simultaneous Analyte and Indicator Binding Assay \"\>",
    StripOnInput->False,
    FontWeight->Bold,
    FontSlant->Italic,
    FontColor->GrayLevel[0.5]]}],
  SequenceForm[
   Style["IDA - ", Bold], 
   Style["Indicator Displacement Assay ", Italic, Bold, FontColor -> 
    GrayLevel[0.5]], 
   Style["ADA - ", Bold], 
   Style["Analyte Displacement Assay ", Italic, Bold, FontColor -> 
    GrayLevel[0.5]], 
   Style["SAIBA - ", Bold], 
   Style["Simultaneous Analyte and Indicator Binding Assay ", Italic, Bold, 
    FontColor -> GrayLevel[0.5]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7340823065368586`*^9, 3.7340824571866665`*^9, 3.7340826938321714`*^9, 
   3.7340829331042747`*^9, 3.7341044677183294`*^9, 3.734104638161203*^9, {
   3.7341048625016203`*^9, 3.734104864064183*^9}, 3.734105419344998*^9, {
   3.734199417480409*^9, 3.734199424590516*^9}, 3.734199540373798*^9, 
   3.734200795124032*^9},
 CellTags->"launchcell"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Export", "::", "chtype"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"First", "::", "nofirst"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mode", "=", "\"\<H0 varied\>\""}], ";"}], "\n", "\n", "\n", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"datasignal", "=", 
    RowBox[{"sthdse1SignalData", "[", 
     RowBox[{
     "kequhdin", ",", "kequhsain", ",", "h0in", ",", "d0in", ",", "sa0in", 
      ",", "sig0in", ",", "sighdin", ",", "sigdin", ",", "step"}], "]"}]}], 
   ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"inputs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\"\<Quantity\>\"", ",", "\"\<Value\>\""}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<Mode\>\"", ",", "mode"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<conc(H)\>\"", ",", "h0in"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<conc(D)\>\"", ",", "d0in"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<Kequ(HD)\>\"", ",", "kequhdin"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<conc(Sa)\>\"", ",", "sa0in"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<Kequ(HSa)\>\"", ",", "kequhsain"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<Keff(HD)\>\"", ",", "kequhdout"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<Signal-0\>\"", ",", "sig0in"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<Signal-HD\>\"", ",", "sighdin"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<Signal-Dye\>\"", ",", "sigdin"}], "}"}], ",", "\n", 
     RowBox[{"{", 
      RowBox[{"\"\<c-step\>\"", ",", "step"}], "}"}]}], "\n", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"header", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<conc\>\"", ",", "\"\<Signal\>\""}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"units", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<M\>\"", ",", "\"\<INT\>\""}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"column1", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"inputs", "[", 
     RowBox[{"[", 
      RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"column2", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"inputs", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"signaloutput", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"datasignal", ",", 
       RowBox[{"List", "/@", 
        RowBox[{"datathermohd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", 
        RowBox[{"datathermohdd", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", 
        RowBox[{"datathermohga", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", 
        RowBox[{"datathermod", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", 
        RowBox[{"datathermoga", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
       RowBox[{"List", "/@", 
        RowBox[{"datathermoh", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", "2"}], "]"}]}], 
    ";"}], "*)"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"signaloutput", "=", "datasignal"}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"put", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{"signaloutput", ",", "units"}], "]"}], ",", "header"}], "]"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"put", ",", 
      RowBox[{"List", "/@", "column1"}], ",", 
      RowBox[{"List", "/@", "column2"}], ",", "2"}], "]"}]}], ";"}], "\n", 
  "\n", "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{"Quiet", "[", 
   RowBox[{"exportbutton2", "=", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Save-Sim\>\"", ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<FileSave\>\"", ",", "\"\<.csv\>\""}], "]"}], ",", 
        "output"}], "]"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"simplot2", "=", 
   RowBox[{"Manipulate", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Show", "[", "\n", "\t\t", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a1", "*", "datasignal"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Signal\>\"", ",", "\"\<Fit\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]\>\"", ",", 
            "\"\<[D]\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(G\), \(A\)]\)]\>\"", ",", 
            "\"\<[H]\>\"", ",", "\"\<[HDD]\>\""}], "}"}]}]}], "]"}], ",", 
       "\n", "\t\t", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{"a2", "*", "fitteddata"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"PointSize", "[", "Medium", "]"}], ",", "Red", ",", " ", 
            "Dashed"}], "}"}]}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<Fit\>\"", ",", "\"\<Fit\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]\>\"", ",", 
            "\"\<[D]\>\"", ",", 
            "\"\<[\!\(\*SubscriptBox[\(G\), \(A\)]\)]\>\"", ",", 
            "\"\<[H]\>\"", ",", "\"\<[HDD]\>\""}], "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", " ", "Large"}]}], "]"}], ",", "\n", 
       "\t\t", 
       RowBox[{"ImageSize", "\[Rule]", " ", "Large"}], ",", 
       RowBox[{"AxesOrigin", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ",", 
       RowBox[{"PlotLabel", "\[Rule]", " ", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Simulated Data\>\"", ",", "\"\<Subsection\>\""}], 
         "]"}]}]}], "]"}], ",", "\n", "\t\t", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a1", ",", "1", ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal\>\"", ",", "Blue"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a2", ",", "1", ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Fit\>\"", ",", "Red"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"effectiveKd", "[", 
     RowBox[{
     "fkd_", ",", "fh0_", ",", "fd0_", ",", "fsig0_", ",", "fsighd_", ",", 
      "fsigd_", ",", "fdata_", ",", "fstep_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "sol", ",", "e", ",", "brac", ",", "fit", ",", "kequhd", ",", "h0", 
        ",", "bestfit"}], "}"}], ",", "\n", "\t", 
      RowBox[{
       RowBox[{"Clear", "[", "kequhd", "]"}], ";", "\n", "\t", 
       RowBox[{"Clear", "[", "h0", "]"}], ";", "\n", "\t", 
       RowBox[{"fit", "=", 
        RowBox[{"NonlinearModelFit", "[", 
         RowBox[{"fdata", ",", 
          RowBox[{"sthdSignal", "[", 
           RowBox[{
           "kequhd", ",", "h0", ",", "fd0", ",", "fsig0", ",", "fsighd", ",", 
            "fsigd"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"kequhd", ",", "fkd"}], "}"}], "}"}], ",", "h0"}], 
         "]"}]}], ";", "\n", "\t", 
       RowBox[{"bestfit", "=", 
        RowBox[{"TableForm", "[", 
         RowBox[{"fit", "[", "\"\<ParameterTableEntries\>\"", "]"}], "]"}]}], 
       ";", "\n", "\t", 
       RowBox[{"Clear", "[", "kequhd", "]"}], ";", "\n", "\t", 
       RowBox[{"kequhdout", "=", 
        RowBox[{"kequhd", "/.", 
         RowBox[{"fit", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";", 
       "\n", "\t", "\n", "\t", 
       RowBox[{"sol", "=", 
        RowBox[{"sthdSignalData", "[", 
         RowBox[{
         "kequhdout", ",", "fh0", ",", "fd0", ",", "fsig0", ",", "fsighd", 
          ",", "fsigd", ",", "fstep"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"Return", "[", "sol", "]"}]}]}], "\n", "\t", "]"}]}], ";"}], 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Quiet", "[", 
    RowBox[{"fitbutton2", "=", 
     RowBox[{"Button", "[", 
      RowBox[{"\"\<Effective Affinity Constant\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"fitteddata", "=", 
          RowBox[{"effectiveKd", "[", 
           RowBox[{
           "kequhdin", ",", "h0in", ",", "d0in", ",", "sig0in", ",", 
            "sighdin", ",", "sigdin", ",", "datasignal", ",", "step"}], 
           "]"}]}], ",", " ", 
         RowBox[{"nb", "=", 
          RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
         RowBox[{"NotebookFind", "[", 
          RowBox[{
          "nb", ",", "\"\<simroutineHDSE1\>\"", ",", "All", ",", "CellTags"}],
           "]"}], ",", 
         RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}]}], "]"}]}], 
    "]"}], ";"}], "\n", "\t"}], "\n", 
 RowBox[{"\t", 
  RowBox[{"Pane", "[", 
   RowBox[{
    RowBox[{"Grid", "[", 
     RowBox[{
      RowBox[{"{", "\n", 
       RowBox[{"{", 
        RowBox[{"simplot2", ",", 
         RowBox[{"Grid", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"TableForm", "[", "inputs", "]"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<You can save simulated data:\>\"", ",", "exportbutton2", 
              ",", "fitbutton2"}], "}"}]}], "}"}], "]"}]}], "}"}], "\n", "\n",
        "}"}], ",", " ", 
      RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
      RowBox[{"ItemSize", "\[Rule]", "Large"}], ",", 
      RowBox[{"BaselinePosition", "\[Rule]", "Baseline"}]}], "]"}], ",", 
    RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}], "\n", "\n", "\n", "\t",
   "\n", "\t\t\t", "\n"}], "\n"}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.7304018583395243`*^9, 3.730401859486709*^9}, {
   3.730403948733839*^9, 3.7304039492836747`*^9}, {3.7304040123581524`*^9, 
   3.730404041503718*^9}, {3.7304040765669107`*^9, 3.730404138677521*^9}, {
   3.730404171442689*^9, 3.7304043560974817`*^9}, {3.730404409651743*^9, 
   3.7304044720838237`*^9}, 3.730404511906062*^9, 3.73040491695927*^9, {
   3.7307008121399865`*^9, 3.7307009122001534`*^9}, {3.7307102183718214`*^9, 
   3.730710426152059*^9}, {3.730713239459134*^9, 3.7307133154109344`*^9}, {
   3.730713385630821*^9, 3.730713421491224*^9}, 3.7307134786002483`*^9, {
   3.730713514490865*^9, 3.7307135702518454`*^9}, 3.7307136039433756`*^9, {
   3.730713644849682*^9, 3.7307137128187957`*^9}, {3.730713745084343*^9, 
   3.730713831757533*^9}, {3.73071417346025*^9, 3.730714186068598*^9}, {
   3.7307143318652124`*^9, 3.7307143367263746`*^9}, 3.730714370881699*^9, {
   3.7307144326013565`*^9, 3.730714433926385*^9}, {3.7307145884907675`*^9, 
   3.730714744119078*^9}, {3.730714778976367*^9, 3.730714782678993*^9}, {
   3.730715052146652*^9, 3.7307151180191894`*^9}, {3.730720143070423*^9, 
   3.730720164416132*^9}, {3.7307202178654203`*^9, 3.730720299521387*^9}, {
   3.7307206088187847`*^9, 3.7307207932211065`*^9}, {3.730720828765464*^9, 
   3.730720837797329*^9}, 3.7307213331110654`*^9, {3.7307219319247293`*^9, 
   3.730721979678924*^9}, {3.7307220639210467`*^9, 3.7307220959241977`*^9}, {
   3.7311368629808145`*^9, 3.731136876763731*^9}, {3.731136938792105*^9, 
   3.731137047225228*^9}, {3.731137278011622*^9, 3.7311374958215675`*^9}, 
   3.731143563944759*^9, {3.731143598520023*^9, 3.731143600068371*^9}, {
   3.7340800034720087`*^9, 3.7340800060202026`*^9}, {3.7340800606877575`*^9, 
   3.7340800947312436`*^9}, {3.73408016983522*^9, 3.734080179025074*^9}, {
   3.7340815435275373`*^9, 3.73408155374137*^9}, {3.734081584932107*^9, 
   3.7340816111061277`*^9}, 3.734082638909396*^9, 3.7340827790190735`*^9, {
   3.734104495782821*^9, 3.7341044962149763`*^9}, 3.7341045400157366`*^9, {
   3.7341054643336077`*^9, 3.734105465818039*^9}, {3.7341055047727776`*^9, 
   3.7341055718756657`*^9}, {3.7341057663993673`*^9, 
   3.7341057685557075`*^9}, {3.734105857543768*^9, 3.7341058848886533`*^9}, {
   3.734105941062867*^9, 3.7341059439848576`*^9}, {3.7341060655836525`*^9, 
   3.7341061300082026`*^9}, {3.7341062008470373`*^9, 
   3.7341062285200605`*^9}, {3.734106278865904*^9, 3.734106300663683*^9}, {
   3.7341063426029253`*^9, 3.7341064199811316`*^9}, {3.7341064674987297`*^9, 
   3.734106724650034*^9}, {3.7341068163152018`*^9, 3.734106828143816*^9}, {
   3.734106883271104*^9, 3.7341069280542083`*^9}, {3.7341069979633636`*^9, 
   3.7341070024791803`*^9}, {3.734107284022108*^9, 3.7341072841939926`*^9}, {
   3.734107487006013*^9, 3.734107496756424*^9}, {3.7342003614495087`*^9, 
   3.7342003626889577`*^9}, 3.734200435804174*^9, {3.734200553170268*^9, 
   3.734200604283593*^9}, {3.7342007573344803`*^9, 3.734200768952648*^9}},
 NumberMarks->False,
 CellTags->"simroutineHDSE1"],

Cell[BoxData[
 PaneBox[
  TagBox[GridBox[{
     {
      TagBox[
       StyleBox[
        DynamicModuleBox[{$CellContext`a1$$ = 1, $CellContext`a2$$ = 1, 
         Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
         Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, 
         Typeset`animvar$$ = 1, Typeset`name$$ = "\"untitled\"", 
         Typeset`specs$$ = {{{
            Hold[$CellContext`a1$$], 1, 
            Style["Signal", 
             RGBColor[0, 0, 1]]}, {1, 0}}, {{
            Hold[$CellContext`a2$$], 1, 
            Style["Fit", 
             RGBColor[1, 0, 0]]}, {1, 0}}}, Typeset`size$$ = {
         658., {183., 189.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
         Typeset`skipInitDone$$ = True, $CellContext`a1$168206$$ = 
         False, $CellContext`a2$168207$$ = False}, 
         DynamicBox[Manipulate`ManipulateBoxes[
          1, StandardForm, 
           "Variables" :> {$CellContext`a1$$ = 1, $CellContext`a2$$ = 1}, 
           "ControllerVariables" :> {
             Hold[$CellContext`a1$$, $CellContext`a1$168206$$, False], 
             Hold[$CellContext`a2$$, $CellContext`a2$168207$$, False]}, 
           "OtherVariables" :> {
            Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
             Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
             Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
             Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Show[
             
             ListLinePlot[{$CellContext`a1$$ $CellContext`datasignal}, 
              PlotRange -> All, 
              PlotLegends -> {
               "Signal", "Fit", "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
                "[D]", "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]", 
                "[HDD]"}], 
             
             ListLinePlot[$CellContext`a2$$ $CellContext`fitteddata, 
              PlotStyle -> {
                PointSize[Medium], Red, Dashed}, 
              PlotLegends -> {
               "Fit", "Fit", "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", "[D]", 
                "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]", "[HDD]"}, 
              PlotRange -> Full, ImageSize -> Large], ImageSize -> Large, 
             AxesOrigin -> {0, 0}, PlotLabel -> 
             Style["Simulated Data", "Subsection"]], 
           "Specifications" :> {{{$CellContext`a1$$, 1, 
               Style["Signal", 
                RGBColor[0, 0, 1]]}, {1, 0}}, {{$CellContext`a2$$, 1, 
               Style["Fit", 
                RGBColor[1, 0, 0]]}, {1, 0}}}, 
           "Options" :> {ControlPlacement -> Right}, "DefaultOptions" :> {}],
          ImageSizeCache->{764., {215., 221.}},
          SingleEvaluation->True],
         Deinitialization:>None,
         DynamicModuleValues:>{},
         SynchronousInitialization->True,
         UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
         UnsavedVariables:>{Typeset`initDone$$},
         UntrackedVariables:>{Typeset`size$$}], "Manipulate",
        Deployed->True,
        StripOnInput->False],
       Manipulate`InterpretManipulate[1]], 
      TagBox[GridBox[{
         {
          TagBox[GridBox[{
             {"\<\"Quantity\"\>", "\<\"Value\"\>"},
             {"\<\"Mode\"\>", "\<\"H0 varied\"\>"},
             {"\<\"conc(H)\"\>", "8.`*^-6"},
             {"\<\"conc(D)\"\>", "4.08`*^-6"},
             {"\<\"Kequ(HD)\"\>", "4.9`*^6"},
             {"\<\"conc(Sa)\"\>", "0.0010000661`"},
             {"\<\"Kequ(HSa)\"\>", "150.`"},
             {"\<\"Keff(HD)\"\>", "4.260940641165946`*^6"},
             {"\<\"Signal-0\"\>", "0"},
             {"\<\"Signal-HD\"\>", "1"},
             {"\<\"Signal-Dye\"\>", "0"},
             {"\<\"c-step\"\>", "4.9`*^-8"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[2.0999999999999996`]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}],
           Function[BoxForm`e$, 
            TableForm[BoxForm`e$]]], "", ""},
         {"\<\"You can save simulated data:\"\>", 
          ButtonBox["\<\"Save-Sim\"\>",
           Appearance->Automatic,
           ButtonFunction:>Export[
             SystemDialogInput["FileSave", ".csv"], $CellContext`output],
           Evaluator->Automatic,
           Method->"Queued"], 
          ButtonBox["\<\"Effective Affinity Constant\"\>",
           Appearance->Automatic,
           
           ButtonFunction:>{$CellContext`fitteddata = \
$CellContext`effectiveKd[$CellContext`kequhdin, $CellContext`h0in, \
$CellContext`d0in, $CellContext`sig0in, $CellContext`sighdin, \
$CellContext`sigdin, $CellContext`datasignal, $CellContext`step], \
$CellContext`nb = EvaluationNotebook[], 
             NotebookFind[$CellContext`nb, "simroutineHDSE1", All, CellTags], 
             SelectionEvaluate[$CellContext`nb]},
           Evaluator->Automatic,
           Method->"Preemptive"]}
        },
        AutoDelete->False,
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
       "Grid"]}
    },
    AutoDelete->False,
    BaselinePosition->Baseline,
    GridBoxAlignment->{"Columns" -> {{Center}}},
    GridBoxItemSize->{"Columns" -> {{Large}}, "Rows" -> {{Large}}}],
   "Grid"],
  Alignment->Center,
  ImageSize->Full]], "Output",
 CellChangeTimes->{{3.7342006067294693`*^9, 3.734200677645901*^9}, {
   3.734200817972224*^9, 3.7342008482220726`*^9}, {3.73420090443323*^9, 
   3.734200920546009*^9}, 3.7342009532877502`*^9},
 CellTags->"simroutineHDSE1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonlinearModelFit", "[", 
   RowBox[{"datasignal", ",", 
    RowBox[{"sthdSignal", "[", 
     RowBox[{
     "kequhd", ",", "h0", ",", "d0in", ",", "sig0in", ",", "sighdin", ",", 
      "sigdin"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"kequhd", ",", "kequhdin"}], "}"}], "}"}], ",", "h0"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7341069529458704`*^9, 3.734106966868326*^9}, {
  3.734107026214532*^9, 3.7341070831856475`*^9}, {3.734107233910657*^9, 
  3.73410727800624*^9}}],

Cell[CellGroupData[{

Cell[BoxData["%311"], "Input",
 NumberMarks->False],

Cell[BoxData[
 TagBox[
  RowBox[{"FittedModel", "[", 
   TagBox[
    PanelBox[
     TagBox[
      RowBox[{"sthdSignal", "[", 
       RowBox[{
       "4.894074306856776`*^6", ",", "h0", ",", "4.08`*^-6", ",", "0", ",", 
        "1", ",", "0"}], "]"}],
      Short[#, 2]& ],
     FrameMargins->5],
    Editable -> False], "]"}],
  InterpretTemplate[
  FittedModel[{
    "Nonlinear", {$CellContext`kequhd -> 
      4.894074306856776*^6}, {{$CellContext`h0}, 
      thermoHD`sthdSignal[$CellContext`kequhd, $CellContext`h0, 4.08*^-6, 0, 
       1, 0]}}, {1}, CompressedData["
1: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
    "], 
    Function[Null, 
     Internal`LocalizedBlock[{$CellContext`h0, $CellContext`kequhd}, #], {
     HoldAll}]]& ],
  Editable->False,
  SelectWithContents->True,
  Selectable->True]], "Output",
 CellChangeTimes->{3.734107299897766*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fitteddata", "=", 
    RowBox[{"effectiveKd", "[", 
     RowBox[{
     "kequhdin", ",", "h0in", ",", "d0in", ",", "sig0in", ",", "sighdin", ",",
       "sigdin", ",", "datasignal", ",", "step"}], "]"}]}], ";"}], 
  "\n"}]], "Input",
 CellChangeTimes->{{3.734107085420123*^9, 3.7341070859357605`*^9}, {
  3.734107342171878*^9, 3.734107375767027*^9}, {3.7342004461748943`*^9, 
  3.7342004480395613`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NonlinearModelFit", "[", 
   RowBox[{"datasignal", ",", 
    RowBox[{"sthdse1Signal", "[", 
     RowBox[{
     "kequhd", ",", "kequhsain", ",", "h0", ",", "d0in", ",", "sa0in", ",", 
      "sig0in", ",", "sighdin", ",", "sigdin"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"kequhd", ",", 
       RowBox[{"kequhdin", "*", "0.99"}]}], "}"}], "}"}], ",", "h0"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7341071830179157`*^9, 3.7341071869243307`*^9}, {
  3.7342001178731585`*^9, 3.7342001517853203`*^9}, {3.7342002252976823`*^9, 
  3.73420022668318*^9}}],

Cell[CellGroupData[{

Cell[BoxData["%107"], "Input",
 NumberMarks->False],

Cell[BoxData[
 TagBox[
  RowBox[{"FittedModel", "[", 
   TagBox[
    PanelBox[
     TagBox[
      RowBox[{"sthdse1Signal", "[", 
       RowBox[{
       "4.89999999986228`*^6", ",", "4.9`*^7", ",", "h0", ",", "4.08`*^-6", 
        ",", "8.0661`*^-6", ",", "0", ",", "1", ",", "0"}], "]"}],
      Short[#, 2]& ],
     FrameMargins->5],
    Editable -> False], "]"}],
  InterpretTemplate[
  FittedModel[{
    "Nonlinear", {$CellContext`kequhd -> 
      4.89999999986228*^6}, {{$CellContext`h0}, 
      thermoHDSE1`sthdse1Signal[$CellContext`kequhd, 4.9*^7, $CellContext`h0, 
       4.08*^-6, 8.0661*^-6, 0, 1, 0]}}, {1}, CompressedData["
1:eJw1kgswFHgcx7e4QQxDQ+7E5Ka77kZJ2quu+K5E0YUhG9es82g5Ns6bJeex
m9ciy+4NbbFXSkJkk1XYvHcX1aYHca445E66rkN5pHNz//vP/Oc/v/n//7/H
9/sxDwj3CFxLoVCOru5/z//X2VwfU/PrOTZC9ql9HFcWnDLkhQbum/FfnIgx
DwXvNYuKcNH56tHbXAS/28EXyEHueaB6HJ4KFjuAYbEtUD+Sj9IEt30ZU87k
vQAa/GHqUZobOFo6s3XqRfCT9Riu8fAg/0UQLo1bntCmo/zFHxyP4hJYr9+4
9HuvF8n3M1rrkzSvC45jcmw8a8HwIoSh9n6qAB+SvwycrhsONzb64Z27p0rp
exkU2QVHeY4/qXcFW2dM2JKVAGi3dWwQXa3AYcddTG4sk9SvxKDQ5YnT60CY
Wu30Zf1dhQu6sc/1w78n/VwDVTk9PPNXMKzEF8v32tZCx0fEeslmkf6uI11R
zDZVD4W5hlZ8+oE6HGxrti0QhJF+JWCLrGjeW8JRKWsVhU1J0BadXdHmG0H6
vwFGml6fvmUkqHFsGT2vHgq3WsfLK5FknpvoPPRm8fSDKLRssxqztW6AT4TT
8q3yaDKfFPH4M90lOQYHJ1589PmAFMLdIxRn71gybyNUiRK1Bmoc7p8Xf6mb
dAts+5qjpevjyfy3cSLi6oT2XDy+9fRymd/UhOZdRs80n7KJHk049kq9SHwn
AWPaepG/djVD18KyaKgikejTgk/M1pZ0Ck/hZEe3sJslwzF6iyiYm0T0uoPm
CU7jg5gfkWhLYwxotMJRN4muHZJM9GuFp+97TXO/FNA+Nvnhm6FWPG8cdNfb
lkr0bEPCOaZxVlUq1ObmU+5Ut2HPXPFSqkUa0bcdLfRgW8q1NChU/QU7U9pR
NToKHSsO0bsdqruPUqvqOcirrim74t4BsSTu0vheLtG/A2FSnVBZOxfuWbyb
Jps7ESAoaqIdOU386ISRP+ds+MBpGDGD5PnznVC389xOZ6YTf7rQ38Lsefsm
HcM0+6dqyi44fSj85TtuBvGrGxzxh+UCw0yITcym4891Q/K1cqr4aibxT44z
+b3cU7QsMN8uLE+HyVFn4/90/0AW8VOO5PEtprMR2fji4WNdPzsForq6q0Q6
POKvYpUvqTYqeZipqdv0yEAJRq3+q0nnHOK3Es3rvLaXTudAwsuzdppQYk/u
gcHQ/Fzifw9oQyVmjK/yEBcU4tAs7cHIvFZQ7Ege4aEXb1xH7Nozz2CfveMx
K14v3hnMRhyh5hM+etFfljll+ls+KGbmwZcYfah4yQncdJhPeOlDZORsw7My
PjoXlhOMt99Fv0y+tX+FT/i5izTRus/eHy9A9uPBnNw198C3NDQOaiwgPN3D
onSu2GBDIVzq6ksoj+4hWTpM14wvJHzdx/4ojrHLYCEM8vi1MeX3MZ4j6p7c
KyC8qfAkxTpguFSAk9QGvxgbFeKaTNftUBcS/lTwNjq+OMMSwvXTSyE1l1Vw
9Y/ONX4oJDyuxq3ju6U2P+Efchp1tw==
    "], 
    Function[Null, 
     Internal`LocalizedBlock[{$CellContext`h0, $CellContext`kequhd}, #], {
     HoldAll}]]& ],
  Editable->False,
  SelectWithContents->True,
  Selectable->True]], "Output",
 CellChangeTimes->{3.734200240608174*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Button", "[", 
   RowBox[{"\"\<Effective Affinity Constant\>\"", ",", 
    RowBox[{"fitteddata", "=", 
     RowBox[{"effectiveKd", "[", 
      RowBox[{
      "kequhdin", ",", "h0in", ",", "d0in", ",", "sig0in", ",", "sighdin", 
       ",", "sigdin", ",", "datasignal", ",", "step"}], "]"}]}]}], "]"}], 
  "]"}]], "Input"]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
CellContext->Notebook,
ShowCellTags->True,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "launchcell"->{
  Cell[3815, 103, 21130, 473, 19, "Input",
   CellOpen->False,
   InitializationCell->True,
   CellTags->"launchcell"],
  Cell[24970, 580, 3713, 78, 49, "Print",
   CellTags->"launchcell"],
  Cell[28686, 660, 7134, 189, 196, "Print",
   CellTags->"launchcell"],
  Cell[35823, 851, 1664, 44, 36, "Print",
   CellTags->"launchcell"]},
 "simroutineHDSE1"->{
  Cell[37536, 901, 13584, 325, 19, "Input",
   CellOpen->False,
   CellTags->"simroutineHDSE1"],
  Cell[51123, 1228, 5838, 129, 467, "Output",
   CellTags->"simroutineHDSE1"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"launchcell", 65711, 1572},
 {"simroutineHDSE1", 66066, 1583}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1892, 42, 19, "Input",
 CellOpen->False],
Cell[2475, 66, 1303, 32, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3815, 103, 21130, 473, 19, "Input",
 CellOpen->False,
 InitializationCell->True,
 CellTags->"launchcell"],
Cell[CellGroupData[{
Cell[24970, 580, 3713, 78, 49, "Print",
 CellTags->"launchcell"],
Cell[28686, 660, 7134, 189, 196, "Print",
 CellTags->"launchcell"],
Cell[35823, 851, 1664, 44, 36, "Print",
 CellTags->"launchcell"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[37536, 901, 13584, 325, 19, "Input",
 CellOpen->False,
 CellTags->"simroutineHDSE1"],
Cell[51123, 1228, 5838, 129, 467, "Output",
 CellTags->"simroutineHDSE1"]
}, Open  ]],
Cell[56976, 1360, 545, 14, 47, "Input"],
Cell[CellGroupData[{
Cell[57546, 1378, 51, 1, 30, "Input"],
Cell[57600, 1381, 3791, 75, 55, "Output"]
}, Open  ]],
Cell[61406, 1459, 449, 11, 50, "Input"],
Cell[61858, 1472, 617, 15, 47, "Input"],
Cell[CellGroupData[{
Cell[62500, 1491, 51, 1, 30, "Input"],
Cell[62554, 1494, 2439, 52, 55, "Output"]
}, Open  ]],
Cell[65008, 1549, 356, 9, 47, "Input"]
}
]
*)

