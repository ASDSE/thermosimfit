(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     77885,       1823]
NotebookOptionsPosition[     76125,       1757]
NotebookOutlinePosition[     77251,       1798]
CellTagsIndexPosition[     77103,       1791]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Pane", "[", 
  RowBox[{
   RowBox[{"Grid", "[", 
    RowBox[{
     RowBox[{"{", "\n", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<Simulation of HG with salt effects thermodynamics\>\"", ",", 
          "\"\<Chapter\>\""}], "]"}], "}"}], ",", "\n", 
       RowBox[{"{", 
        RowBox[{"MouseAppearance", "[", 
         RowBox[{
          RowBox[{"Button", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Launch Application\>\"", ",", "\"\<Section\>\""}], 
             "]"}], ",", 
            RowBox[{"{", " ", 
             RowBox[{
              RowBox[{"nb", "=", 
               RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
              RowBox[{"NotebookFind", "[", 
               RowBox[{
               "nb", ",", "\"\<launchcell\>\"", ",", "All", ",", "CellTags"}],
                "]"}], ",", 
              RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
            RowBox[{"Appearance", "\[Rule]", "None"}]}], "]"}], ",", 
          "\"\<LinkHand\>\""}], "]"}], "}"}]}], "\n", "\n", "}"}], ",", " ", 
     RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
     RowBox[{"ItemSize", "\[Rule]", "Large"}], ",", 
     RowBox[{"BaselinePosition", "\[Rule]", "Baseline"}]}], "]"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.731821909992667*^9, 3.7318220266332903`*^9}, {
   3.7318220650102763`*^9, 3.7318221618988886`*^9}, {3.731822297374745*^9, 
   3.7318223480196705`*^9}, {3.731822393559778*^9, 3.7318224108738403`*^9}, {
   3.731823391470278*^9, 3.7318234673463974`*^9}, {3.7318569879999685`*^9, 
   3.73185698993756*^9}, 3.734079643614863*^9, {3.734080557424387*^9, 
   3.7340805579550896`*^9}, 3.7343267847240524`*^9}],

Cell[BoxData[
 PaneBox[
  TagBox[GridBox[{
     {
      StyleBox["\<\"Simulation of HG with salt effects thermodynamics\"\>", 
       "Chapter",
       StripOnInput->False]},
     {
      TagBox[
       ButtonBox[
        StyleBox["\<\"Launch Application\"\>", "Section",
         StripOnInput->False],
        Appearance->None,
        ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
          NotebookFind[$CellContext`nb, "launchcell", All, CellTags], 
          SelectionEvaluate[$CellContext`nb]},
        Evaluator->Automatic,
        Method->"Preemptive"],
       MouseAppearanceTag["LinkHand"]]}
    },
    AutoDelete->False,
    BaselinePosition->Baseline,
    GridBoxAlignment->{"Columns" -> {{Center}}},
    GridBoxItemSize->{"Columns" -> {{Large}}, "Rows" -> {{Large}}}],
   "Grid"],
  Alignment->Center,
  ImageSize->Full]], "Output",
 CellChangeTimes->{{3.7318219954368877`*^9, 3.7318220271538706`*^9}, {
   3.7318220680542727`*^9, 3.731822162920437*^9}, {3.731822307220541*^9, 
   3.7318223482870207`*^9}, {3.731822399987263*^9, 3.7318224115871*^9}, {
   3.7318233967524242`*^9, 3.731823474535568*^9}, {3.7318235311854105`*^9, 
   3.7318235418192897`*^9}, 3.7318235799529233`*^9, 3.7318570141416454`*^9, 
   3.734079645036843*^9, 3.7340811467047234`*^9, 3.734326790074594*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Notebook", " ", "settings"}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
      RowBox[{"CellContext", "\[Rule]", "Notebook"}]}], "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", 
      RowBox[{"\"\<DynamicUpdating\>\"", "\[Rule]", "True"}]}], "]"}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"$FrontEnd", ",", 
      RowBox[{"\"\<DynamicEvaluationTimeout\>\"", "\[Rule]", "30"}]}], "]"}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"set", " ", "values"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"h0fixed", "=", "1"}], ";", " ", 
    RowBox[{"d0fixed", "=", "1"}], ";", 
    RowBox[{"kequhdfixed", "=", "2"}], ";", 
    RowBox[{"kequhgafixed", "=", "2"}], ";", 
    RowBox[{"sighdfixed", "=", "1"}], ";", 
    RowBox[{"sigdfixed", "=", "1"}], ";", 
    RowBox[{"sig0fixed", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"h0error", "=", "0"}], ";", " ", 
    RowBox[{"d0error", "=", "0"}], ";", 
    RowBox[{"kequhderror", "=", "0"}], ";", 
    RowBox[{"kequhgaerror", "=", "0"}], ";", 
    RowBox[{"sighderror", "=", "0"}], ";", 
    RowBox[{"sigderror", "=", "0"}], ";", 
    RowBox[{"sig0error", "=", "0"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Load", " ", "Packges"}], "*)"}], "\t", "\n", "\t", "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<thermoHD-SE2.m\>\""}], "}"}], "]"}], 
       "}"}], "]"}], "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<thermoHD.m\>\""}], "}"}], "]"}], 
       "}"}], "]"}], "]"}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"FileNameJoin", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "[", 
           RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ",", 
          "\"\<Packages\>\"", ",", "\"\<datagen.m\>\""}], "}"}], "]"}], "}"}],
       "]"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", " ", "Paths", "*)"}], "\n", 
   RowBox[{
    RowBox[{"tempPath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<temp-thermoHGSE2.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"defaultPath", "=", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"NotebookDirectory", "[", "]"}], ",", "\"\<Parameter\>\"", 
        ",", "\"\<default-thermoHGSE2.mx\>\""}], "}"}], "]"}]}], ";"}], "\n", 
   "\n", 
   RowBox[{
    RowBox[{"initialparameters", "=", 
     RowBox[{"Import", "[", "defaultPath", "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"h0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"d0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"step", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"kequhdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sig0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sigdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sighdin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "7", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sa0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "8", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"kequhsain", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "9", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"sb0in", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "10", "]"}], "]"}]}], ";"}], "\n", "\t", 
   RowBox[{
    RowBox[{"kequhsbin", "=", 
     RowBox[{"initialparameters", "[", 
      RowBox[{"[", "11", "]"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", "Buttons", "\n", "*)"}], 
   RowBox[{
    RowBox[{"simulationbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Simulate\>\"", ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"nb", "=", 
            RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
           RowBox[{"NotebookFind", "[", 
            RowBox[{
            "nb", ",", "\"\<simroutineHDSE2\>\"", ",", "All", ",", 
             "CellTags"}], "]"}], ",", 
           RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"EdgeForm", "[", "Dotted", "]"}]}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"kaeffbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Apparent Binding constant\>\"", ",", 
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{"nb", "=", 
            RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
           RowBox[{"NotebookFind", "[", 
            RowBox[{
            "nb", ",", "\"\<fittingroutineHDSE2\>\"", ",", "All", ",", 
             "CellTags"}], "]"}], ",", 
           RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
         RowBox[{"BaseStyle", "\[Rule]", 
          RowBox[{"EdgeForm", "[", "Dotted", "]"}]}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"variablessavebutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Save Parameters\>\"", ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"{", "\n", 
             RowBox[{
             "h0in", ",", "\n", "d0in", ",", "\n", "step", ",", "\n", 
              "kequhdin", ",", "\n", "sig0in", ",", "\n", "sigdin", ",", "\n",
               "sighdin", ",", "\n", "sa0in", ",", "\n", "kequhsain", ",", 
              "\n", "sb0in", ",", "\n", "kequhsbin"}], "\n", "}"}]}], ",", 
           RowBox[{"Export", "[", 
            RowBox[{"tempPath", ",", "initialparameters"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"Appearance", "->", "\"\<DialogBox\>\""}]}], "]"}], ",", 
       "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"variablesloadbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Load Saved Parameters\>\"", ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"Import", "[", "tempPath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"step", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sa0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhsain", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "9", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sb0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "10", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhsbin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "11", "]"}], "]"}]}]}], "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<DialogBox\>\""}]}], "]"}], 
       ",", "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"defaultloadbutton", "=", 
     RowBox[{"MouseAppearance", "[", 
      RowBox[{
       RowBox[{"Button", "[", 
        RowBox[{"\"\<Load Default Parameters\>\"", ",", 
         RowBox[{"{", "\n", 
          RowBox[{
           RowBox[{"initialparameters", "=", 
            RowBox[{"Import", "[", "defaultPath", "]"}]}], ",", "\n", "\t", 
           RowBox[{"h0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"d0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"step", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sig0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sigdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "6", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sighdin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "7", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sa0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "8", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhsain", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "9", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"sb0in", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "10", "]"}], "]"}]}], ",", "\n", "\t", 
           RowBox[{"kequhsbin", "=", 
            RowBox[{"initialparameters", "[", 
             RowBox[{"[", "11", "]"}], "]"}]}]}], "\n", "\t", "}"}], ",", 
         RowBox[{"Appearance", "\[Rule]", "\"\<DialogBox\>\""}]}], "]"}], 
       ",", "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"inputline", " ", "=", " ", 
     RowBox[{"{", "\n", "   ", 
      RowBox[{
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<species\>\"", ",", " ", "Bold", ",", "Underlined", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "12"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<concentration\>\"", ",", " ", "Bold", ",", "Underlined", ",", 
           " ", 
           RowBox[{"FontSize", "\[Rule]", "12"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<binding\>\"", ",", " ", "Bold", ",", "Underlined", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "12"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}]}], "}"}], 
       ",", "\n", "\n", "   ", 
       RowBox[{"{", "\n", "   ", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Host:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "h0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", "\n", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<c-step \>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "step", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\""}], "}"}], ",", "\n", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"h0in", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<c-step\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<\>\""}], "}"}], ",", "\n", " ", "\n", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Dye:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "   ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "d0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD)\>\"", " ", ",", " ", 
           "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "kequhdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\>\""}], "\n", 
        "}"}], ",", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"d0in", "*", "1000000"}], "]"}], ",", "\"\<\[Mu]M\>\"", 
         ",", "\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"Log10", "[", "kequhdin", "]"}], "]"}], ",", "\"\<\>\""}], 
        "}"}], ",", "\n", " ", "\n", " ", "\n", " ", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Salt A:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "      ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sa0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(K\), \
\(equ\)]\)(\!\(\*SubscriptBox[\(HS\), \(A\)]\))\>\"", " ", ",", " ", "Bold", 
           ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", "\n", 
         "      ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "kequhsain", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\>\""}], "\n", 
        "}"}], ",", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"sa0in", "*", "1000"}], "]"}], ",", "\"\<mM\>\"", ",", 
         "\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"Log10", "[", "kequhsain", "]"}], "]"}], ",", "\"\<\>\""}], 
        "}"}], ",", "\n", "   ", "\n", "    ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Salt B:\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         "\n", "      ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sb0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<M\>\"", ",", 
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<\!\(\*SubscriptBox[\(K\), \
\(equ\)]\)(\!\(\*SubscriptBox[\(HS\), \(B\)]\))\>\"", " ", ",", " ", "Bold", 
           ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", "\n", 
         "      ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "kequhsbin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\>\""}], "\n", 
        "}"}], ",", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"sb0in", "*", "1000"}], "]"}], ",", "\"\<mM\>\"", ",", 
         "\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))\>\"", ",", 
         RowBox[{"Dynamic", "[", 
          RowBox[{"Log10", "[", "kequhsbin", "]"}], "]"}], ",", "\"\<\>\""}], 
        "}"}], ",", "\n", "   ", "\n", "   ", "\n", "   ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-HD\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", " ", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sighdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-D\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sigdin", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}], ",", 
         "\"\<\>\"", ",", "\n", "   ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Signal-0\>\"", ",", " ", "Bold", ",", " ", 
           RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
           RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
         RowBox[{"InputField", "[", 
          RowBox[{
           RowBox[{"Dynamic", "[", "sig0in", "]"}], ",", " ", 
           RowBox[{"FieldSize", " ", "->", " ", "6"}]}], "]"}]}], "}"}], ",", 
       "\n", "      ", 
       RowBox[{"{", 
        RowBox[{
        "\"\<HD complex\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<dye alone\>\"", ",", "\"\<\>\"", ",", "\"\<\>\"", ",", 
         "\"\<Startsignal\>\""}], "}"}]}], "  ", "\n", "    ", "\n", "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"kequhdout", "=", "kequhdin"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"fitteddata", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"rsq", "=", "1"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"TableForm", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
        "simulationbutton", ",", "variablesloadbutton", ",", 
         "variablessavebutton", ",", "defaultloadbutton"}], "}"}], "}"}], 
      "]"}], "]"}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"TableForm", "[", 
      RowBox[{"inputline", ",", " ", 
       RowBox[{"TableAlignments", " ", "->", " ", "Left"}]}], "]"}], "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{
      RowBox[{"Style", "[", 
       RowBox[{"\"\<Salt - \>\"", ",", "Bold"}], "]"}], ",", 
      RowBox[{"Style", "[", 
       RowBox[{
       "\"\<Environmental disturbance of the binding of Host and Guest. Salts \
are interpreted to compete for the host with a weak affinity at high \
concentrations\>\"", ",", "Italic", ",", "Bold", ",", 
        RowBox[{"FontColor", "\[Rule]", "Gray"}]}], "]"}]}], "]"}], ";"}], 
   "\n"}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.730400773395277*^9, 3.7304008352393255`*^9}, {
   3.730401492629541*^9, 3.73040150347148*^9}, {3.730402649565604*^9, 
   3.7304028230281205`*^9}, {3.7304029904431067`*^9, 3.730403080271673*^9}, {
   3.7304031109589834`*^9, 3.7304033952843356`*^9}, {3.730403434815216*^9, 
   3.7304034707397184`*^9}, {3.730403572769393*^9, 3.7304036711451073`*^9}, {
   3.7304037173322906`*^9, 3.7304038263140087`*^9}, {3.7304038664846106`*^9, 
   3.730403892708701*^9}, 3.7304039373324056`*^9, {3.730635884169504*^9, 
   3.730635890234384*^9}, {3.730635977259904*^9, 3.730636125234563*^9}, 
   3.7306361562502937`*^9, {3.730636486363246*^9, 3.730636507704445*^9}, 
   3.730699333959115*^9, 3.730699414337867*^9, {3.7306994572750845`*^9, 
   3.730699471266698*^9}, {3.73070096568909*^9, 3.730700983626526*^9}, 
   3.730701842378021*^9, 3.7307103357721977`*^9, {3.730711599505864*^9, 
   3.7307116052989116`*^9}, {3.7307118430217047`*^9, 
   3.7307118531154985`*^9}, {3.7307118888187237`*^9, 
   3.7307120428818164`*^9}, {3.7307120899121513`*^9, 3.730712091974739*^9}, {
   3.730712158991912*^9, 3.730712301897294*^9}, {3.7307123369917274`*^9, 
   3.7307123615377364`*^9}, {3.730712434386697*^9, 3.73071243545944*^9}, {
   3.730712555569868*^9, 3.730712569491119*^9}, {3.7307126443741517`*^9, 
   3.730712700401746*^9}, {3.7307128842864532`*^9, 3.730712899880815*^9}, 
   3.730713117631132*^9, {3.730714832037506*^9, 3.7307150229472327`*^9}, 
   3.730715152250645*^9, {3.730720928334868*^9, 3.7307209894055443`*^9}, {
   3.7307210437260246`*^9, 3.7307211347099714`*^9}, {3.730721166538047*^9, 
   3.7307211682081127`*^9}, {3.730721268272152*^9, 3.7307212991326036`*^9}, {
   3.73113671379996*^9, 3.731136795673627*^9}, {3.7340796606207995`*^9, 
   3.7340797082038565`*^9}, 3.734079767025264*^9, 3.7340801047041655`*^9, {
   3.7340801901873493`*^9, 3.7340801916538916`*^9}, {3.734080325128217*^9, 
   3.7340803266897755`*^9}, {3.734081166258032*^9, 3.734081192197974*^9}, {
   3.734081311746915*^9, 3.7340813847541847`*^9}, {3.73408151756456*^9, 
   3.73408152411252*^9}, {3.7340820767872324`*^9, 3.7340820775205812`*^9}, 
   3.734082177634734*^9, {3.734082231951256*^9, 3.7340822434321938`*^9}, {
   3.734082281546068*^9, 3.734082454750534*^9}, {3.7340826596192636`*^9, 
   3.7340826634297247`*^9}, 3.7340829264392724`*^9, 3.7341044556968613`*^9, 
   3.7343268406534863`*^9, 3.734326960597449*^9, 3.7343273228410873`*^9, {
   3.7343273780583844`*^9, 3.734327407207671*^9}, {3.7343292703550973`*^9, 
   3.7343292722579784`*^9}, {3.7343301386239295`*^9, 3.734330141574442*^9}},
 CellTags->"launchcell"],

Cell[CellGroupData[{

Cell[BoxData[
 TagBox[GridBox[{
    {
     TagBox[
      ButtonBox["\<\"Simulate\"\>",
       Appearance->Automatic,
       BaseStyle->EdgeForm[
         Dashing[{0, Small}]],
       ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
         NotebookFind[$CellContext`nb, "simroutineHDSE2", All, CellTags], 
         SelectionEvaluate[$CellContext`nb]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox["\<\"Load Saved Parameters\"\>",
       Appearance->"DialogBox",
       ButtonFunction:>{$CellContext`initialparameters = 
         Import[$CellContext`tempPath], $CellContext`h0in = 
         Part[$CellContext`initialparameters, 1], $CellContext`d0in = 
         Part[$CellContext`initialparameters, 2], $CellContext`step = 
         Part[$CellContext`initialparameters, 3], $CellContext`kequhdin = 
         Part[$CellContext`initialparameters, 4], $CellContext`sig0in = 
         Part[$CellContext`initialparameters, 5], $CellContext`sigdin = 
         Part[$CellContext`initialparameters, 6], $CellContext`sighdin = 
         Part[$CellContext`initialparameters, 7], $CellContext`sa0in = 
         Part[$CellContext`initialparameters, 8], $CellContext`kequhsain = 
         Part[$CellContext`initialparameters, 9], $CellContext`sb0in = 
         Part[$CellContext`initialparameters, 10], $CellContext`kequhsbin = 
         Part[$CellContext`initialparameters, 11]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox["\<\"Save Parameters\"\>",
       Appearance->"DialogBox",
       ButtonFunction:>{$CellContext`initialparameters = {$CellContext`h0in, \
$CellContext`d0in, $CellContext`step, $CellContext`kequhdin, \
$CellContext`sig0in, $CellContext`sigdin, $CellContext`sighdin, \
$CellContext`sa0in, $CellContext`kequhsain, $CellContext`sb0in, \
$CellContext`kequhsbin}, 
         Export[$CellContext`tempPath, $CellContext`initialparameters]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]], 
     TagBox[
      ButtonBox["\<\"Load Default Parameters\"\>",
       Appearance->"DialogBox",
       ButtonFunction:>{$CellContext`initialparameters = 
         Import[$CellContext`defaultPath], $CellContext`h0in = 
         Part[$CellContext`initialparameters, 1], $CellContext`d0in = 
         Part[$CellContext`initialparameters, 2], $CellContext`step = 
         Part[$CellContext`initialparameters, 3], $CellContext`kequhdin = 
         Part[$CellContext`initialparameters, 4], $CellContext`sig0in = 
         Part[$CellContext`initialparameters, 5], $CellContext`sigdin = 
         Part[$CellContext`initialparameters, 6], $CellContext`sighdin = 
         Part[$CellContext`initialparameters, 7], $CellContext`sa0in = 
         Part[$CellContext`initialparameters, 8], $CellContext`kequhsain = 
         Part[$CellContext`initialparameters, 9], $CellContext`sb0in = 
         Part[$CellContext`initialparameters, 10], $CellContext`kequhsbin = 
         Part[$CellContext`initialparameters, 11]},
       Evaluator->Automatic,
       Method->"Preemptive"],
      MouseAppearanceTag["LinkHand"]]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Print",
 CellChangeTimes->{
  3.7340823065368586`*^9, 3.7340824571866665`*^9, 3.7340826938321714`*^9, 
   3.7340829331042747`*^9, 3.7341044677183294`*^9, 3.734104638161203*^9, {
   3.7341048625016203`*^9, 3.734104864064183*^9}, {3.734326684823868*^9, 
   3.734326686673343*^9}, {3.734326794157717*^9, 3.734326803424389*^9}, 
   3.734326847524153*^9, 3.7343269675242863`*^9, 3.7343274201575637`*^9, 
   3.734328625190544*^9, 3.7343292788570547`*^9, 3.73432947912417*^9, 
   3.734329773724413*^9, 3.7343299463570957`*^9, 3.7343301479076633`*^9, 
   3.7343302834078903`*^9, {3.734336300824277*^9, 3.734336309924406*^9}, {
   3.73435932138004*^9, 3.7343593258020926`*^9}, 3.73436923353069*^9},
 CellTags->"launchcell"],

Cell[BoxData[
 InterpretationBox[GridBox[{
    {
     StyleBox["\<\"species\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->12,
      FontWeight->Bold,
      FontVariations->{"Underline"->True}], 
     StyleBox["\<\"concentration\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->12,
      FontWeight->Bold,
      FontVariations->{"Underline"->True}], "\<\"\"\>", 
     StyleBox["\<\"binding\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->12,
      FontWeight->Bold,
      FontVariations->{
      "Underline"->True}], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Host:\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`h0in],
      FieldSize->6], "\<\"M\"\>", 
     StyleBox["\<\"c-step \"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`step],
      FieldSize->6], "\<\"M\"\>", "\<\"\"\>", "\<\"\"\>"},
    {"\<\"\"\>", 
     DynamicBox[ToBoxes[$CellContext`h0in 1000000, StandardForm],
      ImageSizeCache->{
       21., {0., 
        8.}}], "\<\"\[Mu]M\"\>", "\<\"c-step\"\>", "\<\"\"\>", "\<\"\"\>", \
"\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Dye:\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`d0in],
      FieldSize->6], "\<\"M\"\>", 
     StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(K\\), \\(equ\\)]\\)(HD)\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`kequhdin],
      FieldSize->
       6], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>", \
"\<\"\"\>", "\<\"\"\>"},
    {"\<\"\"\>", 
     DynamicBox[ToBoxes[$CellContext`d0in 1000000, StandardForm],
      ImageSizeCache->{
       14., {0., 
        8.}}], "\<\"\[Mu]M\"\>", "\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\))\"\>", 
     DynamicBox[ToBoxes[
       Log10[$CellContext`kequhdin], StandardForm],
      ImageSizeCache->{49., {0., 8.}}], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Salt A:\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sa0in],
      FieldSize->6], "\<\"M\"\>", 
     StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\)(\\!\\(\\*SubscriptBox[\\(HS\\), \\(A\\)]\\))\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`kequhsain],
      FieldSize->
       6], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>", \
"\<\"\"\>", "\<\"\"\>"},
    {"\<\"\"\>", 
     DynamicBox[ToBoxes[$CellContext`sa0in 1000, StandardForm],
      ImageSizeCache->{
       14., {0., 
        8.}}], "\<\"mM\"\>", "\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\))\"\>", 
     DynamicBox[ToBoxes[
       Log10[$CellContext`kequhsain], StandardForm],
      ImageSizeCache->{49., {0., 8.}}], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Salt B:\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sb0in],
      FieldSize->6], "\<\"M\"\>", 
     StyleBox["\<\"\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\)(\\!\\(\\*SubscriptBox[\\(HS\\), \\(B\\)]\\))\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`kequhsbin],
      FieldSize->
       6], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>", \
"\<\"\"\>", "\<\"\"\>"},
    {"\<\"\"\>", 
     DynamicBox[ToBoxes[$CellContext`sb0in 1000, StandardForm],
      ImageSizeCache->{
       14., {0., 
        8.}}], "\<\"mM\"\>", "\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \
\\(equ\\)]\\))\"\>", 
     DynamicBox[ToBoxes[
       Log10[$CellContext`kequhsbin], StandardForm],
      ImageSizeCache->{49., {0., 8.}}], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
    {
     StyleBox["\<\"Signal-HD\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sighdin],
      FieldSize->6], "\<\"\"\>", 
     StyleBox["\<\"Signal-D\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sigdin],
      FieldSize->6], "\<\"\"\>", 
     StyleBox["\<\"Signal-0\"\>",
      StripOnInput->False,
      TextAlignment->Right,
      FontSize->16,
      FontWeight->Bold], 
     InputFieldBox[Dynamic[$CellContext`sig0in],
      FieldSize->6]},
    {"\<\"HD complex\"\>", "\<\"\"\>", "\<\"\"\>", "\<\"dye alone\"\>", "\<\"\
\"\>", "\<\"\"\>", "\<\"Startsignal\"\>", "\<\"\"\>"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  TableForm[{{
     Style[
     "species", Bold, Underlined, FontSize -> 12, TextAlignment -> Right], 
     Style[
     "concentration", Bold, Underlined, FontSize -> 12, TextAlignment -> 
      Right], "", 
     Style[
     "binding", Bold, Underlined, FontSize -> 12, TextAlignment -> Right]}, {
     Style["Host:", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`h0in], FieldSize -> 6], "M", 
     Style["c-step ", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`step], FieldSize -> 6], "M"}, {"", 
     Dynamic[$CellContext`h0in 1000000], "\[Mu]M", "c-step", "", "", ""}, {
     Style["Dye:", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`d0in], FieldSize -> 6], "M", 
     Style[
     "\!\(\*SubscriptBox[\(K\), \(equ\)]\)(HD)", Bold, FontSize -> 16, 
      TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`kequhdin], FieldSize -> 6], 
     "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)"}, {"", 
     Dynamic[$CellContext`d0in 1000000], "\[Mu]M", 
     "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))", 
     Dynamic[
      Log10[$CellContext`kequhdin]], ""}, {
     Style["Salt A:", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sa0in], FieldSize -> 6], "M", 
     Style[
     "\!\(\*SubscriptBox[\(K\), \(equ\)]\)(\!\(\*SubscriptBox[\(HS\), \
\(A\)]\))", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`kequhsain], FieldSize -> 6], 
     "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)"}, {"", 
     Dynamic[$CellContext`sa0in 1000], "mM", 
     "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))", 
     Dynamic[
      Log10[$CellContext`kequhsain]], ""}, {
     Style["Salt B:", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sb0in], FieldSize -> 6], "M", 
     Style[
     "\!\(\*SubscriptBox[\(K\), \(equ\)]\)(\!\(\*SubscriptBox[\(HS\), \
\(B\)]\))", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`kequhsbin], FieldSize -> 6], 
     "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)"}, {"", 
     Dynamic[$CellContext`sb0in 1000], "mM", 
     "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))", 
     Dynamic[
      Log10[$CellContext`kequhsbin]], ""}, {
     Style["Signal-HD", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sighdin], FieldSize -> 6], "", 
     Style["Signal-D", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sigdin], FieldSize -> 6], "", 
     Style["Signal-0", Bold, FontSize -> 16, TextAlignment -> Right], 
     InputField[
      Dynamic[$CellContext`sig0in], FieldSize -> 6]}, {
    "HD complex", "", "", "dye alone", "", "", "Startsignal"}}, 
   TableAlignments -> Left]]], "Print",
 CellChangeTimes->{
  3.7340823065368586`*^9, 3.7340824571866665`*^9, 3.7340826938321714`*^9, 
   3.7340829331042747`*^9, 3.7341044677183294`*^9, 3.734104638161203*^9, {
   3.7341048625016203`*^9, 3.734104864064183*^9}, {3.734326684823868*^9, 
   3.734326686673343*^9}, {3.734326794157717*^9, 3.734326803424389*^9}, 
   3.734326847524153*^9, 3.7343269675242863`*^9, 3.7343274201575637`*^9, 
   3.734328625190544*^9, 3.7343292788570547`*^9, 3.73432947912417*^9, 
   3.734329773724413*^9, 3.7343299463570957`*^9, 3.7343301479076633`*^9, 
   3.7343302834078903`*^9, {3.734336300824277*^9, 3.734336309924406*^9}, {
   3.73435932138004*^9, 3.7343593258020926`*^9}, 3.73436923356194*^9},
 CellTags->"launchcell"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   StyleBox["\<\"Salt - \"\>",
    StripOnInput->False,
    FontWeight->Bold], "\[InvisibleSpace]", 
   StyleBox["\<\"Environmental disturbance of the binding of Host and Guest. \
Salts are interpreted to compete for the host with a weak affinity at high \
concentrations\"\>",
    StripOnInput->False,
    FontWeight->Bold,
    FontSlant->Italic,
    FontColor->GrayLevel[0.5]]}],
  SequenceForm[
   Style["Salt - ", Bold], 
   Style["Environmental disturbance of the binding of Host and Guest. Salts \
are interpreted to compete for the host with a weak affinity at high \
concentrations", Italic, Bold, FontColor -> GrayLevel[0.5]]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7340823065368586`*^9, 3.7340824571866665`*^9, 3.7340826938321714`*^9, 
   3.7340829331042747`*^9, 3.7341044677183294`*^9, 3.734104638161203*^9, {
   3.7341048625016203`*^9, 3.734104864064183*^9}, {3.734326684823868*^9, 
   3.734326686673343*^9}, {3.734326794157717*^9, 3.734326803424389*^9}, 
   3.734326847524153*^9, 3.7343269675242863`*^9, 3.7343274201575637`*^9, 
   3.734328625190544*^9, 3.7343292788570547`*^9, 3.73432947912417*^9, 
   3.734329773724413*^9, 3.7343299463570957`*^9, 3.7343301479076633`*^9, 
   3.7343302834078903`*^9, {3.734336300824277*^9, 3.734336309924406*^9}, {
   3.73435932138004*^9, 3.7343593258020926`*^9}, 3.73436923356194*^9},
 CellTags->"launchcell"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"Export", "::", "chtype"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{"First", "::", "nofirst"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"mode", "=", "\"\<H0 varied\>\""}], ";"}], "\n", "\n", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"datasignal", "=", 
    RowBox[{"sthdse2SignalData", "[", 
     RowBox[{
     "kequhdin", ",", "kequhsain", ",", "kequhsbin", ",", "h0in", ",", "d0in",
       ",", "sa0in", ",", "sb0in", ",", "sig0in", ",", "sighdin", ",", 
      "sigdin", ",", "step"}], "]"}]}], ";"}], "\n", "\n", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataplot", "=", 
    RowBox[{"Manipulate", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Show", "[", "\t", "\n", "\t\t\t\t\t", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"a1", "*", "datasignal"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", " ", "Blue"}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{
          RowBox[{"a2", "*", "fitteddata"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"Thick", ",", "Red", ",", " ", "Dashed"}], "}"}]}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "Full"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", " ", "Large"}]}], "]"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Signal\>\"", ",", 
           "\"\<[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]\>\"", ",", 
           "\"\<[D]\>\"", ",", 
           "\"\<[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]\>\"", ",", 
           "\"\<[\!\(\*SubscriptBox[\(G\), \(A\)]\)]\>\"", ",", 
           "\"\<[H]\>\""}], "}"}]}], ",", 
        RowBox[{"ImageSize", "\[Rule]", " ", "Large"}], ",", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0"}], "}"}]}], ",", 
        RowBox[{"PlotLabel", "\[Rule]", " ", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Simulated Data\>\"", ",", "\"\<Subsection\>\""}], 
          "]"}]}]}], "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a1", ",", "1", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Signal \!\(\*SubscriptBox[\(HD\), \(Salt\)]\)\>\"", ",", 
            "Blue", ",", "Bold"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a2", ",", "1", ",", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Salt \!\(\*SubscriptBox[\(HD\), \(app\)]\)\>\"", ",", "Red", 
            ",", "Bold"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"ControlPlacement", "\[Rule]", "Right"}]}], "\n", "\t\t\t", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"adjustbutton", "=", 
    RowBox[{"MouseAppearance", "[", 
     RowBox[{
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Adjust\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"fitteddata", "=", 
          RowBox[{"sthdSignalData", "[", 
           RowBox[{
           "kequhdout", ",", "h0in", ",", "d0in", ",", "sig0in", ",", 
            "sighdin", ",", "sigdin", ",", "step"}], "]"}]}], "}"}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"EdgeForm", "[", "Dotted", "]"}]}]}], "]"}], ",", 
      "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\t"}], "\n", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"exportbutton1", "=", 
    RowBox[{"Button", "[", 
     RowBox[{"\"\<Save Data and Summary\>\"", ",", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"SystemDialogInput", "[", 
         RowBox[{"\"\<FileSave\>\"", ",", "\"\<.csv\>\""}], "]"}], ",", 
        "output"}], "]"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<Queued\>\""}]}], "]"}]}], 
   ";"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"updatebutton", "=", 
    RowBox[{"MouseAppearance", "[", 
     RowBox[{
      RowBox[{"Button", "[", 
       RowBox[{"\"\<Update Summary\>\"", ",", 
        RowBox[{"{", " ", 
         RowBox[{
          RowBox[{"nb", "=", 
           RowBox[{"EvaluationNotebook", "[", "]"}]}], ",", 
          RowBox[{"NotebookFind", "[", 
           RowBox[{
           "nb", ",", "\"\<simroutineHDSE2\>\"", ",", "All", ",", 
            "CellTags"}], "]"}], ",", 
          RowBox[{"SelectionEvaluate", "[", "nb", "]"}]}], "}"}], ",", 
        RowBox[{"BaseStyle", "\[Rule]", 
         RowBox[{"EdgeForm", "[", "Dotted", "]"}]}]}], "]"}], ",", 
      "\"\<LinkHand\>\""}], "]"}]}], ";"}], "\t", "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"inputs", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\"\<Quantity\>\"", ",", "\"\<Value\>\"", ",", "\"\<Error\>\""}], 
       "}"}], ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<Mode\>\"", ",", "mode", ",", "\"\<\>\""}], "}"}], ",", 
      "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<adjusted R-squared\>\"", ",", "rsq", ",", "\"\<\>\""}], 
       "}"}], ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<conc(H)\>\"", ",", "h0in", ",", "\"\<\>\""}], "}"}], ",", 
      "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<conc(D)\>\"", ",", "d0in", ",", "\"\<\>\""}], "}"}], ",", 
      "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<conc(Sa)\>\"", ",", "sa0in", ",", "\"\<\>\""}], "}"}], 
      ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<conc(Sb)\>\"", ",", "sb0in", ",", "\"\<\>\""}], "}"}], 
      ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<Kequ(HSa)\>\"", ",", "kequhsain", ",", "\"\<\>\""}], 
       "}"}], ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<Kequ(HSb)\>\"", ",", "kequhsbin", ",", "\"\<\>\""}], 
       "}"}], ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<Kequ(HD)\>\"", ",", "kequhdin", ",", "\"\<\>\""}], "}"}], 
      ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<Kequ(HDapp)\>\"", ",", "kequhdout", ",", "kequhderror"}], 
       "}"}], ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<Signal-0\>\"", ",", "sig0in", ",", "\"\<\>\""}], "}"}], 
      ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<Signal-HD\>\"", ",", "sighdin", ",", "\"\<\>\""}], "}"}], 
      ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<Signal-Dye\>\"", ",", "sigdin", ",", "\"\<\>\""}], "}"}], 
      ",", "\n", 
      RowBox[{"{", 
       RowBox[{"\"\<c-step\>\"", ",", "step", ",", "\"\<\>\""}], "}"}]}], 
     "\n", "\n", "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"column1", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"inputs", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}], "]"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"column2", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"inputs", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}], "]"}]}], ";"}]}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"column3", "=", 
    RowBox[{"Flatten", "[", 
     RowBox[{"inputs", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}], "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"header1", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<[H0]\>\"", ",", "\"\<fitted signal\>\""}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"header2", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<[H0]\>\"", ",", "\"\<measured signal\>\""}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"units", "=", 
    RowBox[{"{", 
     RowBox[{"\"\<M\>\"", ",", "\"\<INT\>\""}], "}"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"put1", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{"fitteddata", ",", "units"}], "]"}], ",", "header1"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"put2", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Prepend", "[", 
      RowBox[{"datasignal", ",", "units"}], "]"}], ",", "header2"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"output", "=", 
    RowBox[{"Join", "[", 
     RowBox[{"put1", ",", 
      RowBox[{"List", "/@", 
       RowBox[{"put2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
      RowBox[{"List", "/@", 
       RowBox[{"put2", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ",", 
      RowBox[{"List", "/@", "column1"}], ",", 
      RowBox[{"List", "/@", "column2"}], ",", 
      RowBox[{"List", "/@", "column3"}], ",", "2"}], "]"}]}], ";"}], "\n", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"inputline2", " ", "=", " ", 
   RowBox[{"{", "\n", "   ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "\"\<Exact input parameters \>\"", ",", " ", "\"\<Value\>\"", ",", " ", 
       "\"\<Error\>\"", ",", "\"\<Unit\>\""}], "}"}], ",", "\n", " ", "\n", 
     "  ", "\n", "   ", 
     RowBox[{"(*", 
      RowBox[{"Dye", " ", "binding"}], "*)"}], "\n", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{
        "\"\<\!\(\*SubsuperscriptBox[\(K\), \(equ\), \(app\)]\)(HD) = \>\"", 
         " ", ",", " ", "Bold", ",", " ", 
         RowBox[{"FontSize", "\[Rule]", "16"}], " ", ",", 
         RowBox[{"TextAlignment", "\[Rule]", "Right"}]}], "]"}], ",", 
       RowBox[{"InputField", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", "kequhdout", "]"}], ",", " ", 
         RowBox[{"FieldSize", " ", "->", " ", "8"}]}], "]"}], ",", 
       RowBox[{"InputField", "[", 
        RowBox[{
         RowBox[{"Dynamic", "[", 
          RowBox[{"kequhderror", ",", "None"}], "]"}], ",", " ", 
         RowBox[{"FieldSize", " ", "->", " ", "8"}], ",", 
         RowBox[{"Background", "\[Rule]", "LightGray"}]}], "]"}], ",", "  ", 
       "\"\<\!\(\*SuperscriptBox[\(M\), \(-1\)]\)\>\""}], "}"}], ",", "\n", 
     "   ", 
     RowBox[{"{", 
      RowBox[{"\"\<apparent affinity\>\"", ",", 
       RowBox[{"\"\<lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))=\>\"", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"Log10", "[", "kequhdout", "]"}], "]"}]}]}], "}"}], ",", 
     "\n", "   ", "\n", "   ", 
     RowBox[{"{", 
      RowBox[{"adjustbutton", ",", "kaeffbutton"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"TableForm", "[", "inputs", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"updatebutton", ",", "exportbutton1"}], "}"}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Off", "[", 
    RowBox[{"Export", "::", "chtype"}], "]"}], ";"}], "\n", "\n", "\n", 
  "\n"}], "\n", 
 RowBox[{
  RowBox[{"Print", "[", "\n", "\n", 
   RowBox[{"dataplot", ",", "\"\<  \>\"", ",", 
    RowBox[{"TableForm", "[", 
     RowBox[{"inputline2", ",", " ", 
      RowBox[{"TableAlignments", " ", "->", " ", "Left"}]}], "]"}]}], "]"}], 
  "\n", "\t", "\n", "\t\t\t", "\n"}], "\n"}], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.7304018583395243`*^9, 3.730401859486709*^9}, {
   3.730403948733839*^9, 3.7304039492836747`*^9}, {3.7304040123581524`*^9, 
   3.730404041503718*^9}, {3.7304040765669107`*^9, 3.730404138677521*^9}, {
   3.730404171442689*^9, 3.7304043560974817`*^9}, {3.730404409651743*^9, 
   3.7304044720838237`*^9}, 3.730404511906062*^9, 3.73040491695927*^9, {
   3.7307008121399865`*^9, 3.7307009122001534`*^9}, {3.7307102183718214`*^9, 
   3.730710426152059*^9}, {3.730713239459134*^9, 3.7307133154109344`*^9}, {
   3.730713385630821*^9, 3.730713421491224*^9}, 3.7307134786002483`*^9, {
   3.730713514490865*^9, 3.7307135702518454`*^9}, 3.7307136039433756`*^9, {
   3.730713644849682*^9, 3.7307137128187957`*^9}, {3.730713745084343*^9, 
   3.730713831757533*^9}, {3.73071417346025*^9, 3.730714186068598*^9}, {
   3.7307143318652124`*^9, 3.7307143367263746`*^9}, 3.730714370881699*^9, {
   3.7307144326013565`*^9, 3.730714433926385*^9}, {3.7307145884907675`*^9, 
   3.730714744119078*^9}, {3.730714778976367*^9, 3.730714782678993*^9}, {
   3.730715052146652*^9, 3.7307151180191894`*^9}, {3.730720143070423*^9, 
   3.730720164416132*^9}, {3.7307202178654203`*^9, 3.730720299521387*^9}, {
   3.7307206088187847`*^9, 3.7307207932211065`*^9}, {3.730720828765464*^9, 
   3.730720837797329*^9}, 3.7307213331110654`*^9, {3.7307219319247293`*^9, 
   3.730721979678924*^9}, {3.7307220639210467`*^9, 3.7307220959241977`*^9}, {
   3.7311368629808145`*^9, 3.731136876763731*^9}, {3.731136938792105*^9, 
   3.731137047225228*^9}, {3.731137278011622*^9, 3.7311374958215675`*^9}, 
   3.731143563944759*^9, {3.731143598520023*^9, 3.731143600068371*^9}, {
   3.7340800034720087`*^9, 3.7340800060202026`*^9}, {3.7340800606877575`*^9, 
   3.7340800947312436`*^9}, {3.73408016983522*^9, 3.734080179025074*^9}, {
   3.7340815435275373`*^9, 3.73408155374137*^9}, {3.734081584932107*^9, 
   3.7340816111061277`*^9}, 3.734082638909396*^9, 3.7340827790190735`*^9, {
   3.734104495782821*^9, 3.7341044962149763`*^9}, 3.7341045400157366`*^9, {
   3.7343269763868713`*^9, 3.7343269892036357`*^9}, {3.7343270198023005`*^9, 
   3.7343271891900916`*^9}, {3.7343272781904106`*^9, 3.734327293090823*^9}, {
   3.734327429706468*^9, 3.734327430690909*^9}, {3.7343274956075745`*^9, 
   3.7343276622906237`*^9}, {3.734327694514949*^9, 3.7343277260237556`*^9}, {
   3.734327764002329*^9, 3.7343278503576527`*^9}, 3.734327881357585*^9, {
   3.7343279125855837`*^9, 3.734327942657714*^9}, 3.734327979362494*^9, {
   3.7343280200074897`*^9, 3.734328103957631*^9}, {3.7343286640463457`*^9, 
   3.7343286643904552`*^9}, {3.734329079287837*^9, 3.734329138449027*^9}, {
   3.734329202506113*^9, 3.734329206562978*^9}, {3.734329239162345*^9, 
   3.7343292467241616`*^9}, 3.734329299746775*^9, {3.7343293633958426`*^9, 
   3.734329365682829*^9}, {3.7343294200630956`*^9, 3.734329438923958*^9}, {
   3.7343295004237394`*^9, 3.734329510240365*^9}, {3.734329619784785*^9, 
   3.7343296465243635`*^9}, {3.7343298468283267`*^9, 
   3.7343298514578886`*^9}, {3.7343299578493214`*^9, 
   3.7343299922743626`*^9}, {3.7343300288502045`*^9, 3.734330029940482*^9}, {
   3.7343300628763413`*^9, 3.734330089173957*^9}, 3.734330176974242*^9, {
   3.734330258968404*^9, 3.734330265923889*^9}},
 NumberMarks->False,
 CellTags->"simroutineHDSE2"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   TagBox[
    StyleBox[
     DynamicModuleBox[{$CellContext`a1$$ = 1, $CellContext`a2$$ = 1, 
      Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
      Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ =
       1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
         Hold[$CellContext`a1$$], 1, 
         Style["Signal \!\(\*SubscriptBox[\(HD\), \(Salt\)]\)", 
          RGBColor[0, 0, 1], Bold]}, {1, 0}}, {{
         Hold[$CellContext`a2$$], 1, 
         Style["Salt \!\(\*SubscriptBox[\(HD\), \(app\)]\)", 
          RGBColor[1, 0, 0], Bold]}, {1, 0}}}, Typeset`size$$ = {
      576., {183., 188.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
      Typeset`skipInitDone$$ = True, $CellContext`a1$36692$$ = 
      False, $CellContext`a2$36693$$ = False}, 
      DynamicBox[Manipulate`ManipulateBoxes[
       1, StandardForm, 
        "Variables" :> {$CellContext`a1$$ = 1, $CellContext`a2$$ = 1}, 
        "ControllerVariables" :> {
          Hold[$CellContext`a1$$, $CellContext`a1$36692$$, False], 
          Hold[$CellContext`a2$$, $CellContext`a2$36693$$, False]}, 
        "OtherVariables" :> {
         Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
          Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
          Typeset`specs$$, Typeset`size$$, Typeset`update$$, 
          Typeset`initDone$$, Typeset`skipInitDone$$}, "Body" :> Show[
          
          ListLinePlot[$CellContext`a1$$ $CellContext`datasignal, PlotStyle -> 
           Blue, PlotRange -> Full], 
          
          ListLinePlot[$CellContext`a2$$ $CellContext`fitteddata, 
           PlotStyle -> {Thick, Red, Dashed}, PlotRange -> Full, ImageSize -> 
           Large], PlotRange -> All, 
          PlotLegends -> {
           "Signal", "[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]", "[D]", 
            "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
            "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]"}, ImageSize -> 
          Large, AxesOrigin -> {0, 0}, PlotLabel -> 
          Style["Simulated Data", "Subsection"]], 
        "Specifications" :> {{{$CellContext`a1$$, 1, 
            Style["Signal \!\(\*SubscriptBox[\(HD\), \(Salt\)]\)", 
             RGBColor[0, 0, 1], Bold]}, {1, 0}}, {{$CellContext`a2$$, 1, 
            Style["Salt \!\(\*SubscriptBox[\(HD\), \(app\)]\)", 
             RGBColor[1, 0, 0], Bold]}, {1, 0}}}, 
        "Options" :> {ControlPlacement -> Right}, "DefaultOptions" :> {}],
       ImageSizeCache->{718., {212., 218.}},
       SingleEvaluation->True],
      Deinitialization:>None,
      DynamicModuleValues:>{},
      SynchronousInitialization->True,
      UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
      UnsavedVariables:>{Typeset`initDone$$},
      UntrackedVariables:>{Typeset`size$$}], "Manipulate",
     Deployed->True,
     StripOnInput->False],
    Manipulate`InterpretManipulate[1]], "\[InvisibleSpace]", "\<\"  \"\>", 
   "\[InvisibleSpace]", 
   InterpretationBox[GridBox[{
      {"\<\"Exact input parameters \"\>", "\<\"Value\"\>", "\<\"Error\"\>", "\
\<\"Unit\"\>"},
      {
       StyleBox["\<\"\\!\\(\\*SubsuperscriptBox[\\(K\\), \\(equ\\), \
\\(app\\)]\\)(HD) = \"\>",
        StripOnInput->False,
        TextAlignment->Right,
        FontSize->16,
        FontWeight->Bold], 
       InputFieldBox[Dynamic[$CellContext`kequhdout],
        FieldSize->8], 
       InputFieldBox[Dynamic[$CellContext`kequhderror, None],
        Background->GrayLevel[0.85],
        FieldSize->
         8], "\<\"\\!\\(\\*SuperscriptBox[\\(M\\), \\(-1\\)]\\)\"\>"},
      {"\<\"apparent affinity\"\>", 
       RowBox[{"\<\"lg(\\!\\(\\*SubscriptBox[\\(K\\), \\(equ\\)]\\))=\"\>", 
        " ", 
        DynamicBox[ToBoxes[
          Log10[$CellContext`kequhdout], StandardForm],
         ImageSizeCache->{49., {0., 8.}}]}], "\<\"\"\>", "\<\"\"\>"},
      {
       TagBox[
        ButtonBox["\<\"Adjust\"\>",
         Appearance->Automatic,
         BaseStyle->EdgeForm[
           Dashing[{0, Small}]],
         ButtonFunction:>{$CellContext`fitteddata = 
           thermoHD`sthdSignalData[$CellContext`kequhdout, $CellContext`h0in, \
$CellContext`d0in, $CellContext`sig0in, $CellContext`sighdin, \
$CellContext`sigdin, $CellContext`step]},
         Evaluator->Automatic,
         Method->"Preemptive"],
        MouseAppearanceTag["LinkHand"]], 
       TagBox[
        ButtonBox["\<\"Apparent Binding constant\"\>",
         Appearance->Automatic,
         BaseStyle->EdgeForm[
           Dashing[{0, Small}]],
         ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
           
           NotebookFind[$CellContext`nb, "fittingroutineHDSE2", All, 
            CellTags], 
           SelectionEvaluate[$CellContext`nb]},
         Evaluator->Automatic,
         Method->"Preemptive"],
        MouseAppearanceTag["LinkHand"]], "\<\"\"\>", "\<\"\"\>"},
      {
       TagBox[GridBox[{
          {"\<\"Quantity\"\>", "\<\"Value\"\>", "\<\"Error\"\>"},
          {"\<\"Mode\"\>", "\<\"H0 varied\"\>", "\<\"\"\>"},
          {"\<\"adjusted R-squared\"\>", "0.9999999999994479`", "\<\"\"\>"},
          {"\<\"conc(H)\"\>", "9.999999999999999`*^-6", "\<\"\"\>"},
          {"\<\"conc(D)\"\>", "1.`*^-6", "\<\"\"\>"},
          {"\<\"conc(Sa)\"\>", "0.001`", "\<\"\"\>"},
          {"\<\"conc(Sb)\"\>", "0.001`", "\<\"\"\>"},
          {"\<\"Kequ(HSa)\"\>", "130.2`", "\<\"\"\>"},
          {"\<\"Kequ(HSb)\"\>", "21.`", "\<\"\"\>"},
          {"\<\"Kequ(HD)\"\>", "1.55`*^7", "\<\"\"\>"},
          {"\<\"Kequ(HDapp)\"\>", "1.3714569246088412`*^7", 
           "25.085050193962328`"},
          {"\<\"Signal-0\"\>", "0", "\<\"\"\>"},
          {"\<\"Signal-HD\"\>", "1", "\<\"\"\>"},
          {"\<\"Signal-Dye\"\>", "0", "\<\"\"\>"},
          {"\<\"c-step\"\>", "1.`*^-7", "\<\"\"\>"}
         },
         GridBoxAlignment->{
          "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
           "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
         GridBoxSpacings->{"Columns" -> {
             Offset[0.27999999999999997`], {
              Offset[2.0999999999999996`]}, 
             Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
             Offset[0.2], {
              Offset[0.4]}, 
             Offset[0.2]}, "RowsIndexed" -> {}}],
        Function[BoxForm`e$, 
         TableForm[BoxForm`e$]]], "\<\"\"\>", "\<\"\"\>", "\<\"\"\>"},
      {
       TagBox[
        ButtonBox["\<\"Update Summary\"\>",
         Appearance->Automatic,
         BaseStyle->EdgeForm[
           Dashing[{0, Small}]],
         ButtonFunction:>{$CellContext`nb = EvaluationNotebook[], 
           NotebookFind[$CellContext`nb, "simroutineHDSE2", All, CellTags], 
           SelectionEvaluate[$CellContext`nb]},
         Evaluator->Automatic,
         Method->"Preemptive"],
        MouseAppearanceTag["LinkHand"]], 
       ButtonBox["\<\"Save Data and Summary\"\>",
        Appearance->Automatic,
        ButtonFunction:>Export[
          SystemDialogInput["FileSave", ".csv"], $CellContext`output],
        Evaluator->Automatic,
        Method->"Queued"], "\<\"\"\>", "\<\"\"\>"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[2.0999999999999996`]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    TableForm[{{"Exact input parameters ", "Value", "Error", "Unit"}, {
       Style[
       "\!\(\*SubsuperscriptBox[\(K\), \(equ\), \(app\)]\)(HD) = ", Bold, 
        FontSize -> 16, TextAlignment -> Right], 
       InputField[
        Dynamic[$CellContext`kequhdout], FieldSize -> 8], 
       InputField[
        Dynamic[$CellContext`kequhderror, None], FieldSize -> 8, Background -> 
        GrayLevel[0.85]], "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)"}, {
      "apparent affinity", "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))=" Dynamic[
         Log10[$CellContext`kequhdout]]}, {
       MouseAppearance[
        Button[
        "Adjust", {$CellContext`fitteddata = 
          thermoHD`sthdSignalData[$CellContext`kequhdout, $CellContext`h0in, \
$CellContext`d0in, $CellContext`sig0in, $CellContext`sighdin, \
$CellContext`sigdin, $CellContext`step]}, BaseStyle -> EdgeForm[
           Dashing[{0, Small}]]], "LinkHand"], 
       MouseAppearance[
        Button[
        "Apparent Binding constant", {$CellContext`nb = EvaluationNotebook[], 
          NotebookFind[$CellContext`nb, "fittingroutineHDSE2", All, CellTags], 
          SelectionEvaluate[$CellContext`nb]}, BaseStyle -> EdgeForm[
           Dashing[{0, Small}]]], "LinkHand"]}, {
       TableForm[{{"Quantity", "Value", "Error"}, {"Mode", "H0 varied", ""}, {
         "adjusted R-squared", 0.9999999999994479, ""}, {
         "conc(H)", 9.999999999999999*^-6, ""}, {"conc(D)", 1.*^-6, ""}, {
         "conc(Sa)", 0.001, ""}, {"conc(Sb)", 0.001, ""}, {
         "Kequ(HSa)", 130.2, ""}, {"Kequ(HSb)", 21., ""}, {
         "Kequ(HD)", 1.55*^7, ""}, {
         "Kequ(HDapp)", 1.3714569246088412`*^7, 25.085050193962328`}, {
         "Signal-0", 0, ""}, {"Signal-HD", 1, ""}, {"Signal-Dye", 0, ""}, {
         "c-step", 1.*^-7, ""}}]}, {
       MouseAppearance[
        Button["Update Summary", {$CellContext`nb = EvaluationNotebook[], 
          NotebookFind[$CellContext`nb, "simroutineHDSE2", All, CellTags], 
          SelectionEvaluate[$CellContext`nb]}, BaseStyle -> EdgeForm[
           Dashing[{0, Small}]]], "LinkHand"], 
       Button["Save Data and Summary", 
        Export[
         SystemDialogInput["FileSave", ".csv"], $CellContext`output], Method -> 
        "Queued"]}}, TableAlignments -> Left]]}],
  SequenceForm[
   Manipulate[
    Show[
     ListLinePlot[$CellContext`a1 $CellContext`datasignal, PlotStyle -> Blue, 
      PlotRange -> Full], 
     ListLinePlot[$CellContext`a2 $CellContext`fitteddata, 
      PlotStyle -> {Thick, Red, Dashed}, PlotRange -> Full, ImageSize -> 
      Large], PlotRange -> All, 
     PlotLegends -> {
      "Signal", "[\!\(\*SubscriptBox[\(HD\), \(2\)]\)]", "[D]", 
       "[\!\(\*SubscriptBox[\(HG\), \(A\)]\)]", 
       "[\!\(\*SubscriptBox[\(G\), \(A\)]\)]", "[H]"}, ImageSize -> Large, 
     AxesOrigin -> {0, 0}, PlotLabel -> 
     Style["Simulated Data", "Subsection"]], {{$CellContext`a1, 1, 
      Style["Signal \!\(\*SubscriptBox[\(HD\), \(Salt\)]\)", 
       RGBColor[0, 0, 1], Bold]}, {1, 0}}, {{$CellContext`a2, 1, 
      Style["Salt \!\(\*SubscriptBox[\(HD\), \(app\)]\)", 
       RGBColor[1, 0, 0], Bold]}, {1, 0}}, ControlPlacement -> Right], "  ", 
   TableForm[{{"Exact input parameters ", "Value", "Error", "Unit"}, {
      Style[
      "\!\(\*SubsuperscriptBox[\(K\), \(equ\), \(app\)]\)(HD) = ", Bold, 
       FontSize -> 16, TextAlignment -> Right], 
      InputField[
       Dynamic[$CellContext`kequhdout], FieldSize -> 8], 
      InputField[
       Dynamic[$CellContext`kequhderror, None], FieldSize -> 8, Background -> 
       GrayLevel[0.85]], "\!\(\*SuperscriptBox[\(M\), \(-1\)]\)"}, {
     "apparent affinity", "lg(\!\(\*SubscriptBox[\(K\), \(equ\)]\))=" Dynamic[
        Log10[$CellContext`kequhdout]]}, {
      MouseAppearance[
       Button[
       "Adjust", {$CellContext`fitteddata = 
         thermoHD`sthdSignalData[$CellContext`kequhdout, $CellContext`h0in, \
$CellContext`d0in, $CellContext`sig0in, $CellContext`sighdin, \
$CellContext`sigdin, $CellContext`step]}, BaseStyle -> EdgeForm[
          Dashing[{0, Small}]]], "LinkHand"], 
      MouseAppearance[
       Button[
       "Apparent Binding constant", {$CellContext`nb = EvaluationNotebook[], 
         NotebookFind[$CellContext`nb, "fittingroutineHDSE2", All, CellTags], 
         SelectionEvaluate[$CellContext`nb]}, BaseStyle -> EdgeForm[
          Dashing[{0, Small}]]], "LinkHand"]}, {
      TableForm[{{"Quantity", "Value", "Error"}, {"Mode", "H0 varied", ""}, {
        "adjusted R-squared", 0.9999999999994479, ""}, {
        "conc(H)", 9.999999999999999*^-6, ""}, {"conc(D)", 1.*^-6, ""}, {
        "conc(Sa)", 0.001, ""}, {"conc(Sb)", 0.001, ""}, {
        "Kequ(HSa)", 130.2, ""}, {"Kequ(HSb)", 21., ""}, {
        "Kequ(HD)", 1.55*^7, ""}, {
        "Kequ(HDapp)", 1.3714569246088412`*^7, 25.085050193962328`}, {
        "Signal-0", 0, ""}, {"Signal-HD", 1, ""}, {"Signal-Dye", 0, ""}, {
        "c-step", 1.*^-7, ""}}]}, {
      MouseAppearance[
       Button["Update Summary", {$CellContext`nb = EvaluationNotebook[], 
         NotebookFind[$CellContext`nb, "simroutineHDSE2", All, CellTags], 
         SelectionEvaluate[$CellContext`nb]}, BaseStyle -> EdgeForm[
          Dashing[{0, Small}]]], "LinkHand"], 
      Button["Save Data and Summary", 
       Export[
        SystemDialogInput["FileSave", ".csv"], $CellContext`output], Method -> 
       "Queued"]}}, TableAlignments -> Left]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.734327153823675*^9, 3.734327192286098*^9}, 
   3.7343274338742485`*^9, 3.7343275150341744`*^9, 3.7343277312673597`*^9, 
   3.734327813832981*^9, {3.7343278452740593`*^9, 3.734327853540715*^9}, 
   3.7343278844397836`*^9, {3.734327917100541*^9, 3.7343279444691133`*^9}, {
   3.734328008100443*^9, 3.734328105570659*^9}, 3.734328445207305*^9, 
   3.7343286308246255`*^9, 3.734328677190254*^9, 3.734329171015005*^9, 
   3.7343292101795187`*^9, {3.734329485007975*^9, 3.7343295135711746`*^9}, 
   3.734329602087493*^9, 3.7343296550347304`*^9, 3.734329779406988*^9, 
   3.7343298161390333`*^9, {3.734329972591058*^9, 3.7343300013742466`*^9}, 
   3.7343301522972937`*^9, 3.734330186569809*^9, 3.734330227637915*^9, {
   3.7343302685222645`*^9, 3.7343303083533506`*^9}, 3.7343363182065105`*^9, 
   3.7343593329702725`*^9, {3.7343692414206743`*^9, 3.734369257218998*^9}, 
   3.7343692990738335`*^9},
 CellTags->"simroutineHDSE2"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\n", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"inputparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"subparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"concparameter", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"output", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Dye", " ", "affinity", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "h0", "]"}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"Dye", " ", "affinity", " ", "parameters"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhd", "]"}], ";"}], "\n", "\n", "\n", "\n", 
   RowBox[{
    RowBox[{"fitsignal", "=", 
     RowBox[{"NonlinearModelFit", "[", 
      RowBox[{"datasignal", ",", 
       RowBox[{"sthdSignal", "[", 
        RowBox[{
        "kequhd", ",", "h0", ",", "d0in", ",", "sig0in", ",", "sighdin", ",", 
         "sigdin"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"kequhd", ",", "kequhdout"}], "}"}], "}"}], ",", "h0"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"bestfit", "=", 
     RowBox[{"TableForm", "[", 
      RowBox[{"fitsignal", "[", "\"\<ParameterTableEntries\>\"", "]"}], 
      "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "kequhd", ",", "kequhga", ",", "h0", ",", "d0", ",", "ga0", ",", "sighd",
       ",", "sigd", ",", "sig0"}], "]"}], ";"}], "\n", 
   RowBox[{"(*", "outputs", "*)"}], "\n", "\n", "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"affinity", " ", "results"}], "*)"}], "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhdout", "]"}], ";", 
    RowBox[{"kequhdout", "=", 
     RowBox[{"kequhd", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"Clear", "[", "kequhdout", "]"}], ";", 
    RowBox[{"kequhdout", "=", 
     RowBox[{"kequhd", "/.", 
      RowBox[{"fitsignal", "[", "\"\<BestFitParameters\>\"", "]"}]}]}], ";"}],
    "\[IndentingNewLine]", "\t", "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"NumericQ", "[", "kequhdout", "]"}], ",", "\[IndentingNewLine]",
       "\t", 
      RowBox[{
       RowBox[{"kequhdpos", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"bestfit", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "All", ",", "1"}], "]"}], "]"}], ",", 
           "kequhdout"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
       RowBox[{"kequhderror", "=", 
        RowBox[{"First", "[", 
         RowBox[{"bestfit", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "kequhdpos", ",", "2"}], "]"}], "]"}], "]"}]}], 
       ";"}]}], "\n", "\[IndentingNewLine]", "\t", "]"}], ";"}], "\t", "\n", 
   "\n", 
   RowBox[{
    RowBox[{"fitteddata", "=", 
     RowBox[{"sthdSignalData", "[", 
      RowBox[{
      "kequhdout", ",", "h0in", ",", "d0in", ",", "sig0in", ",", "sighdin", 
       ",", "sigdin", ",", "step"}], "]"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"rsq", "=", 
     RowBox[{"fitsignal", "[", "\"\<AdjustedRSquared\>\"", "]"}]}], ";"}], 
   "\n", "\n", "\n", "\n", "\n"}]}]], "Input",
 CellOpen->False,
 CellChangeTimes->{{3.7307152581789722`*^9, 3.73071525991304*^9}, {
   3.7307152899252205`*^9, 3.73071529388127*^9}, {3.7307163184009533`*^9, 
   3.7307163187621555`*^9}, 3.7307163709612694`*^9, {3.7307164108193502`*^9, 
   3.730716468269109*^9}, {3.7307166218508253`*^9, 3.7307167017260113`*^9}, {
   3.730716988584488*^9, 3.7307170399904256`*^9}, {3.7307171140229616`*^9, 
   3.7307171646008673`*^9}, {3.7307172010383143`*^9, 3.730717454584689*^9}, {
   3.7307175840386686`*^9, 3.730717646397438*^9}, {3.730719486183364*^9, 
   3.7307194930685787`*^9}, {3.730719600131325*^9, 3.7307196462103367`*^9}, {
   3.730719695395836*^9, 3.7307196960061064`*^9}, {3.730721429772709*^9, 
   3.7307214953923783`*^9}, {3.730721560437253*^9, 3.7307215875464797`*^9}, {
   3.7307221246101885`*^9, 3.730722138156067*^9}, {3.734080233517248*^9, 
   3.734080304704069*^9}, {3.734080439935092*^9, 3.734080464337762*^9}, {
   3.734082798424388*^9, 3.7340828298700747`*^9}, {3.73410488127538*^9, 
   3.734104971847969*^9}, {3.7343281233291206`*^9, 3.7343282311577473`*^9}, {
   3.734328288313203*^9, 3.73432836856489*^9}, {3.734328410229298*^9, 
   3.7343284136782455`*^9}, {3.734328784554715*^9, 3.734328785842534*^9}, {
   3.734328837256472*^9, 3.7343289758410654`*^9}, {3.734329008032587*^9, 
   3.7343290104779263`*^9}, {3.734329563014313*^9, 3.734329567185082*^9}, {
   3.73433011343964*^9, 3.7343301190737047`*^9}, {3.7343301672536616`*^9, 
   3.734330171057934*^9}, 3.7343302086482153`*^9},
 CellTags->"fittingroutineHDSE2"]
},
WindowSize->{1366, 685},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
CellContext->Notebook,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "launchcell"->{
  Cell[3813, 103, 24111, 539, 19, "Input",
   CellOpen->False,
   CellTags->"launchcell"],
  Cell[27949, 646, 4398, 87, 35, "Print",
   CellTags->"launchcell"],
  Cell[32350, 735, 9021, 233, 224, "Print",
   CellTags->"launchcell"],
  Cell[41374, 970, 1418, 29, 22, "Print",
   CellTags->"launchcell"]},
 "simroutineHDSE2"->{
  Cell[42841, 1005, 14430, 349, 19, "Input",
   CellOpen->False,
   CellTags->"simroutineHDSE2"],
  Cell[57274, 1356, 13949, 284, 840, "Print",
   CellTags->"simroutineHDSE2"]},
 "fittingroutineHDSE2"->{
  Cell[71238, 1643, 4883, 112, 19, "Input",
   CellOpen->False,
   CellTags->"fittingroutineHDSE2"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"launchcell", 76448, 1768},
 {"simroutineHDSE2", 76774, 1778},
 {"fittingroutineHDSE2", 76978, 1784}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1892, 42, 19, "Input",
 CellOpen->False],
Cell[2475, 66, 1301, 32, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3813, 103, 24111, 539, 19, "Input",
 CellOpen->False,
 CellTags->"launchcell"],
Cell[CellGroupData[{
Cell[27949, 646, 4398, 87, 35, "Print",
 CellTags->"launchcell"],
Cell[32350, 735, 9021, 233, 224, "Print",
 CellTags->"launchcell"],
Cell[41374, 970, 1418, 29, 22, "Print",
 CellTags->"launchcell"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42841, 1005, 14430, 349, 19, "Input",
 CellOpen->False,
 CellTags->"simroutineHDSE2"],
Cell[57274, 1356, 13949, 284, 840, "Print",
 CellTags->"simroutineHDSE2"]
}, Open  ]],
Cell[71238, 1643, 4883, 112, 19, "Input",
 CellOpen->False,
 CellTags->"fittingroutineHDSE2"]
}
]
*)

